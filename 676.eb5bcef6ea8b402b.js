"use strict";(self.webpackChunkedgetensor=self.webpackChunkedgetensor||[]).push([[676],{146:(nt,L,d)=>{d.d(L,{m:()=>tt});var w=d(6814),P=d(6223),C=d(9025),A=d(707),F=d(6760),K=d(3904),rt=d(3530),Y=d(2160),ot=d(5609),at=d(3714),Q=d(6218),G=d(4055),H=d(7680),lt=d(1865),ct=d(4480),R=d(9552),X=d(315),pt=d(4104),q=d(5879);let tt=(()=>{class Z{static \u0275fac=function(J){return new(J||Z)};static \u0275mod=q.oAB({type:Z});static \u0275inj=q.cJS({imports:[w.ez,X.QK,ct.T,A.hJ,lt.cc,P.u5,R.U$,pt.EV,Q.A,C.Y4,Y.kW,F._8,ot.Iu,G.q4,at.j,H.L,K.D,rt.S]})}return Z})()},7676:(nt,L,d)=>{d.r(L),d.d(L,{TripsModule:()=>fe});var w=d(6814),P=d(6223),C=d(9025),A=d(707),F=d(6760),K=d(4237),rt=d(3530),Y=d(2160),ot=d(3714),at=d(4055),Q=d(1712),G=d(7680),H=d(4104),lt=d(146),ct=d(1967),R=d(3173);function X(o,e,t,s,n,r,a){try{var c=o[r](a),l=c.value}catch(m){return void t(m)}c.done?e(l):Promise.resolve(l).then(s,n)}var q=d(7291),tt=d.n(q);const Z=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class J{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[t,s]=new Uint8Array(e,0,2);if(219!==t)throw new Error("Data does not appear to be in a KDBush format.");const n=s>>4;if(1!==n)throw new Error(`Got v${n} data when expected v1.`);const r=Z[15&s];if(!r)throw new Error("Unrecognized array type.");const[a]=new Uint16Array(e,2,1),[c]=new Uint32Array(e,4,1);return new J(c,a,r,e)}constructor(e,t=64,s=Float64Array,n){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+t,2),65535),this.ArrayType=s,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const r=Z.indexOf(this.ArrayType),a=2*e*this.ArrayType.BYTES_PER_ELEMENT,c=e*this.IndexArrayType.BYTES_PER_ELEMENT,l=(8-c%8)%8;if(r<0)throw new Error(`Unexpected typed array class: ${s}.`);n&&n instanceof ArrayBuffer?(this.data=n,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+c+l,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+a+c+l),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+c+l,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+r]),new Uint16Array(this.data,2,1)[0]=t,new Uint32Array(this.data,4,1)[0]=e)}add(e,t){const s=this._pos>>1;return this.ids[s]=s,this.coords[this._pos++]=e,this.coords[this._pos++]=t,s}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return mt(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,t,s,n){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:r,coords:a,nodeSize:c}=this,l=[0,r.length-1,0],m=[];for(;l.length;){const h=l.pop()||0,g=l.pop()||0,u=l.pop()||0;if(g-u<=c){for(let _=u;_<=g;_++){const y=a[2*_],M=a[2*_+1];y>=e&&y<=s&&M>=t&&M<=n&&m.push(r[_])}continue}const f=u+g>>1,v=a[2*f],p=a[2*f+1];v>=e&&v<=s&&p>=t&&p<=n&&m.push(r[f]),(0===h?e<=v:t<=p)&&(l.push(u),l.push(f-1),l.push(1-h)),(0===h?s>=v:n>=p)&&(l.push(f+1),l.push(g),l.push(1-h))}return m}within(e,t,s){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:n,coords:r,nodeSize:a}=this,c=[0,n.length-1,0],l=[],m=s*s;for(;c.length;){const h=c.pop()||0,g=c.pop()||0,u=c.pop()||0;if(g-u<=a){for(let _=u;_<=g;_++)wt(r[2*_],r[2*_+1],e,t)<=m&&l.push(n[_]);continue}const f=u+g>>1,v=r[2*f],p=r[2*f+1];wt(v,p,e,t)<=m&&l.push(n[f]),(0===h?e-s<=v:t-s<=p)&&(c.push(u),c.push(f-1),c.push(1-h)),(0===h?e+s>=v:t+s>=p)&&(c.push(f+1),c.push(g),c.push(1-h))}return l}}function mt(o,e,t,s,n,r){if(n-s<=t)return;const a=s+n>>1;yt(o,e,a,s,n,r),mt(o,e,t,s,a-1,1-r),mt(o,e,t,a+1,n,1-r)}function yt(o,e,t,s,n,r){for(;n>s;){if(n-s>600){const m=n-s+1,h=t-s+1,g=Math.log(m),u=.5*Math.exp(2*g/3),f=.5*Math.sqrt(g*u*(m-u)/m)*(h-m/2<0?-1:1);yt(o,e,t,Math.max(s,Math.floor(t-h*u/m+f)),Math.min(n,Math.floor(t+(m-h)*u/m+f)),r)}const a=e[2*t+r];let c=s,l=n;for(j(o,e,s,t),e[2*n+r]>a&&j(o,e,s,n);c<l;){for(j(o,e,c,l),c++,l--;e[2*c+r]<a;)c++;for(;e[2*l+r]>a;)l--}e[2*s+r]===a?j(o,e,s,l):(l++,j(o,e,l,n)),l<=t&&(s=l+1),t<=l&&(n=l-1)}}function j(o,e,t,s){ht(o,t,s),ht(e,2*t,2*s),ht(e,2*t+1,2*s+1)}function ht(o,e,t){const s=o[e];o[e]=o[t],o[t]=s}function wt(o,e,t,s){const n=o-t,r=e-s;return n*n+r*r}const Lt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:o=>o},Tt=Math.fround||(o=new Float32Array(1),e=>(o[0]=+e,o[0])),S=3,k=5,xt=6;var o;class Zt{constructor(e){this.options=Object.assign(Object.create(Lt),e),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(e){const{log:t,minZoom:s,maxZoom:n}=this.options;t&&console.time("total time");const r=`prepare ${e.length} points`;t&&console.time(r),this.points=e;const a=[];for(let l=0;l<e.length;l++){const m=e[l];if(!m.geometry)continue;const[h,g]=m.geometry.coordinates,u=Tt(et(h)),f=Tt(st(g));a.push(u,f,1/0,l,-1,1),this.options.reduce&&a.push(0)}let c=this.trees[n+1]=this._createTree(a);t&&console.timeEnd(r);for(let l=n;l>=s;l--){const m=+Date.now();c=this.trees[l]=this._createTree(this._cluster(c,l)),t&&console.log("z%d: %d clusters in %dms",l,c.numItems,+Date.now()-m)}return t&&console.timeEnd("total time"),this}getClusters(e,t){let s=((e[0]+180)%360+360)%360-180;const n=Math.max(-90,Math.min(90,e[1]));let r=180===e[2]?180:((e[2]+180)%360+360)%360-180;const a=Math.max(-90,Math.min(90,e[3]));if(e[2]-e[0]>=360)s=-180,r=180;else if(s>r){const g=this.getClusters([s,n,180,a],t),u=this.getClusters([-180,n,r,a],t);return g.concat(u)}const c=this.trees[this._limitZoom(t)],l=c.range(et(s),st(a),et(r),st(n)),m=c.data,h=[];for(const g of l){const u=this.stride*g;h.push(m[u+k]>1?Mt(m,u,this.clusterProps):this.points[m[u+S]])}return h}getChildren(e){const t=this._getOriginId(e),s=this._getOriginZoom(e),n="No cluster with the specified id.",r=this.trees[s];if(!r)throw new Error(n);const a=r.data;if(t*this.stride>=a.length)throw new Error(n);const c=this.options.radius/(this.options.extent*Math.pow(2,s-1)),h=r.within(a[t*this.stride],a[t*this.stride+1],c),g=[];for(const u of h){const f=u*this.stride;a[f+4]===e&&g.push(a[f+k]>1?Mt(a,f,this.clusterProps):this.points[a[f+S]])}if(0===g.length)throw new Error(n);return g}getLeaves(e,t,s){const n=[];return this._appendLeaves(n,e,t=t||10,s=s||0,0),n}getTile(e,t,s){const n=this.trees[this._limitZoom(e)],r=Math.pow(2,e),{extent:a,radius:c}=this.options,l=c/a,m=(s-l)/r,h=(s+1+l)/r,g={features:[]};return this._addTileFeatures(n.range((t-l)/r,m,(t+1+l)/r,h),n.data,t,s,r,g),0===t&&this._addTileFeatures(n.range(1-l/r,m,1,h),n.data,r,s,r,g),t===r-1&&this._addTileFeatures(n.range(0,m,l/r,h),n.data,-1,s,r,g),g.features.length?g:null}getClusterExpansionZoom(e){let t=this._getOriginZoom(e)-1;for(;t<=this.options.maxZoom;){const s=this.getChildren(e);if(t++,1!==s.length)break;e=s[0].properties.cluster_id}return t}_appendLeaves(e,t,s,n,r){const a=this.getChildren(t);for(const c of a){const l=c.properties;if(l&&l.cluster?r+l.point_count<=n?r+=l.point_count:r=this._appendLeaves(e,l.cluster_id,s,n,r):r<n?r++:e.push(c),e.length===s)break}return r}_createTree(e){const t=new J(e.length/this.stride|0,this.options.nodeSize,Float32Array);for(let s=0;s<e.length;s+=this.stride)t.add(e[s],e[s+1]);return t.finish(),t.data=e,t}_addTileFeatures(e,t,s,n,r,a){for(const c of e){const l=c*this.stride,m=t[l+k]>1;let h,g,u;if(m)h=Ct(t,l,this.clusterProps),g=t[l],u=t[l+1];else{const p=this.points[t[l+S]];h=p.properties;const[_,y]=p.geometry.coordinates;g=et(_),u=st(y)}const f={type:1,geometry:[[Math.round(this.options.extent*(g*r-s)),Math.round(this.options.extent*(u*r-n))]],tags:h};let v;v=m||this.options.generateId?t[l+S]:this.points[t[l+S]].id,void 0!==v&&(f.id=v),a.features.push(f)}}_limitZoom(e){return Math.max(this.options.minZoom,Math.min(Math.floor(+e),this.options.maxZoom+1))}_cluster(e,t){const{radius:s,extent:n,reduce:r,minPoints:a}=this.options,c=s/(n*Math.pow(2,t)),l=e.data,m=[],h=this.stride;for(let g=0;g<l.length;g+=h){if(l[g+2]<=t)continue;l[g+2]=t;const u=l[g],f=l[g+1],v=e.within(l[g],l[g+1],c),p=l[g+k];let _=p;for(const y of v){const M=y*h;l[M+2]>t&&(_+=l[M+k])}if(_>p&&_>=a){let E,y=u*p,M=f*p,b=-1;const x=((g/h|0)<<5)+(t+1)+this.points.length;for(const U of v){const O=U*h;if(l[O+2]<=t)continue;l[O+2]=t;const V=l[O+k];y+=l[O]*V,M+=l[O+1]*V,l[O+4]=x,r&&(E||(E=this._map(l,g,!0),b=this.clusterProps.length,this.clusterProps.push(E)),r(E,this._map(l,O)))}l[g+4]=x,m.push(y/_,M/_,1/0,x,-1,_),r&&m.push(b)}else{for(let y=0;y<h;y++)m.push(l[g+y]);if(_>1)for(const y of v){const M=y*h;if(!(l[M+2]<=t)){l[M+2]=t;for(let E=0;E<h;E++)m.push(l[M+E])}}}}return m}_getOriginId(e){return e-this.points.length>>5}_getOriginZoom(e){return(e-this.points.length)%32}_map(e,t,s){if(e[t+k]>1){const a=this.clusterProps[e[t+xt]];return s?Object.assign({},a):a}const n=this.points[e[t+S]].properties,r=this.options.map(n);return s&&r===n?Object.assign({},r):r}}function Mt(o,e,t){return{type:"Feature",id:o[e+S],properties:Ct(o,e,t),geometry:{type:"Point",coordinates:[It(o[e]),Nt(o[e+1])]}}}function Ct(o,e,t){const s=o[e+k],n=s>=1e4?`${Math.round(s/1e3)}k`:s>=1e3?Math.round(s/100)/10+"k":s,r=o[e+xt],a=-1===r?{}:Object.assign({},t[r]);return Object.assign(a,{cluster:!0,cluster_id:o[e+S],point_count:s,point_count_abbreviated:n})}function et(o){return o/360+.5}function st(o){const e=Math.sin(o*Math.PI/180),t=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return t<0?0:t>1?1:t}function It(o){return 360*(o-.5)}function Nt(o){const e=(180-360*o)*Math.PI/180;return 360*Math.atan(Math.exp(e))/Math.PI-90}class T{static isAdvancedMarkerAvailable(e){return google.maps.marker&&!0===e.getMapCapabilities().isAdvancedMarkersAvailable}static isAdvancedMarker(e){return google.maps.marker&&e instanceof google.maps.marker.AdvancedMarkerElement}static setMap(e,t){this.isAdvancedMarker(e)?e.map=t:e.setMap(t)}static getPosition(e){if(this.isAdvancedMarker(e)){if(e.position){if(e.position instanceof google.maps.LatLng)return e.position;if(e.position.lat&&e.position.lng)return new google.maps.LatLng(e.position.lat,e.position.lng)}return new google.maps.LatLng(null)}return e.getPosition()}static getVisible(e){return!!this.isAdvancedMarker(e)||e.getVisible()}}class ${constructor({markers:e,position:t}){this.markers=e,t&&(this._position=t instanceof google.maps.LatLng?t:new google.maps.LatLng(t))}get bounds(){if(0===this.markers.length&&!this._position)return;const e=new google.maps.LatLngBounds(this._position,this._position);for(const t of this.markers)e.extend(T.getPosition(t));return e}get position(){return this._position||this.bounds.getCenter()}get count(){return this.markers.filter(e=>T.getVisible(e)).length}push(e){this.markers.push(e)}delete(){this.marker&&(T.setMap(this.marker,null),this.marker=void 0),this.markers.length=0}}class $t{constructor({maxZoom:e=16}){this.maxZoom=e}noop({markers:e}){return Vt(e)}}const Vt=o=>o.map(t=>new $({position:T.getPosition(t),markers:[t]}));class bt extends $t{constructor(e){var{maxZoom:t,radius:s=60}=e,n=function z(o,e){var t={};for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&e.indexOf(s)<0&&(t[s]=o[s]);if(null!=o&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(s=Object.getOwnPropertySymbols(o);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(o,s[n])&&(t[s[n]]=o[s[n]])}return t}(e,["maxZoom","radius"]);super({maxZoom:t}),this.state={zoom:-1},this.superCluster=new Zt(Object.assign({maxZoom:this.maxZoom,radius:s},n))}calculate(e){let t=!1;const s={zoom:e.map.getZoom()};if(!tt()(e.markers,this.markers)){t=!0,this.markers=[...e.markers];const n=this.markers.map(r=>{const a=T.getPosition(r);return{type:"Feature",geometry:{type:"Point",coordinates:[a.lng(),a.lat()]},properties:{marker:r}}});this.superCluster.load(n)}return t||(this.state.zoom<=this.maxZoom||s.zoom<=this.maxZoom)&&(t=!tt()(this.state,s)),this.state=s,t&&(this.clusters=this.cluster(e)),{clusters:this.clusters,changed:t}}cluster({map:e}){return this.superCluster.getClusters([-180,-90,180,90],Math.round(e.getZoom())).map(t=>this.transformCluster(t))}transformCluster({geometry:{coordinates:[e,t]},properties:s}){if(s.cluster)return new $({markers:this.superCluster.getLeaves(s.cluster_id,1/0).map(r=>r.properties.marker),position:{lat:t,lng:e}});const n=s.marker;return new $({markers:[n],position:T.getPosition(n)})}}class Jt{constructor(e,t){this.markers={sum:e.length};const s=t.map(r=>r.count),n=s.reduce((r,a)=>r+a,0);this.clusters={count:t.length,markers:{mean:n/t.length,sum:n,min:Math.min(...s),max:Math.max(...s)}}}}class jt{render({count:e,position:t},s,n){const a=`<svg fill="${e>Math.max(10,s.clusters.markers.mean)?"#ff0000":"#0000ff"}" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 240 240" width="50" height="50">\n<circle cx="120" cy="120" opacity=".6" r="70" />\n<circle cx="120" cy="120" opacity=".3" r="90" />\n<circle cx="120" cy="120" opacity=".2" r="110" />\n<text x="50%" y="50%" style="fill:#fff" text-anchor="middle" font-size="50" dominant-baseline="middle" font-family="roboto,arial,sans-serif">${e}</text>\n</svg>`,c=`Cluster of ${e} markers`,l=Number(google.maps.Marker.MAX_ZINDEX)+e;if(T.isAdvancedMarkerAvailable(n)){const g=(new DOMParser).parseFromString(a,"image/svg+xml").documentElement;return g.setAttribute("transform","translate(0 25)"),new google.maps.marker.AdvancedMarkerElement({map:n,position:t,zIndex:l,title:c,content:g})}const m={position:t,zIndex:l,title:c,icon:{url:`data:image/svg+xml;base64,${btoa(a)}`,anchor:new google.maps.Point(25,25)}};return new google.maps.Marker(m)}}class ft{constructor(){!function zt(o,e){for(let t in e.prototype)o.prototype[t]=e.prototype[t]}(ft,google.maps.OverlayView)}}var it=function(o){return o.CLUSTERING_BEGIN="clusteringbegin",o.CLUSTERING_END="clusteringend",o.CLUSTER_CLICK="click",o}(it||{});const Wt=(o,e,t)=>{t.fitBounds(e.bounds)};class Kt extends ft{constructor({map:e,markers:t=[],algorithmOptions:s={},algorithm:n=new bt(s),renderer:r=new jt,onClusterClick:a=Wt}){super(),this.markers=[...t],this.clusters=[],this.algorithm=n,this.renderer=r,this.onClusterClick=a,e&&this.setMap(e)}addMarker(e,t){this.markers.includes(e)||(this.markers.push(e),t||this.render())}addMarkers(e,t){e.forEach(s=>{this.addMarker(s,!0)}),t||this.render()}removeMarker(e,t){const s=this.markers.indexOf(e);return-1!==s&&(T.setMap(e,null),this.markers.splice(s,1),t||this.render(),!0)}removeMarkers(e,t){let s=!1;return e.forEach(n=>{s=this.removeMarker(n,!0)||s}),s&&!t&&this.render(),s}clearMarkers(e){this.markers.length=0,e||this.render()}render(){const e=this.getMap();if(e instanceof google.maps.Map&&e.getProjection()){google.maps.event.trigger(this,it.CLUSTERING_BEGIN,this);const{clusters:t,changed:s}=this.algorithm.calculate({markers:this.markers,map:e,mapCanvasProjection:this.getProjection()});if(s||null==s){const n=new Set;for(const a of t)1==a.markers.length&&n.add(a.markers[0]);const r=[];for(const a of this.clusters)null!=a.marker&&(1==a.markers.length?n.has(a.marker)||T.setMap(a.marker,null):r.push(a.marker));this.clusters=t,this.renderClusters(),requestAnimationFrame(()=>r.forEach(a=>T.setMap(a,null)))}google.maps.event.trigger(this,it.CLUSTERING_END,this)}}onAdd(){this.idleListener=this.getMap().addListener("idle",this.render.bind(this)),this.render()}onRemove(){google.maps.event.removeListener(this.idleListener),this.reset()}reset(){this.markers.forEach(e=>T.setMap(e,null)),this.clusters.forEach(e=>e.delete()),this.clusters=[]}renderClusters(){const e=new Jt(this.markers,this.clusters),t=this.getMap();this.clusters.forEach(s=>{1===s.markers.length?s.marker=s.markers[0]:(s.marker=this.renderer.render(s,e,t),s.markers.forEach(n=>T.setMap(n,null)),this.onClusterClick&&s.marker.addListener("click",n=>{google.maps.event.trigger(this,it.CLUSTER_CLICK,s),this.onClusterClick(n,s,t)})),T.setMap(s.marker,t)})}}var _t=d(2001),Ot=d(5219),Dt=d(9315),vt=d(6306),W=d(2096),At=d(4664),St=d(5600),i=d(5879),N=d(5878),Yt=d(9862);const Qt=["mapElement"];function Gt(o,e){1&o&&i._UZ(0,"p-progressSpinner",12)}function Ht(o,e){1&o&&i._UZ(0,"i",28)}function Xt(o,e){1&o&&i._UZ(0,"i",29)}function qt(o,e){if(1&o&&(i.TgZ(0,"span"),i._uU(1),i.qZA(),i.YNc(2,Ht,1,0,"i",26),i.YNc(3,Xt,1,0,"i",27)),2&o){const t=e.$implicit;i.xp6(1),i.Oqu(null==t?null:t.label),i.xp6(1),i.Q6J("ngIf","asc"===(null==t?null:t.sort)),i.xp6(1),i.Q6J("ngIf","desc"===(null==t?null:t.sort))}}function te(o,e){1&o&&i._UZ(0,"i",28)}function ee(o,e){1&o&&i._UZ(0,"i",29)}function se(o,e){if(1&o&&(i.TgZ(0,"span"),i._uU(1),i.qZA(),i.YNc(2,te,1,0,"i",26),i.YNc(3,ee,1,0,"i",27)),2&o){const t=e.$implicit;i.xp6(1),i.Oqu(null==t?null:t.label),i.xp6(1),i.Q6J("ngIf","asc"===(null==t?null:t.sort)),i.xp6(1),i.Q6J("ngIf","desc"===(null==t?null:t.sort))}}const kt=function(){return{width:"90%"}};function ie(o,e){if(1&o){const t=i.EpF();i.TgZ(0,"div",22)(1,"p-dropdown",23),i.NdJ("ngModelChange",function(n){i.CHM(t);const r=i.oxw(3);return i.KtG(r.selectedSort=n)})("onChange",function(){i.CHM(t);const n=i.oxw(3);return i.KtG(n.sortTrips())}),i.YNc(2,qt,4,3,"ng-template",24),i.YNc(3,se,4,3,"ng-template",25),i.qZA()()}if(2&o){const t=i.oxw(3);i.xp6(1),i.Akn(i.DdM(6,kt)),i.Q6J("options",t.sortOptions)("ngModel",t.selectedSort)("showClear",!0)("group",!0)}}function ne(o,e){1&o&&i._UZ(0,"div",22)}function re(o,e){if(1&o){const t=i.EpF();i.TgZ(0,"div",22)(1,"p-dropdown",30),i.NdJ("ngModelChange",function(n){i.CHM(t);const r=i.oxw(3);return i.KtG(r.selectedExportOption=n)}),i.qZA()()}if(2&o){const t=i.oxw(3);i.xp6(1),i.Akn(i.DdM(5,kt)),i.Q6J("options",t.exportOptions)("ngModel",t.selectedExportOption)("showClear",!0)}}function oe(o,e){if(1&o){const t=i.EpF();i.TgZ(0,"div",17)(1,"div",18),i.NdJ("click",function(){i.CHM(t);const n=i.oxw(2);return i.KtG(n.toggleDropdown("sort"))}),i._UZ(2,"button",19),i.qZA()(),i.TgZ(3,"div",20),i.YNc(4,ie,4,7,"div",21),i.YNc(5,ne,1,0,"div",21),i.YNc(6,re,2,6,"div",21),i.qZA()}if(2&o){const t=i.oxw(2);i.xp6(4),i.Q6J("ngIf","sort"===t.dropdownVisible),i.xp6(1),i.Q6J("ngIf","filter"===t.dropdownVisible),i.xp6(1),i.Q6J("ngIf","export"===t.dropdownVisible)}}function ae(o,e){if(1&o&&(i.TgZ(0,"div",59)(1,"p",37),i._uU(2),i.qZA(),i._UZ(3,"img",60),i.qZA()),2&o){const t=i.oxw().$implicit;let s;i.xp6(2),i.Oqu(t.driverName?t.driverName:"NA"),i.xp6(1),i.Q6J("src",null!==(s=null==t.images?null:t.images[0])&&void 0!==s?s:"assets/demo/images/settings/person_placeholder.svg",i.LSH)("alt",t.driverName)}}const le=function(o,e){return{"trip-list-item-selected":o,"alternate-row":e}};function ce(o,e){if(1&o){const t=i.EpF();i.TgZ(0,"div",31,32),i.NdJ("click",function(){const r=i.CHM(t).$implicit,a=i.oxw(2);return i.KtG(a.getTripDetails(r))}),i.TgZ(2,"div",33)(3,"div",34)(4,"div",35)(5,"div",36)(6,"div",37),i._uU(7),i.qZA()()(),i._UZ(8,"img",38),i.YNc(9,ae,4,3,"ng-template",null,39,i.W1O),i.qZA(),i.TgZ(11,"div",40)(12,"div",41)(13,"div",42)(14,"span",43),i._UZ(15,"img",44),i._uU(16),i.qZA(),i._UZ(17,"div",45),i.TgZ(18,"span",46),i._UZ(19,"img",47),i._uU(20),i.qZA()(),i.TgZ(21,"div",48)(22,"div",49),i._UZ(23,"i",50)(24,"span",51),i.qZA(),i.TgZ(25,"div",52),i._UZ(26,"i",53)(27,"span",51),i.qZA(),i.TgZ(28,"div",54)(29,"span"),i._UZ(30,"i",55),i._uU(31),i.qZA()(),i.TgZ(32,"div",56)(33,"span",57),i._UZ(34,"i",58),i._uU(35),i.qZA()()()()()()()}if(2&o){const t=e.$implicit,s=e.rowIndex,n=i.oxw(2);let r;i.Q6J("ngClass",i.WLB(11,le,n.tripDetails.id_===t.id_,s%2!=1)),i.xp6(7),i.Oqu(t.driverName?t.driverName:"NA"),i.xp6(1),i.Q6J("src",null!==(r=null==t.images?null:t.images[0])&&void 0!==r?r:"assets/demo/images/settings/person_placeholder.svg",i.LSH)("alt",t.driverName),i.xp6(8),i.hij(" ",t.start_time_display?t.start_time_display:"N/A"," "),i.xp6(4),i.hij(" ",t.end_time_display?t.end_time_display:"N/A"," "),i.xp6(4),i.Q6J("innerHTML",n.getFormattedDuration(null==t?null:t.duration),i.oJD),i.xp6(3),i.Q6J("innerHTML",n.getFormattedDuration(null==t?null:t.idling_duration),i.oJD),i.xp6(4),i.AsE(" ",t.distance?t.distance:"N/A"," ",n.unit_header," "),i.xp6(4),i.hij(" ",t.deviceName?t.deviceName:"N/A"," ")}}function pe(o,e){if(1&o&&(i.TgZ(0,"p-dataView",13,14),i.YNc(2,oe,7,3,"ng-template",15),i.YNc(3,ce,36,14,"ng-template",16),i.qZA()),2&o){const t=i.oxw();i.Q6J("value",t.paginatedTrips)}}function de(o,e){if(1&o){const t=i.EpF();i.TgZ(0,"map-marker",67),i.NdJ("mapClick",function(){const r=i.CHM(t).$implicit,a=i.oxw(2);return i.KtG(a.openEventDetail(r))}),i.qZA()}if(2&o){const t=e.$implicit;i.Q6J("position",t.position)("label",t.label)("title",(null==t.etLabel?null:t.etLabel.join(", "))||t.title)("options",t.options)("clickable",!0)}}function me(o,e){if(1&o&&(i.TgZ(0,"div",61)(1,"div",62)(2,"h4"),i._uU(3,"Trip Detail"),i.qZA(),i.TgZ(4,"div",41),i._UZ(5,"hr"),i.TgZ(6,"div",63)(7,"google-map",64,65),i.YNc(9,de,1,5,"map-marker",66),i.qZA()()()()()),2&o){const t=i.oxw();i.xp6(7),i.Q6J("center",t.center)("zoom",t.zoom)("options",t.mapOptions),i.xp6(2),i.Q6J("ngForOf",t.markers)}}const he=function(){return[10,20,50,100]};let ge=(()=>{class o{rolesService;route;excelExportService;devicesService;tripsService;driversService;settingsService;http;eventService;utilsService;router;ngZone;toolbarComponent;mapElement;showSpinner=!1;paginatedTrips=[];dropdownVisible=null;selectedSort;exportOptions;selectedExportOption;sortOptions=[];first=0;totalRecords=0;page=0;rows=10;drivers=[];paginationObj={sort_order:"desc",items_per_page:10,page_number:1,sort_field:"start_time"};paginationObjDrivers={sort_order:"asc",items_per_page:1e6,page_number:1,sort_field:"name"};devicesList=[];selectedDevicesForSearch;unit_header="km";tripDetails={};compoundEventIcons={};compoundEventNames=[];center={lat:-26.234619,lng:28.229901};polylinePath=[];mapOptions={styles:[{featureType:"all",elementType:"labels",stylers:[{visibility:"on"}]},{featureType:"road",elementType:"geometry",stylers:[{visibility:"on"}]},{featureType:"road",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"road.highway",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"administrative",elementType:"geometry",stylers:[{visibility:"off"}]},{featureType:"poi",elementType:"geometry",stylers:[{visibility:"off"}]},{featureType:"poi",elementType:"labels.text",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"geometry",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"geometry",stylers:[{visibility:"on"}]},{featureType:"landscape",elementType:"geometry",stylers:[{visibility:"on"}]}]};startPosition;endPosition;startTime;endTime;endMarker;startMarker;constructor(t,s,n,r,a,c,l,m,h,g,u,f){this.rolesService=t,this.route=s,this.excelExportService=n,this.devicesService=r,this.tripsService=a,this.driversService=c,this.settingsService=l,this.http=m,this.eventService=h,this.utilsService=g,this.router=u,this.ngZone=f}ngOnInit(){this.exportOptions=[{label:"Excel",value:"excel"},{label:"CSV",value:"csv"}],this.selectedSort={label:"Start Time",value:"start_time",sort:"desc"}}afterToolLoaded(){this.showSpinner=!1,this.checkIfQueryParamsExist(),this.initData(),this.getTrips(),this.initEvents()}checkIfQueryParamsExist(){const t=this.route.snapshot.queryParams.driver_id;t&&(this.toolbarComponent.selectedDrivers=[{id_:t}],this.router.navigate([],{queryParams:{driver_id:null},queryParamsHandling:"merge"}))}initData(){this.sortOptions=[{label:"Trips",items:[{label:"Trip Duration",value:"duration",sort:"asc"},{label:"Trip Duration",value:"duration",sort:"desc"},{label:"Trip Distance",value:"distance",sort:"asc"},{label:"Trip Distance",value:"distance",sort:"desc"},{label:"Start Time",value:"start_time",sort:"asc"},{label:"Start Time",value:"start_time",sort:"desc"}]}],this.showSpinner=!1}initEvents(){this.toolbarComponent.allEvents.compound_events.forEach(t=>{null!=t.event_configuration&&(this.compoundEventIcons[t.name]=t.event_configuration.display_icon)}),this.compoundEventNames=this.toolbarComponent.allEvents.compound_events.map(t=>t.name)}orgSettings={};fetchTripData(t=!1){this.showSpinner=!0,this.tripDetails={};const s=_t.dc(),n=this.toolbarComponent.selectedDevices?.map(h=>h.id_),r=this.toolbarComponent.selectedDrivers?.map(h=>h.id_);let a=this.toolbarComponent.distanceRangeValues,c=this.toolbarComponent.durationRangeValues;c&&(c=c.map(h=>60*h));let l=this.toolbarComponent.idlingDurationRangeValues;l&&(l=l.map(h=>60*h)),"mi"==this.unit_header?a&&(a=a.map(h=>1609.34*h)):"km"==this.unit_header&&a&&(a=a.map(h=>1e3*h));const m=this.tripsService.getTripsList(this.toolbarComponent.fromDateUTC,this.toolbarComponent.toDateUTC,s,this.paginationObj,n&&n.length?n:void 0,r&&r.length?r:void 0,a||void 0,c||void 0,l||void 0);if(t){const h=this.driversService.fetchDrivers(this.toolbarComponent.fromDateUTC,this.toolbarComponent.toDateUTC,s,void 0,this.paginationObjDrivers),g=this.devicesService.fetchDevicesForFleets(s),u=this.settingsService.getOrgSettings();(0,Dt.D)([h,m,g,u]).subscribe(f=>{this.showSpinner=!1,this.drivers=f[0]?.data,this.paginatedTrips=f[1].data,this.totalRecords=f[1].total_items,this.devicesList=f[2],this.orgSettings=f[3],this.processTrips(f[1]),this.unit_header=f[3].settings.org_common_configurations.speed_unit==_t.J_[0].value?"km":"mi",this.paginatedTrips[0]&&this.getTripDetails(this.paginatedTrips[0])})}else m.subscribe(h=>{this.showSpinner=!1,this.paginatedTrips=h.data,this.totalRecords=h.total_items,this.processTrips(h),this.paginatedTrips?.[0]&&this.getTripDetails(this.paginatedTrips[0])})}getTrips(){this.fetchTripData(!0)}getOnlyTrips(){this.fetchTripData(!1)}processTrips(t){this.paginatedTrips.forEach(s=>{s.deviceName=this.devicesList.find(n=>n.id_===s.device_id)?.client_provided_id,s.driverName=this.drivers.find(n=>n.id_===s.driver_id)?.name,s.images=this.drivers.find(n=>n.id_===s.driver_id)?.images,s.distance="mi"==this.unit_header?621371e-9*s.distance:s.distance/1e3,s.start_time_display=this.utilsService.convertToTimezone(s.date+" "+s.start_time,this.orgSettings.timezone),s.end_time_display=this.utilsService.convertToTimezone(s.date+" "+s.end_time,this.orgSettings.timezone),s.distance=s.distance.toLocaleString(void 0,{maximumFractionDigits:2})})}toggleDropdown(t){this.dropdownVisible=this.dropdownVisible===t?null:t}sortTrips(){this.showSpinner=!1,this.paginationObj.sort_field=this.selectedSort.value,this.paginationObj.sort_order=this.selectedSort.sort,this.getOnlyTrips()}clickedTripEvents=[];getTripDetails(t){this.markers=[],this.showSpinner=!0;const s=this.tripsService.getTripDetails(t?.id_).pipe((0,vt.K)(a=>(console.error("Error fetching trip details:",a),(0,W.of)(null)))),n=t?.events,r=Array.isArray(n)&&n.length>0?n.map(a=>this.eventService.getSnapshotDetail(a).pipe((0,vt.K)(c=>(console.error("Error fetching event snapshot:",c),(0,W.of)(null))))):[];(0,Dt.D)([s,...r]).pipe((0,At.w)(a=>{const c=a[0],l=a.slice(1);return this.showSpinner=!1,this.tripDetails=c,this.tripDetails?.cloud_waypoint_presigned_url?this.http.get(this.tripDetails.cloud_waypoint_presigned_url,{responseType:"text"}).pipe((0,At.w)(m=>(this.parseData(m),(0,W.of)(l))),(0,vt.K)(m=>(console.error("There was an error fetching cloud waypoint data!",m),(0,W.of)(l)))):(0,W.of)(l)})).subscribe(a=>{this.eventsPositions=a.length>0?a:[],this.processClickedTripEvents()},a=>{console.error("Error in combined observable:",a)})}eventsPositions=[];getFormattedDuration(t){if(t&&t>0){const s=Math.floor(t/3600),n=Math.floor(t%3600/60),r=t%60;let m="";return s>0&&(m+=`<strong>${s}</strong> ${0===s||1===s?"hr":"hrs"} `),n>0&&(m+=`<strong>${n}</strong> ${0===n||1===n?"min":"mins"} `),s<1&&(r>0||""===m)&&(m+=`<strong>${r}</strong> ${1===r?"sec":"secs"}`),m.trim()}return"0 secs"}markers=[];zoom=12;wayPointMarkers=[];parseData(t){this.wayPointMarkers=[],t?(t.split("\n").forEach((n,r)=>{const a=n.split(",");if(a.length<10)return;const c=parseFloat(a[4]?.trim()),l=parseFloat(a[5]?.trim());isNaN(c)||isNaN(l)||this.wayPointMarkers.push({position:{lat:c,lng:l},gpstime:a[1]?.trim(),direction:a[3]?.trim(),speed:a[6]?.trim(),time:a[9]?.trim()})}),this.markers.sort((n,r)=>n.gpstime.localeCompare(r.gpstime)),this.polylinePath=this.markers.map(n=>n.position),this.markers.length>0?this.center=this.markers[0].position:console.warn("No valid markers found in the data.")):console.warn("No data provided to parse.")}createGlyphMarker(t,s,n,r,a,c,l,m=40,h,g=!1){let u;if(l){const p=document.createElement("img");p.src=l,p.style.width=`${m}px`,p.style.height=`${m}px`,u=p}else h&&(u=h);const f=new google.maps.marker.AdvancedMarkerElement({map:t,position:n,content:u});return f.addListener("click",()=>{let p="";if(c){const _=this.utilsService.convertToTimezone(c.gpstime,this.orgSettings.timezone);p=`\n                    <div class="p-3 pt-0">\n                        <h3 class="mb-3">${c.eventName||"Waypoint Detail"}</h3>\n                        <br>\n                        <div class="mb-3">\n                            <div class="inline-block w-7rem">GPS Timestamp:</div>\n                            <span class="font-bold">${_}</span>\n                        </div>\n                        <div class="mb-3">\n                            <div class="inline-block w-7rem">Latitude:</div>\n                            <span class="font-bold">${c.lat}</span>\n                        </div>\n                        <div class="mb-3">\n                            <div class="inline-block w-7rem">Longitude:</div>\n                            <span class="font-bold">${c.lng}</span>\n                        </div>\n                        <div class="mb-3">\n                            <div class="inline-block w-7rem">Speed:</div>\n                            <span class="font-bold">${c.speed} ${this.unit_header}/hr</span>\n                        </div>\n                        <div class="mb-3">\n                            <div class="inline-block w-7rem">Direction:</div>\n                            <span class="font-bold">${c.direction}</span>\n                        </div>\n                        ${c.etLabel?`\n                            <div class="mb-3">\n                                <div class="inline-block w-7rem">Event(s):</div>\n                                <span>\n                                    ${c.etLabel.map(y=>`<img class="vertical-align-middle events-icon text-center mr-2 w-3rem" \n                                             title="${this.utilsService.formatLabelForCharts(y)}" \n                                             src="${this.getItemIcon(y)}" \n                                             onerror="this.src='assets/demo/images/other/default.png'">`).join("")}\n                                </span>\n                            </div>\n                        `:""}\n                        <div class="mb-3">\n                            ${c.videos?`\n                                <div style="display: flex; flex-wrap: wrap; margin-top: 10px;">\n                                ${c.videos.road_front?.url?`\n                                    <div style="flex: 1 1 50%; padding: 5px;">\n                                        <video style="max-width: 100%;" src="${c.videos.road_front.url}" muted controls></video>\n                                    </div>\n                                `:""}\n                                ${c.videos.driver?.url?`\n                                    <div style="flex: 1 1 50%; padding: 5px;">\n                                        <video style="max-width: 100%;" src="${c.videos.driver.url}" muted controls></video>\n                                    </div>\n                                `:""}\n                                </div>\n                            `:""}\n                        </div>\n                    </div>\n                `}else p=`\n                    <div style="font-family: Arial, sans-serif; padding: 10px;">\n                        <h3 style="margin-top: 0; color: #333;">${"S"===a?"Start":"E"===a?"End":"Waypoint"} Point</h3>\n                        <p style="color: #666;">Time: ${(new Date).toLocaleString()}</p>\n                    </div>\n                `;s.setContent(p),s.open(t,f)}),f}processClickedTripEvents(){var t=this;return function pt(o){return function(){var e=this,t=arguments;return new Promise(function(s,n){var r=o.apply(e,t);function a(l){X(r,s,n,a,c,"next",l)}function c(l){X(r,s,n,a,c,"throw",l)}a(void 0)})}}(function*(){yield google.maps.importLibrary("maps"),yield google.maps.importLibrary("marker");const a=new google.maps.Map(t.mapElement.googleMap?.getDiv(),{zoom:3,center:{lat:t.eventsPositions[0]?.snapshot_metadata?.location?.latitude||-28.024,lng:t.eventsPositions[0]?.snapshot_metadata?.location?.longitude||140.887},mapId:"DEMO_MAP_ID"}),c=new google.maps.InfoWindow({content:"",disableAutoPan:!0});google.maps.event.addListenerOnce(c,"domready",()=>{const p=document.querySelector(".gm-ui-hover-effect");p&&(p.style.height="26px")});const l=t.eventsPositions.map((p,_)=>{let y=p.snapshot_metadata?.location?.latitude,M=p.snapshot_metadata?.location?.longitude;if("number"==typeof y&&"number"==typeof M&&!isNaN(y)&&!isNaN(M)){const E=document.createElement("div");E.style.width="40px",E.style.height="50px",E.style.position="relative";const b=document.createElement("div");b.style.width="50px",b.style.height="50px",b.style.borderRadius="50% 50% 50% 0",b.style.background="red",b.style.position="absolute",b.style.transform="rotate(-45deg)",b.style.top="0",b.style.left="0",b.style.boxShadow="0 2px 5px rgba(0,0,0,0.3)";const x=document.createElement("div");if(x.style.width="40px",x.style.height="40px",x.style.position="absolute",x.style.top="5px",x.style.left="5px",x.style.background="white",x.style.borderRadius="50%",x.style.display="flex",x.style.justifyContent="center",x.style.alignItems="center",p.et_label&&Array.isArray(p.et_label)&&[...new Set(p.et_label)].forEach((O,V)=>{if(!t.compoundEventNames.includes(O)){const D=document.createElement("img");D.src=t.getItemIcon(O),D.style.width="30px",D.style.height="30px",D.style.position="absolute",D.style.top="5px",D.style.left="5px",D.onerror=()=>{D.src="assets/demo/images/other/default.png"},V>0&&(D.style.transform=`translate(${5*V}px, ${5*V}px)`),x.appendChild(D)}}),0===x.childElementCount){const U=document.createElement("img");U.src="/assets/demo/images/icons/video.svg",U.style.width="20px",U.style.height="20px",x.appendChild(U)}return E.appendChild(b),E.appendChild(x),t.createGlyphMarker(a,c,{lat:y,lng:M},"red","E",{eventName:"Event Detail",gpstime:p.timestamp,lat:p.snapshot_metadata?.location?.latitude,lng:p.snapshot_metadata?.location?.longitude,speed:p.snapshot_metadata?.final_speed,direction:p.direction||"NA",videos:p.snapshot_metadata?.snapshot_info?.videos,etLabel:p.et_label},void 0,void 0,E,!0)}return console.warn(`Invalid coordinates for event ${_+1}:`,{lat:y,lng:M}),null}).filter(p=>null!==p);t.wayPointMarkers.length>0&&(t.startPosition=t.wayPointMarkers[0].position,t.endPosition=t.wayPointMarkers[t.wayPointMarkers.length-1].position,t.startTime=t.wayPointMarkers[0].gpstime,t.endTime=t.wayPointMarkers[t.wayPointMarkers.length-1].gpstime),t.startPosition&&(t.startMarker=t.createGlyphMarker(a,c,t.startPosition,"green","S",{eventName:"Start Position",gpstime:t.startTime,lat:t.startPosition.lat,lng:t.startPosition.lng},"/assets/demo/images/icons/start_marker.svg",40)),t.endPosition&&(t.endMarker=t.createGlyphMarker(a,c,t.endPosition,"red","E",{eventName:"End Position",gpstime:t.endTime,lat:t.endPosition.lat,lng:t.endPosition.lng},"/assets/demo/images/icons/end_marker.svg",40));const m=t.wayPointMarkers.map(p=>{if("number"==typeof p.position.lat&&"number"==typeof p.position.lng){const _=document.createElement("div");return _.style.width="12px",_.style.height="12px",_.style.borderRadius="50%",_.style.backgroundColor="#FF3131",t.createGlyphMarker(a,c,{lat:p.position.lat,lng:p.position.lng},"#C71585","",{eventName:"Waypoint Detail",gpstime:p.gpstime,direction:p.direction,speed:p.speed,lat:p.position.lat,lng:p.position.lng},void 0,void 0,_)}return null}).filter(p=>null!==p);let h,g;if(t.wayPointMarkers.length>0){const p=t.wayPointMarkers[0],_=t.wayPointMarkers[t.wayPointMarkers.length-1];p&&_&&(h=t.createGlyphMarker(a,c,{lat:p.position.lat,lng:p.position.lng},"#00FF00","S",{eventName:"Start Point",gpstime:p.gpstime,lat:p.position.lat,lng:p.position.lng,speed:p.speed,direction:p.direction},"/assets/demo/images/icons/start_marker.svg"),g=t.createGlyphMarker(a,c,{lat:_.position.lat,lng:_.position.lng},"#0000FF","E",{eventName:"End Point",gpstime:_.gpstime,lat:_.position.lat,lng:_.position.lng,speed:_.speed,direction:_.direction},"/assets/demo/images/icons/end_marker.svg"))}new Kt({markers:m,map:a,algorithm:new bt({maxZoom:15,radius:60})}),t.markers=[...l,...m,h,g].filter(Boolean);const u=t.wayPointMarkers.map(p=>({lat:p.position.lat,lng:p.position.lng})).filter(p=>"number"==typeof p.lat&&"number"==typeof p.lng);new google.maps.Polyline({path:u,geodesic:!0,strokeColor:"#0000FF",strokeOpacity:.8,strokeWeight:8}).setMap(a);const v=new google.maps.LatLngBounds;[...t.markers,t.startMarker,t.endMarker].forEach(p=>{p&&p.position&&v.extend(p.position)}),a.fitBounds(v,50),google.maps.event.addListenerOnce(a,"idle",()=>{a?.getZoom?.()&&a?.setZoom?.(15)})})()}filterTripsByDevices(t){this.selectedDevicesForSearch=t,this.showSpinner=!0,this.getOnlyTrips()}eventDetailDialogVisible=!1;waypointDetailDialogVisible=!1;selectedEvent={};openEventDetail(t){this.ngZone.run(()=>{this.selectedEvent={},t.eventId?this.eventDetailDialogVisible=!0:this.waypointDetailDialogVisible=!0,t.gpstime&&(t.gpstime_display=this.utilsService.convertToTimezone(t.gpstime,this.orgSettings.timezone)),t.time&&(t.time_display=this.utilsService.convertToTimezone(t.time,this.orgSettings.timezone)),this.selectedEvent=t})}getItemIcon(t){let s="assets/demo/images/events/"+t+"-grey.svg";return null!=this.compoundEventIcons[t]&&(s=this.compoundEventIcons[t]),s}isInteger(t){return Number.isInteger(t)}formatSpeed(t){return t=this.isInteger(t)?t:Math.round(t),this.isInteger(t)?t.toString():t?.toFixed(2)}onPageChangeTrips(t){this.first=t.first,this.rows=t.rows,this.paginationObj.items_per_page=this.rows,this.paginate()}paginate(){this.showSpinner=!1,this.paginationObj.page_number=this.first/this.rows+1,this.getOnlyTrips()}static \u0275fac=function(s){return new(s||o)(i.Y36(N.Nj),i.Y36(R.gz),i.Y36(_t.U0),i.Y36(N.Ih),i.Y36(N.QS),i.Y36(N.Ft),i.Y36(N.gb),i.Y36(Yt.eN),i.Y36(N.nC),i.Y36(N.FW),i.Y36(R.F0),i.Y36(i.R0b))};static \u0275cmp=i.Xpm({type:o,selectors:[["app-trips"]],viewQuery:function(s,n){if(1&s&&(i.Gf(St.n,5),i.Gf(Qt,5)),2&s){let r;i.iGM(r=i.CRH())&&(n.toolbarComponent=r.first),i.iGM(r=i.CRH())&&(n.mapElement=r.first)}},features:[i._Bn([Ot.ez])],decls:15,vars:14,consts:[[3,"showEvents","showDevices","showDrivers","showDistance","showDuration","showIdlingDuration","filterData","loaded"],["toolbarComponent",""],[1,"drivers-spinner"],["styleClass","w-5rem h-5rem",4,"ngIf"],[1,"grid","mt-4"],[1,"md:col-3","col-12"],["id","trips-list-card",1,"card","h-full","drivers-card","card-scroll-container"],[1,"inline-block","ml-2"],["filterBy","driver_name","layout","list",3,"value",4,"ngIf"],["currentPageReportTemplate","{first} to {last} of {totalRecords} trips",3,"showCurrentPageReport","rows","rowsPerPageOptions","totalRecords","onPageChange"],["paginator",""],["class","md:col-9 col-12 h-full",4,"ngIf"],["styleClass","w-5rem h-5rem"],["filterBy","driver_name","layout","list",3,"value"],["driversList",""],["pTemplate","header"],["pTemplate","listItem"],[1,"icon-container"],[1,"icon-wrapper",3,"click"],["pButton","","pRipple","","type","button","icon","pi pi-sort-alt",1,"p-button-rounded","p-button-text","p-button-secondary"],[1,"w-full","mt-1"],["class","dropdown-content",4,"ngIf"],[1,"dropdown-content"],["id","sort","appendTo","body","placeholder","Sort by","optionLabel","label","styleClass","ml-2",3,"options","ngModel","showClear","group","ngModelChange","onChange"],["pTemplate","item"],["pTemplate","selectedItem"],["class","pi pi-arrow-up ml-2",4,"ngIf"],["class","pi pi-arrow-down ml-2",4,"ngIf"],[1,"pi","pi-arrow-up","ml-2"],[1,"pi","pi-arrow-down","ml-2"],["id","export","appendTo","body","placeholder","Export as ","optionLabel","label","styleClass","ml-2",3,"options","ngModel","showClear","ngModelChange"],[1,"align-items-center","cursor-pointer","py-2","px-2","w-full",3,"ngClass","click"],["driverListItem",""],[1,"grid","align-items-center","py-2"],[1,"col-12","md:col-4","text-center"],[1,"grid","align-items-center","text-center"],[1,"col-12","text-center"],[1,"font-semibold","text-l"],[1,"md:my-0","w-9","md:w-4rem","shadow-2","w-2rem","mt-2","driver-list-img",3,"src","alt"],["enlargeImage",""],[1,"col-12","md:col-8"],[1,"grid"],[1,"col-12"],["title","Start Time For Trip",1,"mr-3"],["src","assets/demo/images/icons/start_marker.svg","alt","Start",1,"mr-1","vertical-align-bottom",2,"width","18px"],[1,"mt-1"],["title","End Time For Trip",1,"mr-3"],["src","assets/demo/images/icons/end_marker.svg","alt","End",1,"mr-1","vertical-align-bottom",2,"width","18px"],["title","Duration",1,"col-12","md:col-8","text-center"],[1,"text-left"],[1,"pi","pi-clock","mr-2","vertical-align-middle","text-primary"],[3,"innerHTML"],["title","Idling Duration",1,"mt-2","text-left"],[1,"pi","pi-pause","mr-2","vertical-align-middle","text-primary"],["title","Distance",1,"mt-2","text-left"],[1,"pi","pi-compass","mr-1","vertical-align-bottom","text-primary"],["title","Device",1,"mt-2","text-left"],[1,"text-sm"],[1,"pi","pi-bars","mr-1","vertical-align-bottom","text-primary"],[1,"block","m-w-25rem","text-left"],[1,"m-w-25rem",3,"src","alt"],[1,"md:col-9","col-12","h-full"],[1,"card","maps-card"],[1,"col-12","mt-3"],["height","400px","width","100%",3,"center","zoom","options"],["mapElement",""],[3,"position","label","title","options","clickable","mapClick",4,"ngFor","ngForOf"],[3,"position","label","title","options","clickable","mapClick"]],template:function(s,n){1&s&&(i.TgZ(0,"app-toolbar",0,1),i.NdJ("filterData",function(){return n.afterToolLoaded()})("loaded",function(){return n.afterToolLoaded()}),i.qZA(),i._UZ(2,"p-toast"),i.TgZ(3,"div",2),i.YNc(4,Gt,1,0,"p-progressSpinner",3),i.qZA(),i.TgZ(5,"div",4)(6,"div",5)(7,"div",6)(8,"h5",7),i._uU(9,"Trips List"),i.qZA(),i._UZ(10,"br"),i.YNc(11,pe,4,1,"p-dataView",8),i.TgZ(12,"p-paginator",9,10),i.NdJ("onPageChange",function(a){return n.onPageChangeTrips(a)}),i.qZA()()(),i.YNc(14,me,10,4,"div",11),i.qZA()),2&s&&(i.Q6J("showEvents",!1)("showDevices",!0)("showDrivers",!0)("showDistance",!0)("showDuration",!0)("showIdlingDuration",!0),i.xp6(4),i.Q6J("ngIf",n.showSpinner),i.xp6(7),i.Q6J("ngIf",n.paginatedTrips&&n.paginatedTrips.length>0),i.xp6(1),i.Q6J("showCurrentPageReport",!0)("rows",n.rows)("rowsPerPageOptions",i.DdM(13,he))("totalRecords",n.totalRecords),i.xp6(2),i.Q6J("ngIf",n.tripDetails))},dependencies:[w.mk,w.sg,w.O5,St.n,K.VO,Ot.jx,A.Hq,Y.Lt,P.JJ,P.On,H.FN,Q.D,G.G,C.b6,C.O_],styles:["[_nghost-%COMP%]  .p-dataview{height:75vh;overflow-y:auto}[_nghost-%COMP%]  app-big-metrics-card .card{min-width:180px}[_nghost-%COMP%]  .drivers-spinner p-progressSpinner{position:absolute;top:50%;left:50%;z-index:10}[_nghost-%COMP%]  .map-container{width:100%!important;height:90vh!important;min-height:650px}[_nghost-%COMP%]  .custom-label{margin-bottom:55px}[_nghost-%COMP%]  .p-component-overlay-enter{z-index:1100000001}.trip-list-item-selected[_ngcontent-%COMP%]{background:linear-gradient(0deg,rgba(47,111,123,.1),rgba(47,111,123,.1)),#f0f8ff}.alternate-row[_ngcontent-%COMP%]{background-color:#f7f7f7}.icon-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;background:rgb(241,245,249);border:1px solid #ccc}.icon-wrapper[_ngcontent-%COMP%]{position:relative}.dropdown-content[_ngcontent-%COMP%]{position:relative;z-index:1000;box-shadow:0 4px 8px #0003;background:white;border-radius:4px;padding:10px;margin-top:10px;width:auto}.driver-list-img[_ngcontent-%COMP%]{width:4.5rem!important;border-radius:2em!important}.events-icon[_ngcontent-%COMP%]{width:34px}#trips-list-card.card[_ngcontent-%COMP%]{padding-left:0!important;padding-right:0!important}"]})}return o})(),ue=(()=>{class o{static \u0275fac=function(s){return new(s||o)};static \u0275mod=i.oAB({type:o});static \u0275inj=i.cJS({imports:[R.Bz.forChild([{path:"",component:ge,data:{breadcrumb:"Trips",route:"trips"}}]),R.Bz]})}return o})(),fe=(()=>{class o{static \u0275fac=function(s){return new(s||o)};static \u0275mod=i.oAB({type:o});static \u0275inj=i.cJS({imports:[w.ez,ct.l,ue,K.FI,A.hJ,Y.kW,F._8,ot.j,P.u5,rt.S,H.EV,Q.U,G.L,lt.m,C.Y4,at.q4]})}return o})()},7291:nt=>{nt.exports=function L(d,w){if(d===w)return!0;if(d&&w&&"object"==typeof d&&"object"==typeof w){if(d.constructor!==w.constructor)return!1;var P,C,A;if(Array.isArray(d)){if((P=d.length)!=w.length)return!1;for(C=P;0!=C--;)if(!L(d[C],w[C]))return!1;return!0}if(d.constructor===RegExp)return d.source===w.source&&d.flags===w.flags;if(d.valueOf!==Object.prototype.valueOf)return d.valueOf()===w.valueOf();if(d.toString!==Object.prototype.toString)return d.toString()===w.toString();if((P=(A=Object.keys(d)).length)!==Object.keys(w).length)return!1;for(C=P;0!=C--;)if(!Object.prototype.hasOwnProperty.call(w,A[C]))return!1;for(C=P;0!=C--;){var F=A[C];if(!L(d[F],w[F]))return!1}return!0}return d!=d&&w!=w}}}]);