"use strict";(self.webpackChunkedgetensor=self.webpackChunkedgetensor||[]).push([[472],{472:(ve,U,c)=>{c.r(U),c.d(U,{EventReportModule:()=>ze});var x=c(6814),T=c(6223),n=c(707),J=c(9146),M=c(4237),Q=c(3530),Y=c(2160),H=c(3714),L=c(6218),k=c(1712),q=c(7680),z=c(1865),G=c(6128),W=c(9552),X=c(6263),$=c(4104),V=c(3259),K=c(1037),ee=c(711),te=c(5594),ie=c(146),ne=c(1967),F=c(3173),b=c(2001),O=c(5219),oe=c(9315),B=c(5600),e=c(5879),S=c(5878),se=c(5700),re=c(8093),ae=c(718),le=c(3516);function ce(o,d){1&o&&e._UZ(0,"p-progressSpinner",6)}function de(o,d){if(1&o){const t=e.EpF();e.TgZ(0,"div",7)(1,"div",8)(2,"p-messages",9),e.NdJ("valueChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.showOnlyEventListMessage=i)}),e.qZA()()()}if(2&o){const t=e.oxw();e.xp6(2),e.Q6J("value",t.showOnlyEventListMessage)("enableService",!1)("closable",!1)}}const Z=function(o){return{"selected-card":o}};function _e(o,d){if(1&o){const t=e.EpF();e.TgZ(0,"div",11)(1,"div",12)(2,"div",13)(3,"app-big-metrics-card",14),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.getFilteredEvents("telematics",i.selectedSecondaryCard,!0))}),e.qZA()(),e.TgZ(4,"div",13)(5,"app-big-metrics-card",14),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.getFilteredEvents("dms",i.selectedSecondaryCard,!0))}),e.qZA()(),e.TgZ(6,"div",13)(7,"app-big-metrics-card",14),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.getFilteredEvents("adas",i.selectedSecondaryCard,!0))}),e.qZA()(),e.TgZ(8,"div",13)(9,"app-big-metrics-card",14),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.getFilteredEvents("compound",i.selectedSecondaryCard,!0))}),e.qZA()()(),e.TgZ(10,"div",12)(11,"div",13)(12,"app-small-metrics-card",14),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.getFilteredEvents(i.selectedCard,"reviewed",!1))}),e.qZA()(),e.TgZ(13,"div",13)(14,"app-small-metrics-card",14),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.getFilteredEvents(i.selectedCard,"incorrect",!1))}),e.qZA()(),e.TgZ(15,"div",13)(16,"app-small-metrics-card",14),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.getFilteredEvents(i.selectedCard,"correct",!1))}),e.qZA()()(),e.TgZ(17,"div",15),e._UZ(18,"app-small-metrics-card",16),e.qZA()()}if(2&o){const t=e.oxw(2);e.xp6(2),e.Q6J("ngClass",e.VKq(23,Z,"telematics"===t.selectedCard)),e.xp6(1),e.Q6J("metricsName","Telematics Events")("metricsNumber",null==t.videosCount?null:t.videosCount.telematicsCount),e.xp6(1),e.Q6J("ngClass",e.VKq(25,Z,"dms"===t.selectedCard)),e.xp6(1),e.Q6J("metricsName","Driver Facing Camera Events")("metricsNumber",null==t.videosCount?null:t.videosCount.dmsCount),e.xp6(1),e.Q6J("ngClass",e.VKq(27,Z,"adas"===t.selectedCard)),e.xp6(1),e.Q6J("metricsName","Road Facing Camera Events")("metricsNumber",null==t.videosCount?null:t.videosCount.adasCount),e.xp6(1),e.Q6J("ngClass",e.VKq(29,Z,"compound"===t.selectedCard)),e.xp6(1),e.Q6J("metricsName","Compound Events")("metricsNumber",null==t.videosCount?null:t.videosCount.compoundEventsCount),e.xp6(2),e.Q6J("ngClass",e.VKq(31,Z,"reviewed"===t.selectedSecondaryCard)),e.xp6(1),e.Q6J("metricsName","Reviewed Snapshots")("metricsNumber",t.totalReviewedEvents(t.eventsSummary)),e.xp6(1),e.Q6J("ngClass",e.VKq(33,Z,"incorrect"===t.selectedSecondaryCard)),e.xp6(1),e.Q6J("metricsName","Incorrect Snapshots")("metricsNumber",t.eventsSummary.incorrect),e.xp6(1),e.Q6J("ngClass",e.VKq(35,Z,"correct"===t.selectedSecondaryCard)),e.xp6(1),e.Q6J("metricsName","Correct Snapshots")("metricsNumber",t.eventsSummary.correct),e.xp6(2),e.Q6J("metricsName","Total Snapshots")("metricsNumber",t.totalRecords)}}function pe(o,d){if(1&o&&(e.TgZ(0,"div",7),e.YNc(1,_e,19,37,"div",10),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.rolesService.hasAccess("2005")&&t.eventsSummary)}}function me(o,d){if(1&o&&(e.TgZ(0,"div",7)(1,"div",8)(2,"div",17),e._uU(3,"Events Summary"),e.qZA(),e._UZ(4,"p-chart",18),e.qZA()()),2&o){const t=e.oxw();e.xp6(4),e.Q6J("data",t.data)("options",t.options)("height","450")}}function a(o,d){if(1&o&&(e._UZ(0,"i",27),e._uU(1)),2&o){const t=d.$implicit;e.Q6J("ngClass",t.icon),e.xp6(1),e.hij(" ",t.label," ")}}function v(o,d){if(1&o){const t=e.EpF();e.TgZ(0,"video",62),e.NdJ("loadeddata",function(i){e.CHM(t);const r=e.oxw(5);return e.KtG(r.onVideoLoaded(i))}),e._uU(1," Your browser does not support the video tag. "),e.qZA()}if(2&o){const t=e.oxw(2).$implicit;e.s9C("id",t.id_),e.Q6J("src",t.videos.road_front.url,e.LSH)("muted",!0)}}function l(o,d){if(1&o&&(e.TgZ(0,"div",58)(1,"div",59),e._UZ(2,"div",60),e.YNc(3,v,2,3,"video",61),e.qZA()()),2&o){const t=e.oxw().$implicit;e.xp6(2),e.MGl("id","",t.id_,"-backdrop"),e.xp6(1),e.Q6J("ngIf",t.videos.road_front.url)}}function m(o,d){if(1&o){const t=e.EpF();e.TgZ(0,"video",62),e.NdJ("loadeddata",function(i){e.CHM(t);const r=e.oxw(5);return e.KtG(r.onVideoLoaded(i))}),e._uU(1," Your browser does not support the video tag. "),e.qZA()}if(2&o){const t=e.oxw(2).$implicit;e.s9C("id",t.id_),e.Q6J("src",t.videos.driver.url,e.LSH)("muted",!0)}}function u(o,d){if(1&o&&(e.TgZ(0,"div",58)(1,"div",59),e._UZ(2,"div",60),e.YNc(3,m,2,3,"video",61),e.qZA()()),2&o){const t=e.oxw().$implicit;e.xp6(2),e.MGl("id","",t.id_,"-backdrop"),e.xp6(1),e.Q6J("ngIf",t.videos.driver.url)}}function E(o,d){if(1&o&&e._UZ(0,"img",66),2&o){const t=e.oxw().$implicit,s=e.oxw(5);e.s9C("title",s.utilsService.formatLabelForCharts(t)),e.Q6J("src","assets/demo/images/events/"+t+"-red.svg",e.LSH)}}function N(o,d){if(1&o&&(e.ynx(0),e.YNc(1,E,1,2,"img",65),e.BQk()),2&o){const t=d.$implicit,s=e.oxw(5);e.xp6(1),e.Q6J("ngIf",!s.compoundEventNames.includes(t))}}function ge(o,d){if(1&o&&(e.TgZ(0,"div",63),e.YNc(1,N,2,1,"ng-container",64),e.qZA()),2&o){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",t.events_occured)}}function he(o,d){1&o&&e._UZ(0,"i"),2&o&&e.Tol(d.$implicit.icon)}function fe(o,d){if(1&o&&(e.ynx(0),e.TgZ(1,"h6",67),e._uU(2),e.qZA(),e.BQk()),2&o){const t=e.oxw(2).$implicit,s=e.oxw(3);e.xp6(2),e.hij(" ",s.driver_id_name_map[t.driver_id]," ")}}function Ce(o,d){if(1&o&&(e.ynx(0),e.YNc(1,fe,3,1,"ng-container",44),e.BQk()),2&o){const t=e.oxw().$implicit,s=e.MAs(18),i=e.oxw(3);e.xp6(1),e.Q6J("ngIf",i.driver_id_name_map[t.driver_id]&&""!==i.driver_id_name_map[t.driver_id])("ngIfElse",s)}}function xe(o,d){1&o&&(e.TgZ(0,"span",68),e._uU(1,"Driver Unenrolled"),e.qZA())}function be(o,d){1&o&&(e.TgZ(0,"span",68),e._uU(1,"NA"),e.qZA())}function Ee(o,d){if(1&o){const t=e.EpF();e.TgZ(0,"p-button",69),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit,r=e.oxw(3);return e.KtG(r.goToSmartEnroll(i))}),e.qZA()}}function Te(o,d){if(1&o){const t=e.EpF();e.TgZ(0,"p-button",70),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit,r=e.oxw(3);return e.KtG(r.editDriverDetails(i))}),e.qZA()}}function we(o,d){if(1&o){const t=e.EpF();e.TgZ(0,"p-button",71),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit,r=e.oxw(3);return e.KtG(r.goToDriverAnalytics(i))}),e.qZA()}}function ye(o,d){if(1&o){const t=e.EpF();e.TgZ(0,"div",31)(1,"div",32)(2,"div",33),e.YNc(3,l,4,2,"div",34),e.YNc(4,u,4,2,"div",34),e.TgZ(5,"div",35)(6,"div",36)(7,"div",37),e.YNc(8,ge,2,1,"div",38),e.qZA(),e.TgZ(9,"div",39)(10,"div",40)(11,"p-selectButton",41),e.NdJ("onChange",function(i){const _=e.CHM(t).$implicit,p=e.oxw(3);return e.KtG(p.onToggleVideoType(i,_))}),e.YNc(12,he,1,2,"ng-template",42),e.qZA()()(),e.TgZ(13,"div",43),e.YNc(14,Ce,2,2,"ng-container",44),e.YNc(15,xe,2,0,"ng-template",null,45,e.W1O),e.YNc(17,be,2,0,"ng-template",null,46,e.W1O),e.qZA(),e.TgZ(19,"div",47),e.YNc(20,Ee,1,0,"p-button",48),e.YNc(21,Te,1,0,"p-button",49),e.YNc(22,we,1,0,"p-button",50),e.TgZ(23,"p-button",51),e.NdJ("click",function(){const r=e.CHM(t).$implicit,_=e.oxw(3);return e.KtG(_.goToDriverDetail(r))}),e.qZA()(),e.TgZ(24,"div",52)(25,"div",53),e._uU(26," Event Id:"),e.qZA(),e.TgZ(27,"span",54),e._uU(28),e.qZA(),e.TgZ(29,"i",55),e.NdJ("click",function(){const r=e.CHM(t).$implicit,_=e.oxw(3);return e.KtG(_.copyToClipboard(r.client_provided_id,"Event"))}),e.qZA()(),e.TgZ(30,"div",56)(31,"div",57),e._uU(32," Face Count:"),e.qZA(),e.TgZ(33,"span"),e._uU(34),e.qZA()(),e.TgZ(35,"div",7),e._uU(36),e.qZA()()()()()()}if(2&o){const t=d.$implicit,s=e.MAs(16),i=e.oxw(3);e.xp6(3),e.Q6J("ngIf",t.showAdas),e.xp6(1),e.Q6J("ngIf",!t.showAdas),e.xp6(4),e.Q6J("ngIf",null==t.events_occured?null:t.events_occured[0]),e.xp6(3),e.Q6J("options",i.videoToggleOptions),e.xp6(3),e.Q6J("ngIf",t.driver_id)("ngIfElse",s),e.xp6(6),e.Q6J("ngIf",!t.driver_id||""==t.driver_id),e.xp6(1),e.Q6J("ngIf",t.driver_id&&""!==t.driver_id),e.xp6(1),e.Q6J("ngIf",t.driver_id&&""!==t.driver_id),e.xp6(5),e.s9C("title",t.client_provided_id),e.xp6(1),e.Oqu(t.client_provided_id?"":"N/A"),e.xp6(1),e.s9C("title",t.client_provided_id),e.xp6(5),e.hij(" ",null!=(null==t.videos||null==t.videos.driver?null:t.videos.driver.in_cabin_face_count)?t.videos.driver.in_cabin_face_count:"N/A",""),e.xp6(2),e.hij(" ",t.timestamp?i.getTimetoDisplay(t.timestamp,!1).substring(0,16):"Timestamp: NA"," ")}}function Se(o,d){if(1&o&&(e.ynx(0),e.TgZ(1,"p-dataView",28,29),e.YNc(3,ye,37,14,"ng-template",30),e.qZA(),e.BQk()),2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("value",t.video_list)}}function Ze(o,d){1&o&&(e.TgZ(0,"tr"),e._UZ(1,"th"),e.TgZ(2,"th",75),e._uU(3,"Driver Name "),e.qZA(),e.TgZ(4,"th",75),e._uU(5,"Events"),e.qZA(),e.TgZ(6,"th",75),e._uU(7,"Date"),e.qZA(),e.TgZ(8,"th",75),e._uU(9,"Device Id"),e.qZA(),e.TgZ(10,"th",75),e._uU(11,"Face Count"),e.qZA(),e.TgZ(12,"th",75),e._uU(13,"Coaching Review Status"),e.qZA(),e.TgZ(14,"th",75),e._uU(15,"Event Id "),e.qZA()())}function Ie(o,d){if(1&o){const t=e.EpF();e.TgZ(0,"p-button",92),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit,r=e.oxw(4);return e.KtG(r.goToSmartEnroll(i))}),e.qZA()}}function Re(o,d){if(1&o){const t=e.EpF();e.TgZ(0,"p-button",93),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit,r=e.oxw(4);return e.KtG(r.editDriverDetails(i))}),e.qZA()}}function Ae(o,d){if(1&o){const t=e.EpF();e.TgZ(0,"p-button",94),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit,r=e.oxw(4);return e.KtG(r.goToDriverAnalytics(i))}),e.qZA()}}function Ne(o,d){if(1&o&&(e.TgZ(0,"div",95),e._UZ(1,"img",96),e.qZA()),2&o){const t=e.oxw().$implicit,s=e.oxw(4);e.xp6(1),e.Q6J("src",s.driver_id_photo_map[t.driver_id]||"assets/demo/images/settings/person_placeholder.svg",e.LSH)("alt",s.driver_id_name_map[t.driver_id])}}function De(o,d){if(1&o&&(e.ynx(0),e.TgZ(1,"h6",67),e._uU(2),e.qZA(),e.BQk()),2&o){const t=e.oxw(2).$implicit,s=e.oxw(4);e.xp6(2),e.hij(" ",s.driver_id_name_map[t.driver_id]," ")}}function Je(o,d){if(1&o&&(e.ynx(0),e.YNc(1,De,3,1,"ng-container",44),e.BQk()),2&o){const t=e.oxw().$implicit,s=e.MAs(15),i=e.oxw(4);e.xp6(1),e.Q6J("ngIf",i.driver_id_name_map[t.driver_id]&&""!==i.driver_id_name_map[t.driver_id])("ngIfElse",s)}}function Me(o,d){1&o&&(e.TgZ(0,"span",68),e._uU(1,"Driver Unenrolled"),e.qZA())}function Qe(o,d){1&o&&(e.TgZ(0,"span",68),e._uU(1,"NA"),e.qZA())}function ke(o,d){if(1&o&&e._UZ(0,"img",66),2&o){const t=e.oxw().$implicit;e.s9C("title",t),e.Q6J("src","assets/demo/images/events/"+t+"-red.svg",e.LSH)}}function Fe(o,d){if(1&o&&(e.ynx(0),e.YNc(1,ke,1,2,"img",65),e.BQk()),2&o){const t=d.$implicit,s=e.oxw(6);e.xp6(1),e.Q6J("ngIf",!s.compoundEventNames.includes(t))}}function Oe(o,d){if(1&o&&(e.TgZ(0,"div",97),e.YNc(1,Fe,2,1,"ng-container",64),e.qZA()),2&o){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngForOf",t.events_occured)}}function Pe(o,d){if(1&o){const t=e.EpF();e.TgZ(0,"i",91),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit,r=e.oxw(4);return e.KtG(r.copyToClipboard(i.client_device_id,"Device"))}),e.qZA()}}const Ue=function(o){return{"highlighted-row":o}};function Ye(o,d){if(1&o){const t=e.EpF();e.TgZ(0,"tr",77),e.NdJ("click",function(){const r=e.CHM(t).rowIndex,_=e.oxw(4);return e.KtG(_.selectRow(r))}),e.TgZ(1,"td")(2,"div",78)(3,"p-button",79),e.NdJ("click",function(){const r=e.CHM(t).$implicit,_=e.oxw(4);return e.KtG(_.goToDriverDetail(r))}),e.qZA(),e.YNc(4,Ie,1,0,"p-button",80),e.YNc(5,Re,1,0,"p-button",81),e.YNc(6,Ae,1,0,"p-button",82),e.qZA()(),e.TgZ(7,"td",83),e._UZ(8,"img",84),e.YNc(9,Ne,2,2,"ng-template",null,85,e.W1O),e.YNc(11,Je,2,2,"ng-container",44),e.YNc(12,Me,2,0,"ng-template",null,45,e.W1O),e.YNc(14,Qe,2,0,"ng-template",null,46,e.W1O),e.qZA(),e.TgZ(16,"td",75),e.YNc(17,Oe,2,1,"div",86),e.qZA(),e.TgZ(18,"td",75)(19,"span"),e._uU(20),e.qZA()(),e.TgZ(21,"td",75)(22,"span",87),e._uU(23),e.qZA(),e.YNc(24,Pe,1,0,"i",88),e.qZA(),e.TgZ(25,"td",75)(26,"span",89),e._uU(27),e.qZA()(),e.TgZ(28,"td",75),e._UZ(29,"i",90),e.qZA(),e.TgZ(30,"td",75)(31,"span",87),e._uU(32),e.qZA(),e.TgZ(33,"i",91),e.NdJ("click",function(){const r=e.CHM(t).$implicit,_=e.oxw(4);return e.KtG(_.copyToClipboard(r.client_provided_id,"Event"))}),e.qZA()()()}if(2&o){const t=d.$implicit,s=d.rowIndex,i=e.MAs(10),r=e.MAs(13),_=e.oxw(4);e.Q6J("ngClass",e.VKq(19,Ue,_.selectedRowIndex===s)),e.xp6(4),e.Q6J("ngIf",!t.driver_id||""==t.driver_id),e.xp6(1),e.Q6J("ngIf",t.driver_id&&""!==t.driver_id),e.xp6(1),e.Q6J("ngIf",t.driver_id&&""!==t.driver_id),e.xp6(2),e.Q6J("src",_.driver_id_photo_map[t.driver_id]||"assets/demo/images/settings/person_placeholder.svg",e.LSH)("alt",_.driver_id_name_map[t.driver_id])("pTooltip",i),e.xp6(3),e.Q6J("ngIf",t.driver_id)("ngIfElse",r),e.xp6(6),e.Q6J("ngIf",null==t.events_occured?null:t.events_occured[0]),e.xp6(3),e.hij(" ",t.timestamp?_.getTimetoDisplay(t.timestamp,!1).substring(0,16):"Timestamp: NA"," "),e.xp6(2),e.s9C("title",t.client_device_id),e.xp6(1),e.Oqu(t.client_device_id?"":"N/A"),e.xp6(1),e.Q6J("ngIf",t.client_device_id),e.xp6(3),e.hij(" ",null!=(null==t.videos||null==t.videos.driver?null:t.videos.driver.in_cabin_face_count)?t.videos.driver.in_cabin_face_count:"N/A"," "),e.xp6(2),e.s9C("title",_.getFilteredCoachingTypeName(t.videos)),e.Q6J("ngClass",_.getFilteredCoachingTypeClass(t.videos)),e.xp6(2),e.s9C("title",t.client_provided_id),e.xp6(1),e.Oqu(t.client_provided_id?"":"N/A")}}function He(o,d){1&o&&e.YNc(0,Ye,34,21,"ng-template",76)}function Le(o,d){if(1&o&&(e.ynx(0),e.TgZ(1,"p-table",72,73),e.YNc(3,Ze,16,0,"ng-template",74),e.YNc(4,He,1,0,null,25),e.qZA(),e.BQk()),2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("value",t.video_list)("autoLayout",!0),e.xp6(3),e.Q6J("ngIf",t.video_list)}}const qe=function(){return[8,12,20]};function Ge(o,d){if(1&o){const t=e.EpF();e.TgZ(0,"div",7)(1,"div",19)(2,"div",20)(3,"h5"),e._uU(4,"Events Detail"),e.qZA(),e.TgZ(5,"div",21)(6,"div",22)(7,"p-selectButton",23),e.NdJ("onChange",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.showTable=!i.showTable)})("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.defaultViewEvents=i)}),e.YNc(8,a,2,2,"ng-template",24),e.qZA()()()(),e.YNc(9,Se,4,1,"ng-container",25),e.YNc(10,Le,5,3,"ng-container",25),e.TgZ(11,"p-paginator",26),e.NdJ("onPageChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.onPageChange(i))}),e.qZA()()()}if(2&o){const t=e.oxw();e.xp6(7),e.Q6J("options",t.viewOptions)("ngModel",t.defaultViewEvents),e.xp6(2),e.Q6J("ngIf",t.showTable),e.xp6(1),e.Q6J("ngIf",!t.showTable),e.xp6(1),e.Q6J("showCurrentPageReport",!0)("rows",t.rows)("rowsPerPageOptions",e.DdM(8,qe))("totalRecords",t.totalRecords)}}function $e(o,d){if(1&o){const t=e.EpF();e.TgZ(0,"p-dialog",98),e.NdJ("visibleChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.eventsDetailDialog=i)})("onHide",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.eventsDetailDialog=!1)}),e.TgZ(1,"app-event-details",99),e.NdJ("updateDriverReviewDetails",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.loadDriverReviewDetails(i))}),e.qZA()()}if(2&o){const t=e.oxw();e.MGl("header","Event details with event id: ",t.selectedEvent.client_provided_id,""),e.Q6J("visible",t.eventsDetailDialog)("closable",!0)("maximizable",!0)("modal",!0),e.xp6(1),e.Q6J("selectedEventFromParent",t.selectedEvent)("orgSettings",t.orgSettings)("compoundEventNames",t.compoundEventNames)}}function Ve(o,d){if(1&o){const t=e.EpF();e.TgZ(0,"p-dialog",100),e.NdJ("visibleChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.editDriverDetailsDialog=i)})("onHide",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.editDriverDetailsDialog=!1)}),e.TgZ(1,"app-driver-enrolment",101),e.NdJ("updateDriverDetails",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.showUpdatedDriver(i))}),e.qZA()()}if(2&o){const t=e.oxw();e.Q6J("visible",t.editDriverDetailsDialog)("closable",!0)("maximizable",!0)("modal",!0),e.xp6(1),e.Q6J("driverDetails",t.selectedEvent.driver_id)}}const Ke=function(){return["2015","2020"]};let Be=(()=>{class o{eventService;messageService;route;utilsService;spinnerService;rolesService;driverAnalyticsService;fleetsService;settingsService;toolbarComponent;fromDate;toDate;selectedFleet;video_list=[];all_drivers_list=[];driver_id_name_map={};driver_id_photo_map={};options;eventsDetailDialog=!1;eventsSummary;fleetsSummary=[];selectedEvent;exportDialogVisible=!1;searchEventId;totalRecords=0;page=0;rows=8;paginationObj;mapIcons={TRUE_POS:"assets/demo/images/icons/correct-mark.png",TRUE_NEG:"assets/demo/images/icons/incorrect-mark.png",UNREVIEWED:"assets/demo/images/icons/question.png"};data;selected_self_fleet=[];videoLoaded={};showTable=!0;defaultView="chart";viewOptions=[{icon:"pi pi-chart-pie",justify:"Center",value:"chart"},{icon:"pi pi-table",justify:"Center",value:"table"}];defaultViewEvents="chart";snapshotSubs;eventSummarySubs;fleetsAggregateSubs;videosCount={adasCount:0,dmsCount:0,compoundEventsCount:0,telematicsCount:0};selectedCard;selectedSecondaryCard;editDriverDetailsDialog=!1;hasQueryParamFilter=!1;videoToggleOptions=[{icon:"pi pi-user",text:"Driver facing video",value:"dms"},{icon:"pi pi-pause",text:"Road facing video",value:"adas"}];allReviewStatuses=[{name:"Coachable",value:"COACHABLE"},{name:"Non Coachable",value:"NOTCOACHABLE"},{name:"Unreviewed",value:"UNREVIEWED"}];compoundEventNames=[];selectedRowIndex=null;allSelectedEvents=[];showSpinner=!0;forkJoinSubscription;orgSettings;constructor(t,s,i,r,_,p,f,C,g){this.eventService=t,this.messageService=s,this.route=i,this.utilsService=r,this.spinnerService=_,this.rolesService=p,this.driverAnalyticsService=f,this.fleetsService=C,this.settingsService=g}afterToolLoaded(){this.allSelectedEvents=this.toolbarComponent.selectedEvents,this.videosCount={adasCount:0,dmsCount:0,compoundEventsCount:0,telematicsCount:0},0===this.allSelectedEvents.length?this.eventService.getEvents().subscribe(t=>{this.allSelectedEvents=t,this.compoundEventNames=t.compound_events.map(i=>i.name);let s=this.toolbarComponent.selectedEvents.length?this.toolbarComponent.selectedEvents:this.utilsService.getEventNamesFromEventsArray(t);this.proceedAfterLoad(s,void 0,!0)}):(this.compoundEventNames=this.toolbarComponent.events.filter(t=>"compound"===t.label)[0].items.map(t=>t.value),this.proceedAfterLoad(this.allSelectedEvents))}proceedAfterLoad(t,s,i=!1){if(this.showSpinner=!1,this.route.snapshot.queryParams.event&&(t=this.toolbarComponent.selectedEvents),this.buildWaterfallChart(t,s,i),0==this.all_drivers_list.length){const p=[];this.video_list.forEach(C=>{p.push(C.driver_id)});const f={items_per_page:p.length,page_number:1};var _=b.dc();this.driverAnalyticsService.getAllDriversForFleets(_,p,f).subscribe(C=>{this.all_drivers_list=C.data,this.all_drivers_list.forEach(g=>{void 0!==g.name?(this.driver_id_name_map[g.id_]=g.name,this.driver_id_photo_map[g.id_]=g.images[0]):this.driver_id_name_map[g.id_]="NA"})})}this.page=0}showOnlyEventList=!1;showOnlyEventListMessage=[{severity:"info",summary:"info",detail:'Filtering based on "Device or Driver or Event ID or Face Count" disables some widgets'}];processVideosList(t){t.events_occured=[],t.videos.driver||(t.videos={driver:{url:"",cloud_video_path:"",duration:"",process_status:""},road_front:{url:"",cloud_video_path:"",duration:"",process_status:""},road_left:{url:"",cloud_video_path:"",duration:"",process_status:""}}),t.hasOwnProperty("client_label")&&t.client_label.length&&t.events_occured.push(...t.client_label),t.hasOwnProperty("et_label")&&t.et_label.length&&t.events_occured.push(...t.et_label),t.events_occured=[...new Set(t.events_occured)],"dms"==this.selectedCard?t.showAdas=!1:"adas"==this.selectedCard&&(t.showAdas=!0)}showCoachingSummary(t){"compound"===this.selectedCard?this.videosCount.compoundEventsCount=0:"adas"===this.selectedCard?this.videosCount.adasCount=0:"dms"===this.selectedCard?this.videosCount.dmsCount=0:"telematics"===this.selectedCard&&(this.videosCount.telematicsCount=0),this.calculateAdasAndDms(t.cumulative.total_events),this.fleetsSummary.total_reviewed_events=this.utilsService.getCountOfEvents(t.cumulative.reviewed_events),this.fleetsSummary.total_events=this.utilsService.getCountOfEvents(t.cumulative.total_events)}adasEvents=[];dmsEvents=[];telematicsEvents=[];totalReviewedEvents(t){return null!=t.correct?parseInt(t.correct)+parseInt(t.incorrect):0}categorizeAdasAndDmsEvents(){const t=this.toolbarComponent.events,s=this.toolbarComponent.selectedEvents;this.adasEvents=[],this.dmsEvents=[],this.telematicsEvents=[],t?.forEach(i=>{"adas"===i.label?i.items.forEach(r=>{s.indexOf(r.value)>-1&&this.adasEvents.push(r.value)}):"dms"===i.label?i.items.forEach(r=>{s.indexOf(r.value)>-1&&this.dmsEvents.push(r.value)}):"telematics"===i.label&&i.items.forEach(r=>{s.indexOf(r.value)>-1&&this.telematicsEvents.push(r.value)})})}calculateAdasAndDms(t){this.categorizeAdasAndDmsEvents();let i=[];this.toolbarComponent.allEvents.compound_events.forEach(r=>{i.push(r.name)}),this.videosCount.adasCount=this.selectedCard?"adas"===this.selectedCard?0:this.videosCount.adasCount:0,this.videosCount.dmsCount=this.selectedCard?"dms"===this.selectedCard?0:this.videosCount.dmsCount:0,this.videosCount.telematicsCount=this.selectedCard?"telematics"===this.selectedCard?0:this.videosCount.telematicsCount:0,this.videosCount.compoundEventsCount=this.selectedCard?"compound"===this.selectedCard?0:this.videosCount.compoundEventsCount:0,Object.keys(t).forEach(r=>{this.adasEvents.includes(r)&&(this.videosCount.adasCount=this.videosCount.adasCount+t[r][0]),this.dmsEvents.includes(r)&&(this.videosCount.dmsCount=this.videosCount.dmsCount+t[r][0]),this.telematicsEvents.includes(r)&&(this.videosCount.telematicsCount=this.videosCount.telematicsCount+t[r][0]),(i.includes(r)&&b.uZ[r]&&!this.selectedCard||"compound"===this.selectedCard)&&(this.videosCount.compoundEventsCount=this.videosCount.compoundEventsCount+t[r][0])})}buildWaterfallChart(t,s,i=!1){var r=b.Y5();const _=this.toolbarComponent.selectedFaceCount;this.searchEventId="",this.setPagination();let p=this.toolbarComponent.selectedDevices?.map(w=>w.id_),f=this.toolbarComponent.selectedDrivers?.map(w=>w.id_),C=this.toolbarComponent.filterEventId?[this.toolbarComponent.filterEventId]:[],g=this.toolbarComponent.selectedFaceCount;this.showOnlyEventList=!!(p?.length||f?.length||C?.length||g);const R=this.settingsService.getOrgSettings();let D=this.fleetsService.getFleetsAggregation(this.toolbarComponent.fromDateUTC,this.toolbarComponent.toDateUTC,r.filter_fleet_ids,t,_),A=this.eventService.getEventsSummary(this.toolbarComponent.fromDateUTC,this.toolbarComponent.toDateUTC,r.filter_fleet_ids,t),P=this.eventService.getAllEventsForFleetsPost(this.toolbarComponent.fromDateUTC,this.toolbarComponent.toDateUTC,r.filter_fleet_ids.split(","),this.paginationObj,i?void 0:t,s,_,p,f,C);this.forkJoinSubscription=(0,oe.D)([D,A,P,R]).subscribe(([w,j,h,I])=>{this.orgSettings=I,this.drawWaterfallChart(t,w),w&&w.cumulative&&this.showCoachingSummary(w),this.eventsSummary=j,this.video_list=h.data,this.totalRecords=h.total_items,this.video_list.forEach(y=>{this.processVideosList(y)}),this.hasQueryParamFilter||this.checkIfQueryParamsHasFilter(t)})}drawWaterfallChart(t,s){let i=[],r=[0],_=["Previous Period"];if(t.length){t.forEach(h=>{const y=this.utilsService.getEventDefaultLabelMapping(this.toolbarComponent?.allEvents)[h],ue=y.length>20?y.substring(0,20)+"...":y;_.includes(ue)||(i.push(0),r.push(0),_.push(ue))});let p={};p.prev_cumulative=this.utilsService.getCountsOfIndividualEvents(s.prev_cumulative?.total_events),p.cumulative=this.utilsService.getCountsOfIndividualEvents(s.cumulative?.total_events);let f=0,C=0;t.forEach(h=>{f+=p.prev_cumulative[h]?p.prev_cumulative[h]:0,C+=p.cumulative[h]?p.cumulative[h]:0}),i.unshift(f),r.push(C);let g=[0],R=[0],D=[0],A=f;t.forEach(h=>{let I=p.prev_cumulative[h]?p.prev_cumulative[h]:0,y=p.cumulative[h]?p.cumulative[h]:0;I<p.cumulative[h]?(g.push(y-I),R.push(0),D.push(A),A=A+y-I):(g.push(0),R.push(I-y),A-=I-y,D.push(A))}),g.push(0),R.push(0),D.push(0);const P=getComputedStyle(document.documentElement),w=P.getPropertyValue("--text-color"),j=P.getPropertyValue("--surface-border");_.push("Current Period"),this.data={labels:_,datasets:[{type:"bar",label:"",backgroundColor:P.getPropertyValue("background-color"),data:D},{type:"bar",label:"Previous Period",backgroundColor:b.mH[5],data:i},{type:"bar",label:"Less Than Previous Period",backgroundColor:b.mH[1],data:R},{type:"bar",label:"More Than Previous Period",backgroundColor:b.mH[3],data:g},{type:"bar",label:"Current Period",backgroundColor:b.mH[9],data:r}]},this.options={maintainAspectRatio:!1,aspectRatio:.6,plugins:{tooltip:{enabled:!0,usePointStyle:!0,filter:function(h,I){return 0!=h.datasetIndex},titleAlign:"center",titleColor:"gold",titleSpacing:3,TitleFont:{weight:"bold"},backgroundColor:"midnightblue",bodyColor:"orange",bodyAlign:"center",bodyFont:{weight:"italic"},onlyShowForDatasetIndex:[1],callbacks:{labelPointStyle:function(h){return{pointStyle:"circle",rotation:0}}}},legend:{labels:{color:w}}},scales:{x:{stacked:!0,ticks:{color:"#000"},grid:{color:j,drawBorder:!1}},y:{stacked:!0,ticks:{color:"#000"},grid:{color:j,drawBorder:!1}}}}}}checkIfQueryParamsHasFilter(t){"adas"!==this.route.snapshot.queryParams.filter||this.hasQueryParamFilter?"dms"!==this.route.snapshot.queryParams.filter||this.hasQueryParamFilter?"compound"!==this.route.snapshot.queryParams.filter||this.hasQueryParamFilter?"reviewed"===this.route.snapshot.queryParams.filter&&!this.hasQueryParamFilter&&(this.hasQueryParamFilter=!0,this.getFilteredEvents(void 0,"reviewed",!1)):(this.hasQueryParamFilter=!0,this.categorizeAdasAndDmsEvents(),t=this.getCurrentFilteredEvents("compound",!0),this.buildWaterfallChart(t)):(this.hasQueryParamFilter=!0,this.categorizeAdasAndDmsEvents(),t=this.getCurrentFilteredEvents("dms",!0),this.buildWaterfallChart(t)):(this.hasQueryParamFilter=!0,this.categorizeAdasAndDmsEvents(),t=this.getCurrentFilteredEvents("adas",!0),this.buildWaterfallChart(t))}getEventsForFleets(t,s){this.snapshotSubs&&this.snapshotSubs.unsubscribe(),this.searchEventId="";var i=b.dc();this.setPagination();const r=this.toolbarComponent.selectedFaceCount;let _=this.toolbarComponent.selectedDevices?.map(g=>g.id_),p=this.toolbarComponent.selectedDrivers?.map(g=>g.id_),f=this.toolbarComponent.filterEventId?[this.toolbarComponent.filterEventId]:[],C=this.toolbarComponent.selectedFaceCount;this.showOnlyEventList=!!(_?.length||p?.length||f.length||C),this.snapshotSubs=this.eventService.getAllEventsForFleetsPost(this.toolbarComponent.fromDateUTC,this.toolbarComponent.toDateUTC,i,this.paginationObj,t,s,r,_,p,f).subscribe(g=>{this.video_list=g.data,this.totalRecords=g.total_items,this.video_list.forEach(R=>{this.processVideosList(R)}),this.snapshotSubs&&this.snapshotSubs.unsubscribe()})}goToDriverDetail(t){let i=this.toolbarComponent.devicesList.find(r=>r.id_===t.device_id);t.plate_number=i?.plate_number,this.selectedEvent=t,this.eventsDetailDialog=!0}editDriverDetails(t){this.selectedEvent=t,this.editDriverDetailsDialog=!0}showUpdatedDriver(t){this.selectedEvent.driver_id in this.driver_id_name_map&&(this.driver_id_name_map[this.selectedEvent.driver_id]=t.name)}goToDriverAnalytics(t){let s=location.origin+"/#/driver-analytics?driverId="+t.driver_id;window.open(s,"_blank")}goToSmartEnroll(t){let s=location.origin+"/#/smart-enroll?eventId="+t.client_provided_id;window.open(s,"_blank")}selectRow(t){this.selectedRowIndex=t}loadDriverReviewDetails(t){null!=t.oldReview&&null!=t.newReview&&t.oldReview!=t.newReview&&("TRUE_POS"==t.oldReview?"TRUE_NEG"==t.newReview?(this.eventsSummary.correct-=1,this.eventsSummary.incorrect+=1):"UNREVIEWED"==t.newReview&&(this.eventsSummary.correct-=1):"TRUE_NEG"==t.oldReview?"TRUE_POS"==t.newReview?(this.eventsSummary.incorrect-=1,this.eventsSummary.correct+=1):"UNREVIEWED"==t.newReview&&(this.eventsSummary.incorrect-=1):"UNREVIEWED"==t.oldReview&&("TRUE_POS"==t.newReview?this.eventsSummary.correct+=1:"TRUE_NEG"==t.newReview&&(this.eventsSummary.incorrect+=1)),this.eventsSummary.reviewed=this.eventsSummary.correct+this.eventsSummary.incorrect)}filterData(){this.afterToolLoaded()}showExportDialog(){this.exportDialogVisible=!0}onInputSearch(t){t?(t=this.video_list.filter(s=>s.client_provided_id==t)[0].id_,this.eventService.getEventById(t).subscribe(s=>{this.video_list=[s],this.video_list.forEach(i=>{this.processVideosList(i)})})):this.getEventsForFleets(this.toolbarComponent.selectedEvents)}onVideoLoaded(t){this.videoLoaded[t]=!0}copyToClipboard(t,s){const i=document.createElement("textarea");i.value=t,document.body.appendChild(i),i.select(),document.execCommand("copy"),document.body.removeChild(i),this.messageService.add({severity:"success",summary:"Successful",detail:s+" id copied to clipboard successfully",life:3e3})}getProcessedEvents(t){let s={};for(let i in t)s[i]=s[i]?s[i]+this.sumArray(t[i]):this.sumArray(t[i])}getFilteredEvents(t,s,i){this.proceedAfterLoad(this.getCurrentFilteredEvents(t,i),this.getCurrentFilteredCoachingData(s,i))}getCurrentFilteredEvents(t,s){if(t===this.selectedCard&&s)return this.selectedCard="",this.videosCount={adasCount:0,dmsCount:0,compoundEventsCount:0,telematicsCount:0},this.toolbarComponent.selectedEvents;if("adas"===t)return this.selectedCard="adas",this.adasEvents;if("dms"===t)return this.selectedCard="dms",this.dmsEvents;if("telematics"===t)return this.selectedCard="telematics",this.telematicsEvents;if("compound"===t){this.selectedCard="compound";let i=[],r=[];return this.toolbarComponent.allEvents.compound_events&&this.toolbarComponent.allEvents.compound_events.forEach(p=>{b.uZ[p.name]&&i.push(p.name)}),this.toolbarComponent.selectedEvents.forEach(p=>{i.indexOf(p)>-1&&b.uZ[p]&&r.push(p)}),r}return this.toolbarComponent.selectedEvents}getCurrentFilteredCoachingData(t,s){let i={};return t!==this.selectedSecondaryCard||s?"reviewed"===t?(this.selectedSecondaryCard="reviewed",i.review=["CORRECT","INCORRECT"]):"incorrect"===t?(this.selectedSecondaryCard="incorrect",i.review=["INCORRECT"]):"correct"===t&&(this.selectedSecondaryCard="correct",i.review=["CORRECT"]):(this.selectedSecondaryCard="",i=void 0),i}sumArray(t){return t.reduce((s,i)=>s+i,0)}onToggleVideoType(t,s){s.showAdas="adas"===t.value;const i=this.video_list.findIndex(r=>r.id_===s.id_);this.video_list[i]=s}getFilteredCoachingTypeName(t){return t.driver?.review?this.utilsService.formatLabelForCharts(t.driver?.review):t.road_front?.review?this.utilsService.formatLabelForCharts(t.road_front?.review):"N/A"}getFilteredCoachingTypeClass(t){return t.driver?.review?this.getIconName(t.driver.review):t.road_front?.review?this.getIconName(t.road_front.review):void 0}getIconName(t){return"REVIEWED"===t||"CORRECT"===t?"pi-check-circle text-green":"UNREVIEWED"===t?"pi-question-circle text-black-700":"pi-times-circle text-red-700 "}getTimetoDisplay(t,s){return this.utilsService.convertToTimezone(t,this.orgSettings.timezone)}setPagination(){this.paginationObj={sort_order:"desc",items_per_page:this.rows,page_number:this.page+1,sort_field:"timestamp"}}onPageChange(t){this.page=t.page,this.rows=t.rows,this.spinnerService.showSpinner(),this.setPagination(),this.getFilteredEvents(this.selectedCard,this.selectedSecondaryCard,!1)}ngOnDestroy(){this.forkJoinSubscription&&this.forkJoinSubscription.unsubscribe()}static \u0275fac=function(s){return new(s||o)(e.Y36(S.nC),e.Y36(O.ez),e.Y36(F.gz),e.Y36(S.FW),e.Y36(S.V),e.Y36(S.Nj),e.Y36(S.NZ),e.Y36(S.VN),e.Y36(S.gb))};static \u0275cmp=e.Xpm({type:o,selectors:[["app-event-report"]],viewQuery:function(s,i){if(1&s&&e.Gf(B.n,5),2&s){let r;e.iGM(r=e.CRH())&&(i.toolbarComponent=r.first)}},features:[e._Bn([O.ez])],decls:10,vars:13,consts:[["styleClass","w-5rem h-5rem",4,"ngIf"],[3,"showEvents","showFaceCount","showDevices","showDrivers","showEventId","export","filterData","loaded"],[1,"grid","mt-2"],["class","col-12",4,"ngIf"],["styleClass","mx-3 sm:mx-0 sm:w-full md:w-11 h-screen","contentStyleClass","border-round-bottom border-top-1 surface-border p-0",3,"visible","closable","maximizable","header","modal","visibleChange","onHide",4,"ngIf"],["header","Edit driver details","styleClass","mx-3 sm:mx-0 sm:w-full md:w-9 lg:w-8","contentStyleClass","border-round-bottom border-top-1 surface-border p-0",3,"visible","closable","maximizable","modal","visibleChange","onHide",4,"ngIf"],["styleClass","w-5rem h-5rem"],[1,"col-12"],[1,"card","h-full"],[3,"value","enableService","closable","valueChange"],["class","grid",4,"ngIf"],[1,"grid"],[1,"border-right-1","pr-2"],[1,"ml-2","cursor-pointer","inline-block",3,"ngClass"],[3,"metricsName","metricsNumber","click"],[1,"ml-2"],[3,"metricsName","metricsNumber"],[1,"text-900","text-xl","font-semibold","mb-3"],["type","bar",3,"data","options","height"],[1,"card"],[1,"flex","flex-column","md:flex-row","md:justify-content-between","gap-4","my-3"],[1,"flex"],[1,"inline-block","mr-4","vertical-align-middle"],["optionLabel","label","optionValue","value",3,"options","ngModel","onChange","ngModelChange"],["pTemplate","item"],[4,"ngIf"],["currentPageReportTemplate","Total Snapshots: {totalRecords}",3,"showCurrentPageReport","rows","rowsPerPageOptions","totalRecords","onPageChange"],[1,"pi",3,"ngClass"],["layout","grid",3,"value"],["dv",""],["pTemplate","gridItem"],["id","gallery",1,"col-12","md:col-3"],[1,"card","shadow-2","m-3","border-1","surface-border"],[1,"flex","flex-column","align-items-center"],["class","video-container",4,"ngIf"],[1,"description","w-full","cursor-pointer","p-3"],[1,"grid","align-items-center"],[1,"col-12","md:col-8"],["class","inline-block text-left my-2",4,"ngIf"],[1,"col-12","md:col-4","text-right"],[1,"vertical-align-middle"],[3,"options","onChange"],["pTemplate",""],[1,"col-12","md:col-7"],[4,"ngIf","ngIfElse"],["unenrolled",""],["na",""],[1,"col-12","md:col-5","text-right"],["icon","pi pi-plus","title","Enroll Driver","styleClass","w-2rem h-2rem",3,"click",4,"ngIf"],["icon","pi pi-pencil","title","Edit driver details","styleClass","w-2rem h-2rem",3,"click",4,"ngIf"],["icon","pi pi-chart-bar","title","Go to driver analytics","styleClass","w-2rem h-2rem ml-1",3,"click",4,"ngIf"],["icon","pi pi-arrow-up-right","styleClass","w-2rem h-2rem ml-1","title","Show event details",3,"click"],[1,"col-12","md:col-6"],[1,"w-5rem","inline-block"],[3,"title"],[1,"pi","pi-copy","cursor-pointer","ml-1",3,"title","click"],[1,"col-12","md:col-6","md:text-right"],[1,"inline-block"],[1,"video-container"],[1,"video-wrapper"],[1,"video-backdrop",3,"id"],["controls","",3,"id","src","muted","loadeddata",4,"ngIf"],["controls","",3,"id","src","muted","loadeddata"],[1,"inline-block","text-left","my-2"],[4,"ngFor","ngForOf"],["class","vertical-align-middle events-icon text-center",3,"title","src",4,"ngIf"],[1,"vertical-align-middle","events-icon","text-center",3,"title","src"],[1,"mb-0","inline-block"],[1,"text-gray-600"],["icon","pi pi-plus","title","Enroll Driver","styleClass","w-2rem h-2rem",3,"click"],["icon","pi pi-pencil","title","Edit driver details","styleClass","w-2rem h-2rem",3,"click"],["icon","pi pi-chart-bar","title","Go to driver analytics","styleClass","w-2rem h-2rem ml-1",3,"click"],["responsiveLayout","scroll",3,"value","autoLayout"],["dt",""],["pTemplate","header"],[1,"text-center"],["pTemplate","body"],[3,"ngClass","click"],[1,"flex","align-items-center"],["icon","pi pi-arrow-up-right","styleClass","w-2rem h-2rem ml-1 text-xl","title","Show event details",3,"click"],["icon","pi pi-plus ml-1 ","title","Enroll Driver","styleClass","w-2rem h-2rem ml-1 ",3,"click",4,"ngIf"],["icon","pi pi-pencil","title","Edit driver details","styleClass","w-2rem h-2rem ml-1  text-2xl",3,"click",4,"ngIf"],["icon","pi pi-chart-bar","title","Go to driver analytics","styleClass","w-2rem h-2rem ml-1  text-xl",3,"click",4,"ngIf"],[1,"text-left"],[1,"md:my-0","w-9","md:w-4rem","shadow-2","w-2rem","mt-2","mr-2","driver-list-img",3,"src","alt","pTooltip"],["enlargeImage",""],["class","my-2",4,"ngIf"],[1,"text-900","font-normal",3,"title"],["class","pi pi-copy cursor-pointer ml-1",3,"click",4,"ngIf"],["title","Face Count",1,"text-900","font-normal"],[1,"pi","text-xl",3,"ngClass","title"],[1,"pi","pi-copy","cursor-pointer","ml-1",3,"click"],["icon","pi pi-plus ml-1 ","title","Enroll Driver","styleClass","w-2rem h-2rem ml-1 ",3,"click"],["icon","pi pi-pencil","title","Edit driver details","styleClass","w-2rem h-2rem ml-1  text-2xl",3,"click"],["icon","pi pi-chart-bar","title","Go to driver analytics","styleClass","w-2rem h-2rem ml-1  text-xl",3,"click"],[1,"block","m-w-25rem"],[1,"m-w-25rem",3,"src","alt"],[1,"my-2"],["styleClass","mx-3 sm:mx-0 sm:w-full md:w-11 h-screen","contentStyleClass","border-round-bottom border-top-1 surface-border p-0",3,"visible","closable","maximizable","header","modal","visibleChange","onHide"],[3,"selectedEventFromParent","orgSettings","compoundEventNames","updateDriverReviewDetails"],["header","Edit driver details","styleClass","mx-3 sm:mx-0 sm:w-full md:w-9 lg:w-8","contentStyleClass","border-round-bottom border-top-1 surface-border p-0",3,"visible","closable","maximizable","modal","visibleChange","onHide"],[3,"driverDetails","updateDriverDetails"]],template:function(s,i){1&s&&(e._UZ(0,"p-toast"),e.YNc(1,ce,1,0,"p-progressSpinner",0),e.TgZ(2,"app-toolbar",1),e.NdJ("export",function(){return i.showExportDialog()})("filterData",function(){return i.filterData()})("loaded",function(){return i.afterToolLoaded()}),e.qZA(),e.TgZ(3,"div",2),e.YNc(4,de,3,3,"div",3),e.YNc(5,pe,2,1,"div",3),e.YNc(6,me,5,3,"div",3),e.YNc(7,Ge,12,9,"div",3),e.qZA(),e.YNc(8,$e,2,8,"p-dialog",4),e.YNc(9,Ve,2,5,"p-dialog",5)),2&s&&(e.xp6(1),e.Q6J("ngIf",i.showSpinner),e.xp6(1),e.Q6J("showEvents",!0)("showFaceCount",!0)("showDevices",!0)("showDrivers",!0)("showEventId",!0),e.xp6(2),e.Q6J("ngIf",i.showOnlyEventList),e.xp6(1),e.Q6J("ngIf",!i.showOnlyEventList),e.xp6(1),e.Q6J("ngIf",i.rolesService.hasAccess("2010")&&!i.showOnlyEventList),e.xp6(1),e.Q6J("ngIf",i.rolesService.hasAccess(e.DdM(12,Ke))),e.xp6(1),e.Q6J("ngIf",i.eventsDetailDialog),e.xp6(1),e.Q6J("ngIf",i.editDriverDetailsDialog))},dependencies:[x.mk,x.sg,x.O5,J.C,B.n,se.E,re.c,ae.q,M.VO,O.jx,n.zx,T.JJ,T.On,W.iA,Q.V,$.FN,q.G,k.D,G.UN,le.Z,V.u,K.V],styles:["h4[_ngcontent-%COMP%]{display:inline-block;float:left}#gallery[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{padding:0!important}.description[_ngcontent-%COMP%]{box-shadow:0 3px 6px #00000029;min-height:200px}.video-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.video-container[_ngcontent-%COMP%]   video[_ngcontent-%COMP%]{width:100%;height:240px;vertical-align:middle}.video-container[_ngcontent-%COMP%]{height:100%;width:100%;min-height:220px;background-image:url(video-placeholder.c569469c678aa08a.png);background-size:cover;background-position:center;background:black}.video-wrapper[_ngcontent-%COMP%]{position:relative;display:inline-block;width:100%}.video-backdrop[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;background-color:#00000040;z-index:-1}.png-icon[_ngcontent-%COMP%]{display:block;margin-left:3%;margin-right:auto;height:24px;width:24px}.events-icon[_ngcontent-%COMP%]{width:34px}[_nghost-%COMP%]     app-big-metrics-card .card{min-width:120px}[_nghost-%COMP%]     app-small-metrics-card .card{min-width:140px}[_nghost-%COMP%]     .description .p-selectbutton .p-button{padding:5px}[_nghost-%COMP%]     .text-green:before{color:green}[_nghost-%COMP%]     .text-red:before{color:red}.selected-card[_ngcontent-%COMP%]{border-radius:15px;border:5px solid rgb(58,133,193)!important}.driver-list-img[_ngcontent-%COMP%]{width:3.5rem!important;border-radius:2em!important;margin-top:5px!important;margin-bottom:5px!important;vertical-align:middle}.pi.pi-copy[_ngcontent-%COMP%]{font-size:18px}.highlighted-row[_ngcontent-%COMP%]{background-color:#f0f8ff!important}[_nghost-%COMP%]  p-progressSpinner{position:absolute;top:50%;left:50%;z-index:10}"]})}return o})(),je=(()=>{class o{static \u0275fac=function(s){return new(s||o)};static \u0275mod=e.oAB({type:o});static \u0275inj=e.cJS({imports:[F.Bz.forChild([{path:"",component:Be,data:{breadcrumb:"Event Report",route:"event-report"}}]),F.Bz]})}return o})(),ze=(()=>{class o{static \u0275fac=function(s){return new(s||o)};static \u0275mod=e.oAB({type:o});static \u0275inj=e.cJS({imports:[x.ez,J.S,je,ne.l,ie.m,ee.m,M.FI,Y.kW,H.j,n.hJ,z.cc,T.u5,L.A,W.U$,Q.S,$.EV,q.L,k.U,X.W,G.Qy,te.DriverAnalyticsModule,V.z,K.$]})}return o})()},1037:(ve,U,c)=>{c.d(U,{V:()=>pe,$:()=>me});var x=c(6825),T=c(6814),n=c(5879),J=c(5219),M=c(2591),Q=c(2736),Y=c(3823),H=c(7778),L=c(8468),k=c(4480),q=c(5592),z=c(3225);const X=new(c(2631).v)(z.o);var $=c(671);function ee(a,v){if(1&a&&n._UZ(0,"span"),2&a){const l=n.oxw().$implicit;n.Tol("p-message-icon pi "+l.icon),n.uIk("data-pc-section","icon")}}function te(a,v){1&a&&n._UZ(0,"CheckIcon"),2&a&&n.uIk("data-pc-section","icon")}function ie(a,v){1&a&&n._UZ(0,"InfoCircleIcon"),2&a&&n.uIk("data-pc-section","icon")}function ne(a,v){1&a&&n._UZ(0,"TimesCircleIcon"),2&a&&n.uIk("data-pc-section","icon")}function F(a,v){1&a&&n._UZ(0,"ExclamationTriangleIcon"),2&a&&n.uIk("data-pc-section","icon")}function b(a,v){if(1&a&&(n.TgZ(0,"span",10),n.ynx(1),n.YNc(2,te,1,1,"CheckIcon",11),n.YNc(3,ie,1,1,"InfoCircleIcon",11),n.YNc(4,ne,1,1,"TimesCircleIcon",11),n.YNc(5,F,1,1,"ExclamationTriangleIcon",11),n.BQk(),n.qZA()),2&a){const l=n.oxw().$implicit;n.xp6(2),n.Q6J("ngIf","success"===l.severity),n.xp6(1),n.Q6J("ngIf","info"===l.severity),n.xp6(1),n.Q6J("ngIf","error"===l.severity),n.xp6(1),n.Q6J("ngIf","warn"===l.severity)}}function O(a,v){if(1&a&&n._UZ(0,"span",14),2&a){const l=n.oxw(2).$implicit;n.Q6J("innerHTML",l.summary,n.oJD),n.uIk("data-pc-section","summary")}}function oe(a,v){if(1&a&&n._UZ(0,"span",15),2&a){const l=n.oxw(2).$implicit;n.Q6J("innerHTML",l.detail,n.oJD),n.uIk("data-pc-section","detail")}}function B(a,v){if(1&a&&(n.ynx(0),n.YNc(1,O,1,2,"span",12),n.YNc(2,oe,1,2,"span",13),n.BQk()),2&a){const l=n.oxw().$implicit;n.xp6(1),n.Q6J("ngIf",l.summary),n.xp6(1),n.Q6J("ngIf",l.detail)}}function e(a,v){if(1&a&&(n.TgZ(0,"span",18),n._uU(1),n.qZA()),2&a){const l=n.oxw(2).$implicit;n.uIk("data-pc-section","summary"),n.xp6(1),n.Oqu(l.summary)}}function S(a,v){if(1&a&&(n.TgZ(0,"span",19),n._uU(1),n.qZA()),2&a){const l=n.oxw(2).$implicit;n.uIk("data-pc-section","detail"),n.xp6(1),n.Oqu(l.detail)}}function se(a,v){if(1&a&&(n.YNc(0,e,2,2,"span",16),n.YNc(1,S,2,2,"span",17)),2&a){const l=n.oxw().$implicit;n.Q6J("ngIf",l.summary),n.xp6(1),n.Q6J("ngIf",l.detail)}}function re(a,v){if(1&a){const l=n.EpF();n.TgZ(0,"button",20),n.NdJ("click",function(){n.CHM(l);const u=n.oxw().index,E=n.oxw(2);return n.KtG(E.removeMessage(u))}),n._UZ(1,"TimesIcon",21),n.qZA()}2&a&&(n.uIk("aria-label","Close")("data-pc-section","closebutton"),n.xp6(1),n.Q6J("styleClass","p-message-close-icon"),n.uIk("data-pc-section","closeicon"))}const ae=function(a,v){return{showTransitionParams:a,hideTransitionParams:v}},le=function(a){return{value:"visible",params:a}};function ce(a,v){if(1&a&&(n.TgZ(0,"div",4)(1,"div",5),n.YNc(2,ee,1,3,"span",6),n.YNc(3,b,6,4,"span",7),n.YNc(4,B,3,2,"ng-container",1),n.YNc(5,se,2,2,"ng-template",null,8,n.W1O),n.YNc(7,re,2,4,"button",9),n.qZA()()),2&a){const l=v.$implicit,m=n.MAs(6),u=n.oxw(2);n.Tol("p-message p-message-"+l.severity),n.Q6J("@messageAnimation",n.VKq(12,le,n.WLB(9,ae,u.showTransitionOptions,u.hideTransitionOptions))),n.xp6(1),n.uIk("data-pc-section","wrapper"),n.xp6(1),n.Q6J("ngIf",l.icon),n.xp6(1),n.Q6J("ngIf",!l.icon),n.xp6(1),n.Q6J("ngIf",!u.escape)("ngIfElse",m),n.xp6(3),n.Q6J("ngIf",u.closable)}}function de(a,v){if(1&a&&(n.ynx(0),n.YNc(1,ce,8,14,"div",3),n.BQk()),2&a){const l=n.oxw();n.xp6(1),n.Q6J("ngForOf",l.messages)}}function Z(a,v){1&a&&n.GkF(0)}function _e(a,v){if(1&a&&(n.TgZ(0,"div",22)(1,"div",5),n.YNc(2,Z,1,0,"ng-container",23),n.qZA()()),2&a){const l=n.oxw();n.Q6J("ngClass","p-message p-message-"+l.severity),n.xp6(2),n.Q6J("ngTemplateOutlet",l.contentTemplate)}}let pe=(()=>{class a{messageService;el;cd;set value(l){this.messages=l,this.startMessageLifes(this.messages)}closable=!0;style;styleClass;enableService=!0;key;escape=!0;severity;showTransitionOptions="300ms ease-out";hideTransitionOptions="200ms cubic-bezier(0.86, 0, 0.07, 1)";valueChange=new n.vpe;templates;messages;messageSubscription;clearSubscription;timerSubscriptions=[];contentTemplate;constructor(l,m,u){this.messageService=l,this.el=m,this.cd=u}ngAfterContentInit(){this.templates?.forEach(l=>{l.getType(),this.contentTemplate=l.template}),this.messageService&&this.enableService&&!this.contentTemplate&&(this.messageSubscription=this.messageService.messageObserver.subscribe(l=>{if(l){Array.isArray(l)||(l=[l]);const m=l.filter(u=>this.key===u.key);this.messages=this.messages?[...this.messages,...m]:[...m],this.startMessageLifes(m),this.cd.markForCheck()}}),this.clearSubscription=this.messageService.clearObserver.subscribe(l=>{l?this.key===l&&(this.messages=null):this.messages=null,this.cd.markForCheck()}))}hasMessages(){let l=this.el.nativeElement.parentElement;return!(!l||!l.offsetParent)&&(null!=this.contentTemplate||this.messages&&this.messages.length>0)}clear(){this.messages=[],this.valueChange.emit(this.messages)}removeMessage(l){this.messages=this.messages?.filter((m,u)=>u!==l),this.valueChange.emit(this.messages)}get icon(){const l=this.severity||(this.hasMessages()?this.messages[0].severity:null);if(this.hasMessages())switch(l){case"success":return"pi-check";case"info":default:return"pi-info-circle";case"error":return"pi-times";case"warn":return"pi-exclamation-triangle"}return null}ngOnDestroy(){this.messageSubscription&&this.messageSubscription.unsubscribe(),this.clearSubscription&&this.clearSubscription.unsubscribe(),this.timerSubscriptions?.forEach(l=>l.unsubscribe())}startMessageLifes(l){l?.forEach(m=>m.life&&this.startMessageLife(m))}startMessageLife(l){const m=function K(a=0,v,l=X){let m=-1;return null!=v&&((0,$.K)(v)?l=v:m=v),new q.y(u=>{let E=function V(a){return a instanceof Date&&!isNaN(a)}(a)?+a-l.now():a;E<0&&(E=0);let N=0;return l.schedule(function(){u.closed||(u.next(N++),0<=m?this.schedule(void 0,m):u.complete())},E)})}(l.life).subscribe(()=>{this.messages=this.messages?.filter(u=>u!==l),this.timerSubscriptions=this.timerSubscriptions?.filter(u=>u!==m),this.valueChange.emit(this.messages),this.cd.markForCheck()});this.timerSubscriptions.push(m)}static \u0275fac=function(m){return new(m||a)(n.Y36(J.ez,8),n.Y36(n.SBq),n.Y36(n.sBO))};static \u0275cmp=n.Xpm({type:a,selectors:[["p-messages"]],contentQueries:function(m,u,E){if(1&m&&n.Suo(E,J.jx,4),2&m){let N;n.iGM(N=n.CRH())&&(u.templates=N)}},hostAttrs:[1,"p-element"],inputs:{value:"value",closable:"closable",style:"style",styleClass:"styleClass",enableService:"enableService",key:"key",escape:"escape",severity:"severity",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions"},outputs:{valueChange:"valueChange"},decls:4,vars:8,consts:[["role","alert",1,"p-messages","p-component",3,"ngStyle"],[4,"ngIf","ngIfElse"],["staticMessage",""],["role","alert",3,"class",4,"ngFor","ngForOf"],["role","alert"],[1,"p-message-wrapper"],[3,"class",4,"ngIf"],["class","p-message-icon",4,"ngIf"],["escapeOut",""],["class","p-message-close p-link","type","button","pRipple","",3,"click",4,"ngIf"],[1,"p-message-icon"],[4,"ngIf"],["class","p-message-summary",3,"innerHTML",4,"ngIf"],["class","p-message-detail",3,"innerHTML",4,"ngIf"],[1,"p-message-summary",3,"innerHTML"],[1,"p-message-detail",3,"innerHTML"],["class","p-message-summary",4,"ngIf"],["class","p-message-detail",4,"ngIf"],[1,"p-message-summary"],[1,"p-message-detail"],["type","button","pRipple","",1,"p-message-close","p-link",3,"click"],[3,"styleClass"],["role","alert",3,"ngClass"],[4,"ngTemplateOutlet"]],template:function(m,u){if(1&m&&(n.TgZ(0,"div",0),n.YNc(1,de,2,1,"ng-container",1),n.YNc(2,_e,3,2,"ng-template",null,2,n.W1O),n.qZA()),2&m){const E=n.MAs(3);n.Tol(u.styleClass),n.Q6J("ngStyle",u.style),n.uIk("aria-atomic",!0)("aria-live","assertive")("data-pc-name","message"),n.xp6(1),n.Q6J("ngIf",!u.contentTemplate)("ngIfElse",E)}},dependencies:function(){return[T.mk,T.sg,T.O5,T.tP,T.PC,k.H,M.n,Y.u,L.x,Q.L,H.q]},styles:["@layer primeng{.p-message-wrapper{display:flex;align-items:center}.p-message-close{display:flex;align-items:center;justify-content:center;flex:none}.p-message-close.p-link{margin-left:auto;overflow:hidden;position:relative}.p-messages .p-message.ng-animating{overflow:hidden}}\n"],encapsulation:2,data:{animation:[(0,x.X$)("messageAnimation",[(0,x.eR)(":enter",[(0,x.oB)({opacity:0,transform:"translateY(-25%)"}),(0,x.jt)("{{showTransitionParams}}")]),(0,x.eR)(":leave",[(0,x.jt)("{{hideTransitionParams}}",(0,x.oB)({height:0,marginTop:0,marginBottom:0,marginLeft:0,marginRight:0,opacity:0}))])])]},changeDetection:0})}return a})(),me=(()=>{class a{static \u0275fac=function(m){return new(m||a)};static \u0275mod=n.oAB({type:a});static \u0275inj=n.cJS({imports:[T.ez,k.T,M.n,Y.u,L.x,Q.L,H.q]})}return a})()}}]);