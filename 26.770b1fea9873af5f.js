(self.webpackChunkedgetensor=self.webpackChunkedgetensor||[]).push([[26],{26:(ee,L,u)=>{"use strict";u.r(L),u.d(L,{AdminModule:()=>pn});var C=u(6814),c=u(6223),K=u(9025),F=u(707),B=u(6760),I=u(3904),x=u(3530),Y=u(2160),N=u(4819),_=u(9653),m=u(5609),b=u(3714),g=u(6218),h=u(1122),V=u(4055),$=u(8454),P=u(1230),M=u(7680),Q=u(1865),S=u(4480),v=u(9552),te=u(4844),de=u(315),G=u(4104),_e=u(6340),O=u(3259),ie=u(3745),ne=u(6081),e=u(5879),f=u(5219),me=u(5619);let z=(()=>{class i{refreshViewSubject=new me.X("");refreshView$=this.refreshViewSubject.asObservable();updateViews(t){this.refreshViewSubject.next(t)}static \u0275fac=function(s){return new(s||i)};static \u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var D=u(5878),E=u(2001);function ge(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"button",24),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.openNew())}),e.qZA()}}function fe(i,l){1&i&&(e.TgZ(0,"div",25),e._UZ(1,"p-progressSpinner"),e.qZA())}function he(i,l){1&i&&e._UZ(0,"th")}function ve(i,l){if(1&i&&(e.TgZ(0,"tr")(1,"th",26),e._uU(2,"Resource Name "),e.qZA(),e.TgZ(3,"th",27),e._uU(4," Fleets "),e.qZA(),e.TgZ(5,"th",28),e._uU(6," Creation Date "),e.qZA(),e.YNc(7,he,1,0,"th",23),e.qZA()),2&i){const t=e.oxw();e.xp6(7),e.Q6J("ngIf",t.allowEditRG)}}function be(i,l){if(1&i&&(e.TgZ(0,"div")(1,"span",33),e._uU(2," ... "),e.TgZ(3,"i"),e._uU(4,"Show more"),e.qZA()()()),2&i){const t=e.oxw().$implicit,s=e.oxw();e.xp6(1),e.Q6J("pTooltip",s.tooltipFleets(t)),e.uIk("aria-label","See more")}}function Ce(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"td")(1,"div",2)(2,"button",34),e.NdJ("click",function(){e.CHM(t);const n=e.oxw().$implicit,o=e.oxw();return e.KtG(o.editResourceGroup(n))}),e.qZA(),e.TgZ(3,"button",35),e.NdJ("click",function(){e.CHM(t);const n=e.oxw().$implicit,o=e.oxw();return e.KtG(o.deleteResourceGroup(n))}),e.qZA()()()}}function xe(i,l){if(1&i&&(e.TgZ(0,"tr")(1,"td",29)(2,"span",30),e._uU(3,"Resource Name"),e.qZA(),e._uU(4),e.qZA(),e.TgZ(5,"td",31)(6,"span",30),e._uU(7,"Fleets"),e.qZA(),e._UZ(8,"span",32),e.YNc(9,be,5,2,"div",23),e.qZA(),e.TgZ(10,"td",31)(11,"span",30),e._uU(12,"Creation Date"),e.qZA(),e._uU(13),e.qZA(),e.YNc(14,Ce,4,0,"td",23),e.qZA()),2&i){const t=l.$implicit,s=e.oxw();e.xp6(4),e.hij(" ",t.name," "),e.xp6(4),e.Q6J("innerHTML",s.displayFleets(t),e.oJD),e.xp6(1),e.Q6J("ngIf",s.hasMoreFleets(t)),e.xp6(4),e.hij(" ",s.utilsService.convertLongDatetoYYYMMDD(t.created_on)," "),e.xp6(1),e.Q6J("ngIf",s.allowEditRG)}}function Te(i,l){1&i&&(e.TgZ(0,"div")(1,"div",44),e._uU(2,"Resource group name is required."),e.qZA()())}function Ze(i,l){1&i&&(e.TgZ(0,"div",44),e._uU(1," Resource group name already exists. "),e.qZA())}function we(i,l){1&i&&(e.TgZ(0,"tr")(1,"th"),e._uU(2,"Parent Fleet "),e.qZA(),e.TgZ(3,"th"),e._uU(4,"Create "),e.qZA(),e.TgZ(5,"th"),e._uU(6,"Read "),e.qZA(),e.TgZ(7,"th"),e._uU(8,"Update "),e.qZA(),e.TgZ(9,"th"),e._uU(10,"Delete "),e.qZA(),e.TgZ(11,"th"),e._uU(12," Actions "),e.qZA()())}function De(i,l){1&i&&e._uU(0),2&i&&e.hij(" ",l.$implicit.name," ")}function Ae(i,l){if(1&i&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&i){const t=l.$implicit;e.ekj("disabled",t.disabled),e.xp6(1),e.Oqu(t.name)}}const H=function(){return{standalone:!0}};function Ue(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"tr")(1,"td",45)(2,"p-treeSelect",46),e.NdJ("ngModelChange",function(n){const r=e.CHM(t).$implicit;return e.KtG(r.object_id=n)})("onNodeSelect",function(){const n=e.CHM(t),o=n.$implicit,r=n.rowIndex,a=e.oxw(2);return e.KtG(a.isSelectable(o)&&a.onSelectionChange(o.object_id,r))}),e.YNc(3,De,1,1,"ng-template",47),e.YNc(4,Ae,2,3,"ng-template",48),e.qZA()(),e.TgZ(5,"td",49)(6,"p-inputSwitch",50),e.NdJ("ngModelChange",function(n){const r=e.CHM(t).$implicit;return e.KtG(r.write=n)})("ngModelChange",function(){const o=e.CHM(t).$implicit,r=e.oxw(2);return e.KtG(r.updateReadStatus(o))}),e.qZA()(),e.TgZ(7,"td",49)(8,"p-inputSwitch",50),e.NdJ("ngModelChange",function(n){const r=e.CHM(t).$implicit;return e.KtG(r.read=n)})("ngModelChange",function(){const o=e.CHM(t).$implicit,r=e.oxw(2);return e.KtG(r.updateReadStatus(o))}),e.qZA()(),e.TgZ(9,"td")(10,"p-inputSwitch",50),e.NdJ("ngModelChange",function(n){const r=e.CHM(t).$implicit;return e.KtG(r.update=n)})("ngModelChange",function(){const o=e.CHM(t).$implicit,r=e.oxw(2);return e.KtG(r.updateReadStatus(o))}),e.qZA()(),e.TgZ(11,"td")(12,"p-inputSwitch",50),e.NdJ("ngModelChange",function(n){const r=e.CHM(t).$implicit;return e.KtG(r.delete=n)})("ngModelChange",function(){const o=e.CHM(t).$implicit,r=e.oxw(2);return e.KtG(r.updateReadStatus(o))}),e.qZA()(),e.TgZ(13,"td")(14,"button",35),e.NdJ("click",function(){const o=e.CHM(t).$implicit,r=e.oxw(2);return e.KtG(r.removeFleetRow(o))}),e.qZA()()()}if(2&i){const t=l.$implicit,s=e.oxw(2);e.xp6(2),e.Q6J("ngModel",t.object_id)("ngModelOptions",e.DdM(12,H))("options",s.fleetsTree)("filter",!0),e.xp6(4),e.Q6J("ngModel",t.write)("ngModelOptions",e.DdM(13,H)),e.xp6(2),e.Q6J("ngModel",t.read)("ngModelOptions",e.DdM(14,H)),e.xp6(2),e.Q6J("ngModel",t.update)("ngModelOptions",e.DdM(15,H)),e.xp6(2),e.Q6J("ngModel",t.delete)("ngModelOptions",e.DdM(16,H))}}function Fe(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"button",51),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.addNewRow())}),e.qZA()}}const Se=function(i){return{"ng-invalid ng-dirty":i}},oe=function(){return[10,20,30]};function Re(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"form")(1,"div",36)(2,"div",37)(3,"div",38)(4,"label",39),e._uU(5,"Resource group name"),e.qZA(),e.TgZ(6,"input",40),e.NdJ("ngModelChange",function(n){e.CHM(t);const o=e.oxw();return e.KtG(o.selectedResourceGroupName=n)})("ngModelChange",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.checkForDuplicates())}),e.qZA(),e.YNc(7,Te,3,0,"div",23),e.YNc(8,Ze,2,0,"div",41),e.qZA()(),e.TgZ(9,"div",37)(10,"p-table",42,43),e.YNc(12,we,13,0,"ng-template",15),e.YNc(13,Ue,15,17,"ng-template",16),e.YNc(14,Fe,1,0,"ng-template",19),e.qZA()()()()}if(2&i){const t=e.oxw();e.xp6(6),e.Q6J("ngModel",t.selectedResourceGroupName)("ngClass",e.VKq(11,Se,t.submitted&&!t.selectedResourceGroupName)),e.xp6(1),e.Q6J("ngIf",t.submitted&&!t.f.name.valid),e.xp6(1),e.Q6J("ngIf",t.nameExists),e.xp6(2),e.Q6J("value",t.createResource)("autoLayout",!0)("rows",20)("paginator",!0)("rowsPerPageOptions",e.DdM(13,oe))("showCurrentPageReport",!0)("rowHover",!0)}}function Ne(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"button",52),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.hideDialog())}),e.qZA(),e.TgZ(1,"button",53),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.saveResourceGroup())}),e.qZA()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("disabled",t.submitted||!t.selectedResourceGroupName||!t.isResourceListValid||t.nameExists)}}function ye(i,l){if(1&i&&(e.TgZ(0,"span"),e._uU(1,"Are you sure you want to delete "),e.TgZ(2,"b"),e._uU(3),e.qZA(),e._uU(4,"?"),e.qZA()),2&i){const t=e.oxw();e.xp6(3),e.Oqu(t.selectedResourceGroup.name)}}function Ie(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"button",54),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.deleteResourceGrpDialog=!1)}),e.qZA(),e.TgZ(1,"button",55),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.confirmDelete())}),e.qZA()}}function Me(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"button",54),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.deleteFleetRowDialog=!1)}),e.qZA(),e.TgZ(1,"button",55),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.confirmDeleteFleet())}),e.qZA()}}const qe=function(){return["name","readable_access_list"]},Ee=function(){return{width:"50%",minHeight:"500px",height:"70%"}},le=function(){return{width:"450px"}};let Je=(()=>{class i{messageService;fb;adminService;usersRolesService;utilsService;excelExportService;fleetsTree=[];updateResourceGroups=new e.vpe;isEdit=!1;userForm;resourceGroupDialog=!1;deleteResourceGrpDialog=!1;resources=[];createResource=[];selectedusers=[];selectedResourceGroup;selectedResourceGroupName="";submitted=!1;cols=[];statuses=[];rowsPerPageOptions=[5,10,20];deleteFleetRowDialog=!1;nameChangeSubscription;isResourceListValid=!1;nameExists=!1;showSpinner=!1;exportOptions;currentUserRoles=[];allowEditRG=!1;constructor(t,s,n,o,r,a){this.messageService=t,this.fb=s,this.adminService=n,this.usersRolesService=o,this.utilsService=r,this.excelExportService=a}ngOnInit(){this.getResourceAccessGroup(!1),this.currentUserRoles=JSON.parse(localStorage.getItem("user")||"{}")?.roles,(this.currentUserRoles.includes("ET_SUPER_ADMIN")||this.currentUserRoles.includes("CLIENT_SUPER_ADMIN"))&&(this.allowEditRG=!0),this.userForm=this.fb.group({id_:[""],name:["",[c.kI.required]],org_id:[JSON.parse(localStorage.getItem("user")||"{}").org_id,[c.kI.required]],direct_access_list:this.fb.group({access_level:[["WRITE","READ","Update","DELETE"]],write:[""],read:[""],update:[""],delete:[""],created_on:[""],id_:[""],name:[""],object_id:[""],org_id:[""],resource_name:["FLEETS"],effect:"ALLOW"})}),this.exportOptions=[{label:"Export to Excel",icon:"pi pi-file-excel",command:()=>{this.exportData("excel")}},{label:"Export to CSV",icon:"pi pi-file-excel",command:()=>{this.exportData("csv")}}]}get f(){return this.userForm.controls}getResourceAccessGroup(t){this.usersRolesService.getResourceGroupAccess().subscribe(s=>{this.resources=s;const n=sessionStorage.getItem("totalFleetData"),o=JSON.parse(n),r=new Map(o.map(a=>[a.id_,a.name]));this.resources.forEach(a=>{if(a.direct_access_list.length>0){const d=a.direct_access_list.filter(p=>"FLEETS"===p.resource_name).map(p=>r.get(p.object_id)||"").filter(p=>!!p);a.readable_access_list=[...new Set(d)].join(", ")}}),t&&this.updateResourceGroups.emit(this.resources)})}openNew(){this.isEdit=!1,this.submitted=!1,this.resourceGroupDialog=!0,this.enableSelectedOption(this.fleetsTree),this.createResource=[],this.selectedResourceGroupName="",this.addNewRow()}editResourceGroup(t){this.isEdit=!0,this.selectedResourceGroupName=t.name,this.displaydirectAccessList(t.direct_access_list),this.resourceGroupDialog=!0,this.userForm.patchValue(t),this.isResourceListValid=!0}deleteResourceGroup(t){this.selectedResourceGroup=t,this.deleteResourceGrpDialog=!0}confirmDelete(){this.usersRolesService.deleteResourceGroup(this.selectedResourceGroup).subscribe(()=>{this.deleteResourceGrpDialog=!1,this.messageService.add({severity:"success",summary:"Successful",detail:"user Deleted",life:3e3}),this.getResourceAccessGroup(!0),this.adminService.updateViews("resource-access")})}onResourceFilter(t,s){t.filterGlobal(s.target.value,"contains")}hideDialog(){this.resourceGroupDialog=!1,this.submitted=!1}saveResourceGroup(){if(this.userForm.value.name=this.selectedResourceGroupName,this.userForm.value.direct_access_list=[],this.processdirectAccessList(),0==this.userForm.value.direct_access_list.length)return void this.messageService.add({severity:"error",summary:"Error",detail:"Atleast one permission should be added",life:3e3});const t=new Set(this.userForm.value.direct_access_list.map(s=>s.object_id));if(this.hasDuplicates(t))this.messageService.add({severity:"error",summary:"Error",detail:"Duplicate fleets are not allowed",life:6e3});else if(this.userForm.value.direct_access_list.some(s=>!s.object_id))this.messageService.add({severity:"error",summary:"Error",detail:"Duplicate fleets are not allowed",life:6e3});else if(this.submitted=!0,this.showSpinner=!0,this.isEdit){let s=this.userForm.value;this.resourceGroupDialog=!1,this.usersRolesService.editResourceGroup(s).subscribe(n=>{this.getResourceAccessGroup(!0),this.messageService.add({severity:"success",summary:"Success",detail:"Resource Group Edited Successfully"}),this.submitted=!1,this.selectedResourceGroup={},this.showSpinner=!1})}else this.resourceGroupDialog=!1,this.usersRolesService.addResourceGroup(this.userForm.value).subscribe(s=>{this.getResourceAccessGroup(!0),this.messageService.add({severity:"success",summary:"Success",detail:"Resource Group Created Successfully"}),this.submitted=!1,this.selectedResourceGroup={},this.showSpinner=!1})}hasDuplicates(t){let s=[...t];return s.some((n,o)=>s.indexOf(n)!==o)}displaydirectAccessList(t){const s={};this.enableSelectedOption(this.fleetsTree),t.forEach(o=>{switch(s[o.object_id]||(s[o.object_id]={...o,read:!1,update:!1,delete:!1,create:!1}),o.access_level){case"READ":s[o.object_id].read=!0;break;case"UPDATE":s[o.object_id].update=!0;break;case"DELETE":s[o.object_id].delete=!0;break;case"WRITE":s[o.object_id].write=!0}this.disableSelectedOption(this.fleetsTree,o.object_id)});const n=Object.values(s);n.forEach((o,r)=>{o.object_id=this.utilsService.filterFleetRecursively(this.fleetsTree,o.object_id)}),this.createResource=n}processdirectAccessList(){const t=[];this.createResource.forEach(s=>{if(s.write){const n=this.getItemObject("WRITE",s);t.push(n)}if(s.read){const n=this.getItemObject("READ",s);t.push(n)}if(s.update){const n=this.getItemObject("UPDATE",s);t.push(n)}if(s.delete){const n=this.getItemObject("DELETE",s);t.push(n)}}),this.userForm.value.direct_access_list=t}getItemObject(t,s){return delete s[t.toLowerCase()],{access_level:t,object_id:s.object_id?.id_??s.object_id,org_id:JSON.parse(localStorage.getItem("user")||"{}").org_id,resource_name:"FLEETS"}}addNewRow(){this.selectedResourceGroup={},(!this.createResource||0===this.createResource.length)&&(this.createResource=[]),this.createResource.push({access_level:"",object_id:"",org_id:JSON.parse(localStorage.getItem("user")||"{}").org_id,resource_name:"FLEETS"}),this.isResourceListValid=!this.createResource.some(t=>!t.object_id)}selectedIds=[];onSelectionChange(t,s){t.disabled?this.createResource[s].object_id=null:(this.selectedIds.includes(t.id_)||this.selectedIds.push(t.id_),this.fleetsTree.forEach(n=>{n.id_===t.id_?n.disabled=!0:this.disableSelectedOption(n.children,t.id_)}),this.isResourceListValid=!this.createResource.some(n=>!n.object_id))}enableSelectedOption(t){t.forEach(s=>{s.disabled=!1,s.children&&this.enableChildren(s.children)})}disableSelectedOption(t,s){t.forEach(n=>{n.id_===s?n.disabled=!0:n.children&&this.disableSelectedOption(n.children,s)})}enableChildren(t){t.forEach(s=>{s.disabled=!1,s.children&&this.enableChildren(s.children)})}disableChildren(t){t.forEach(s=>{s.disabled=!0,s.children&&this.disableChildren(s.children)})}disableSelectedFleets(){this.createResource.forEach(t=>{this.disableSelectedOption(this.fleetsTree,t.object_id.id_??t.object_id)})}isSelectable(t){return!t.disabled}checkForDuplicates(){const t=this.resources.filter(s=>s.name?.toLowerCase()===this.selectedResourceGroupName?.toLowerCase());this.nameExists=t.length>0}updateReadStatus(t){(t.write||t.update||t.delete)&&(t.read=!0)}selectedFleetForDelete;removeFleetRow(t){1!=this.createResource.length?(this.deleteFleetRowDialog=!0,this.selectedFleetForDelete=t):this.messageService.add({severity:"error",summary:"Error",detail:"Resource Should Have atleast one fleet",life:3e3})}confirmDeleteFleet(){this.selectedFleetForDelete=this.selectedFleetForDelete,this.deleteFleetRowDialog=!1,this.createResource=this.createResource.filter(t=>t.object_id!==this.selectedFleetForDelete.object_id),this.disableSelectedFleets(),this.isResourceListValid=!this.createResource.some(t=>!t.object_id)}displayFleets(t){return t?.readable_access_list?.split(",").map(n=>n.trim())?.slice(0,3)}tooltipFleets(t){const s=t?.readable_access_list?.split(",").map(n=>n.trim());return s.length>3?s?.slice(3).join(", "):""}hasMoreFleets(t){return t?.readable_access_list?.split(",").length>3}exportData(t){const s=[];this.resources.forEach(o=>{s.push({Name:o.name,Fleets:o.readable_access_list?.replace(/,/g,",\n"),"Created On":this.utilsService.convertLongDatetoYYYMMDD(o.created_on)})});const n="Resource Group List - "+(new Date).toLocaleDateString();this.excelExportService.exportData(s,n,t)}static \u0275fac=function(s){return new(s||i)(e.Y36(f.ez),e.Y36(c.qu),e.Y36(z),e.Y36(D.Xb),e.Y36(D.FW),e.Y36(E.U0))};static \u0275cmp=e.Xpm({type:i,selectors:[["app-resource-access"]],inputs:{fleetsTree:"fleetsTree"},outputs:{updateResourceGroups:"updateResourceGroups"},features:[e._Bn([f.ez,f.YP])],decls:33,vars:32,consts:[[1,"flex","align-items-center","justify-content-between","mb-3","mt-2"],[1,"text-xl","font-bold","letter-spacing-01"],[1,"flex"],[1,"flex","flex-column","md:flex-row","md:justify-content-between","md:align-items-center"],[1,"block","mt-2","md:mt-0","p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Search resource access...",1,"w-full","sm:w-auto",3,"input"],["pButton","","pRipple","","label","Add Resource Group","class","ml-3",3,"click",4,"ngIf"],[3,"popup","model"],["menu",""],["pButton","","pRipple","","type","button","icon","pi pi-ellipsis-v",1,"p-button-rounded","p-button-text","p-button-secondary","p-trigger",3,"click"],[1,"relative"],["class","spinner-container",4,"ngIf"],["responsiveLayout","scroll","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries","selectionMode","multiple","dataKey","id",3,"value","columns","rows","globalFilterFields","paginator","rowsPerPageOptions","showCurrentPageReport","selection","rowHover","selectionChange"],["dtr",""],["pTemplate","header"],["pTemplate","body"],["header","Resource Group Details",1,"p-fluid",3,"visible","modal","visibleChange"],["pTemplate","content"],["pTemplate","footer"],["header","Confirm",3,"visible","modal","visibleChange"],[1,"flex","align-items-center","justify-content-center"],[1,"pi","pi-exclamation-triangle","mr-3",2,"font-size","2rem"],[4,"ngIf"],["pButton","","pRipple","","label","Add Resource Group",1,"ml-3",3,"click"],[1,"spinner-container"],["pSortableColumn","name",1,"text-left"],["pSortableColumn","readable_access_list",1,"text-left"],["pSortableColumn","created_on",1,"text-left"],[2,"width","20%","min-width","10rem"],[1,"p-column-title"],[2,"width","50%","min-width","15rem"],[3,"innerHTML"],["tooltipPosition","top",3,"pTooltip"],["pButton","","pRipple","","type","button","icon","pi pi-pencil",1,"p-button-rounded","p-button-text",3,"click"],["pButton","","pRipple","","type","button","icon","pi pi-trash",1,"p-button-rounded","p-button-text",3,"click"],[1,"grid"],[1,"col-12"],[1,"field"],["for","name"],["type","text","pInputText","","id","name","name","selectedResourceGroupName","autofocus","",3,"ngModel","ngClass","ngModelChange"],["class","ng-dirty ng-invalid text-red-700 mt-1",4,"ngIf"],["responsiveLayout","scroll","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries","dataKey","id_",3,"value","autoLayout","rows","paginator","rowsPerPageOptions","showCurrentPageReport","rowHover"],["dt",""],[1,"ng-dirty","ng-invalid","text-red-700","mt-1"],["pEditableColumn","",2,"min-width","20rem"],["placeholder","Select Fleet","appendTo","body",3,"ngModel","ngModelOptions","options","filter","ngModelChange","onNodeSelect"],["pTemplate","selectedItem"],["pTemplate","default"],["pEditableColumn",""],[1,"vertical-align-middle",3,"ngModel","ngModelOptions","ngModelChange"],["pButton","","pRipple","","label","Add new row",1,"mt-3","ml-3","w-15rem",3,"click"],["pButton","","pRipple","","label","Cancel",1,"p-button-text",3,"click"],["pButton","","pRipple","","label","Save",3,"disabled","click"],["pButton","","pRipple","","label","No",1,"p-button-text",3,"click"],["pButton","","pRipple","","label","Yes",3,"click"]],template:function(s,n){if(1&s){const o=e.EpF();e._UZ(0,"p-toast"),e.TgZ(1,"div",0)(2,"div",1),e._uU(3,"Resource Groups"),e.qZA(),e.TgZ(4,"div",2)(5,"div",3)(6,"span",4),e._UZ(7,"i",5),e.TgZ(8,"input",6),e.NdJ("input",function(a){e.CHM(o);const d=e.MAs(16);return e.KtG(n.onResourceFilter(d,a))}),e.qZA()()(),e.YNc(9,ge,1,0,"button",7),e._UZ(10,"p-menu",8,9),e.TgZ(12,"button",10),e.NdJ("click",function(a){e.CHM(o);const d=e.MAs(11);return e.KtG(d.toggle(a))}),e.qZA()()(),e.TgZ(13,"div",11),e.YNc(14,fe,2,0,"div",12),e.TgZ(15,"p-table",13,14),e.NdJ("selectionChange",function(a){return n.selectedusers=a}),e.YNc(17,ve,8,1,"ng-template",15),e.YNc(18,xe,15,5,"ng-template",16),e.qZA()(),e.TgZ(19,"p-dialog",17),e.NdJ("visibleChange",function(a){return n.resourceGroupDialog=a}),e.YNc(20,Re,15,14,"ng-template",18),e.YNc(21,Ne,2,1,"ng-template",19),e.qZA(),e.TgZ(22,"p-dialog",20),e.NdJ("visibleChange",function(a){return n.deleteResourceGrpDialog=a}),e.TgZ(23,"div",21),e._UZ(24,"i",22),e.YNc(25,ye,5,1,"span",23),e.qZA(),e.YNc(26,Ie,2,0,"ng-template",19),e.qZA(),e.TgZ(27,"p-dialog",20),e.NdJ("visibleChange",function(a){return n.deleteFleetRowDialog=a}),e.TgZ(28,"div",21),e._UZ(29,"i",22),e.TgZ(30,"span"),e._uU(31,"Are you sure you want to delete the fleet permission ?"),e.qZA()(),e.YNc(32,Me,2,0,"ng-template",19),e.qZA()}2&s&&(e.xp6(9),e.Q6J("ngIf",n.allowEditRG),e.xp6(1),e.Q6J("popup",!0)("model",n.exportOptions),e.xp6(4),e.Q6J("ngIf",n.showSpinner),e.xp6(1),e.Q6J("value",n.resources)("columns",n.cols)("rows",10)("globalFilterFields",e.DdM(27,qe))("rows",10)("paginator",!0)("rowsPerPageOptions",e.DdM(28,oe))("showCurrentPageReport",!0)("selection",n.selectedusers)("rowHover",!0),e.xp6(4),e.Akn(e.DdM(29,Ee)),e.Q6J("visible",n.resourceGroupDialog)("modal",!0),e.xp6(3),e.Akn(e.DdM(30,le)),e.Q6J("visible",n.deleteResourceGrpDialog)("modal",!0),e.xp6(3),e.Q6J("ngIf",n.selectedResourceGroup),e.xp6(2),e.Akn(e.DdM(31,le)),e.Q6J("visible",n.deleteFleetRowDialog)("modal",!0))},dependencies:[C.mk,C.O5,f.jx,O.u,v.iA,v.lQ,v.Wq,c._Y,c.Fj,c.JJ,c.JL,c.On,c.F,F.Hq,S.H,G.FN,b.o,x.V,ne.mP,M.G,m.Ql,h.v2],styles:[".disabled[_ngcontent-%COMP%]{cursor:not-allowed;color:#ccc}[_nghost-%COMP%]  p-progressSpinner{position:absolute;top:50%;left:50%;z-index:10}"]})}return i})();var Pe=u(1967),W=u(3173);function Ge(i,l){1&i&&e._uU(0),2&i&&e.hij(" ",l.$implicit.name," ")}function ke(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"div",12)(1,"div",13)(2,"div",14)(3,"div",15),e._uU(4,"Fleets"),e.qZA(),e.TgZ(5,"div",16)(6,"div",17),e._UZ(7,"span",18),e.qZA()()(),e.TgZ(8,"p-tree",19),e.NdJ("selectionChange",function(n){e.CHM(t);const o=e.oxw();return e.KtG(o.selectedFleet=n)})("onNodeSelect",function(n){e.CHM(t);const o=e.oxw();return e.KtG(o.onFleetSelect(n.node))}),e.YNc(9,Ge,1,1,"ng-template",20),e.qZA()()()}if(2&i){const t=e.oxw();e.xp6(8),e.Q6J("value",t.fleetsTree)("selection",t.selectedFleet)("filter",!0)("filterBy","name")}}function Ye(i,l){1&i&&(e.TgZ(0,"div",21),e._UZ(1,"p-progressSpinner",22),e.qZA())}function Qe(i,l){if(1&i&&(e.TgZ(0,"p-tabPanel",23),e._UZ(1,"app-fleet-configuration",24),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("fleets",t.fleets)("fleetsTree",t.fleetsTree)}}function Oe(i,l){if(1&i&&(e.TgZ(0,"p-tabPanel",25),e._UZ(1,"app-device-configuration",26),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("fleetsTree",t.fleetsTree)("fleets",t.fleets)("selectedDeviceFleet",t.selectedFleet)}}function He(i,l){1&i&&(e.TgZ(0,"p-tabPanel",27),e._UZ(1,"app-roles"),e.qZA())}function je(i,l){if(1&i&&(e.TgZ(0,"p-tabPanel",28),e._UZ(1,"app-users",29),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("fleetsTree",t.fleetsTree)("resourceGroups",t.resourceGroups)}}function Le(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"p-tabPanel",30)(1,"app-resource-access",31),e.NdJ("updateResourceGroups",function(n){e.CHM(t);const o=e.oxw();return e.KtG(o.updateResourceGroups(n))}),e.qZA()()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("fleetsTree",t.fleetsTree)}}const Ke=function(i){return{"md:col-9":i}};let y=(()=>{class i{utilsService;rolesService;router;route;usersRolesService;fleetsService;adminService;fleets;totalFleets;fleetsTree;expandedKeys;selectedFleet;selectedFleets;fleetLoaded=!1;deviceLoaded=!1;activeIndex=0;resourceGroups=[];constructor(t,s,n,o,r,a,d){this.utilsService=t,this.rolesService=s,this.router=n,this.route=o,this.usersRolesService=r,this.fleetsService=a,this.adminService=d}showFleetsList=!0;ngOnInit(){this.setActiveIndex(),this.getResourceGroupAccess(),this.fleetsService.getFleets().subscribe(t=>{this.fleets=t,this.totalFleets=t,this.fleetsTree=this.utilsService.convertFlatFleetsJsonToHierarchical(t);const s=this.fleets.filter(n=>n.id_===E.Y5().top_fleet_id);this.selectedFleet=s?.[0]||this.fleetsTree[0],this.expandedKeys=this.fleets.map(n=>n.name),this.fleetLoaded=!0,this.deviceLoaded=!0})}getResourceGroupAccess(){this.usersRolesService.getUIResourceGroupsMetadata().subscribe(t=>{this.resourceGroups=t})}convertFleetListToTreeData(t){let s=[];return t.forEach(n=>{let o=null;o=""==n.parentFleetId?null:n.parentFleetId,s.push({})}),s}onGlobalFilter(t,s){t.filterGlobal(s.target.value,"contains")}onFleetSelect(t){this.fleets=this.utilsService.filterFleets(this.totalFleets,t.id_),this.deviceLoaded=!1,this.selectedFleet=t,this.deviceLoaded=!0,this.adminService.updateViews("fleets")}setActiveIndex(){let t=this.route.snapshot.routeConfig?.path;"fleets"===t?this.activeIndex=0:"devices"===t?this.activeIndex=1:"roles"===t?this.activeIndex=2:"users"===t?this.activeIndex=this.rolesService.hasAccess("5025")?3:2:"resource-groups"===t&&(this.activeIndex=this.rolesService.hasAccess("5025")?4:3)}updateResourceGroups(t){this.resourceGroups=[],this.resourceGroups=t}static \u0275fac=function(s){return new(s||i)(e.Y36(D.FW),e.Y36(D.Nj),e.Y36(W.F0),e.Y36(W.gz),e.Y36(D.Xb),e.Y36(D.VN),e.Y36(z))};static \u0275cmp=e.Xpm({type:i,selectors:[["app-admin"]],features:[e._Bn([D.FW])],decls:12,vars:13,consts:[[3,"showEvents","showOnlyShare"],[1,"grid","mt-3"],["class","md:col-3 col-12",4,"ngIf"],[1,"col-12",3,"ngClass"],["class","spinner-div",4,"ngIf"],[1,"card","p-3","py-2"],[3,"activeIndex","activeIndexChange"],["header","Fleets",4,"ngIf"],["header","Devices",4,"ngIf"],["header","Roles",4,"ngIf"],["header","Users",4,"ngIf"],["header","Resource Groups",4,"ngIf"],[1,"md:col-3","col-12"],[1,"card","h-full"],[1,"flex","align-items-center","justify-content-between","mb-3"],[1,"text-xl","font-bold","letter-spacing-01"],[1,"flex"],[1,"flex","flex-column","md:flex-row","md:justify-content-between","md:align-items-center"],[1,"block","mt-2","md:mt-0","p-input-icon-left"],["selectionMode","single",3,"value","selection","filter","filterBy","selectionChange","onNodeSelect"],["pTemplate","default"],[1,"spinner-div"],["styleClass","w-5rem h-5rem"],["header","Fleets"],[3,"fleets","fleetsTree"],["header","Devices"],[3,"fleetsTree","fleets","selectedDeviceFleet"],["header","Roles"],["header","Users"],[3,"fleetsTree","resourceGroups"],["header","Resource Groups"],[3,"fleetsTree","updateResourceGroups"]],template:function(s,n){1&s&&(e._UZ(0,"app-toolbar",0),e.TgZ(1,"div",1),e.YNc(2,ke,10,4,"div",2),e.TgZ(3,"div",3),e.YNc(4,Ye,2,0,"div",4),e.TgZ(5,"div",5)(6,"p-tabView",6),e.NdJ("activeIndexChange",function(r){return n.activeIndex=r}),e.YNc(7,Qe,2,2,"p-tabPanel",7),e.YNc(8,Oe,2,3,"p-tabPanel",8),e.YNc(9,He,2,0,"p-tabPanel",9),e.YNc(10,je,2,2,"p-tabPanel",10),e.YNc(11,Le,2,1,"p-tabPanel",11),e.qZA()()()()),2&s&&(e.Q6J("showEvents",!1)("showOnlyShare",!0),e.xp6(2),e.Q6J("ngIf",n.showFleetsList&&(0==n.activeIndex||1==n.activeIndex)),e.xp6(1),e.Q6J("ngClass",e.VKq(11,Ke,0==n.activeIndex||1==n.activeIndex)),e.xp6(1),e.Q6J("ngIf",!n.fleetLoaded),e.xp6(2),e.Q6J("activeIndex",n.activeIndex),e.xp6(1),e.Q6J("ngIf",n.rolesService.hasAccess("5005")),e.xp6(1),e.Q6J("ngIf",n.rolesService.hasAccess("5010")),e.xp6(1),e.Q6J("ngIf",n.rolesService.hasAccess("5025")),e.xp6(1),e.Q6J("ngIf",n.rolesService.hasAccess("5020")&&n.resourceGroups.length>0),e.xp6(1),e.Q6J("ngIf",n.rolesService.hasAccess("5020")))},styles:[".spinner-div[_ngcontent-%COMP%]{position:absolute;width:-webkit-fill-available;height:-webkit-fill-available;z-index:1;align-content:center;text-align:center}"]})}return i})(),Be=(()=>{class i{static \u0275fac=function(s){return new(s||i)};static \u0275mod=e.oAB({type:i});static \u0275inj=e.cJS({imports:[W.Bz.forChild([{path:"fleets",component:y},{path:"devices",component:y},{path:"device-health",component:y},{path:"roles",component:y},{path:"users",component:y},{path:"resource-groups",component:y},{path:"",component:y}]),W.Bz]})}return i})();var re=u(217),X=u(1486);function Ve(i,l){1&i&&(e.TgZ(0,"tr")(1,"th",4),e._uU(2,"Fleet Name "),e.TgZ(3,"i",5),e._uU(4,"*"),e.qZA(),e._UZ(5,"p-sortIcon",6),e.qZA(),e.TgZ(6,"th",7),e._uU(7,"Parent Fleet Name "),e._UZ(8,"p-sortIcon",8),e.qZA(),e.TgZ(9,"th",9),e._uU(10,"Message "),e._UZ(11,"p-sortIcon",10),e.qZA()())}function $e(i,l){1&i&&(e.TgZ(0,"tr")(1,"th",11),e._uU(2,"Fleet Name "),e.TgZ(3,"i",5),e._uU(4,"*"),e.qZA(),e._UZ(5,"p-sortIcon",12),e.qZA(),e.TgZ(6,"th",13),e._uU(7," Client Device Id "),e.TgZ(8,"i",5),e._uU(9,"*"),e.qZA(),e._UZ(10,"p-sortIcon",14),e.qZA(),e.TgZ(11,"th",15),e._uU(12,"IMEI "),e.TgZ(13,"i",5),e._uU(14,"*"),e.qZA(),e._UZ(15,"p-sortIcon",16),e.qZA(),e.TgZ(16,"th",17),e._uU(17,"Driver Position "),e._UZ(18,"p-sortIcon",18),e.qZA(),e.TgZ(19,"th",9),e._uU(20,"Message "),e._UZ(21,"p-sortIcon",10),e.qZA()())}function ze(i,l){if(1&i&&(e.YNc(0,Ve,12,0,"tr",3),e.YNc(1,$e,22,0,"tr",3)),2&i){const t=e.oxw();e.Q6J("ngIf","fleet"===t.tableName),e.xp6(1),e.Q6J("ngIf","device"===t.tableName)}}function We(i,l){if(1&i&&(e.TgZ(0,"tr")(1,"td")(2,"span",20),e._uU(3,"Fleet Name"),e.qZA(),e._uU(4),e.qZA(),e.TgZ(5,"td")(6,"span",20),e._uU(7,"Parent Fleet Name"),e.qZA(),e._uU(8),e.qZA(),e.TgZ(9,"td")(10,"span",20),e._uU(11,"Message"),e.qZA(),e._uU(12),e.qZA()()),2&i){const t=l.$implicit;e.Tol(1!==t.status?"bg-red":""),e.xp6(4),e.hij(" ",t.name," "),e.xp6(4),e.hij(" ",t.parent_fleet_name," "),e.xp6(4),e.hij(" ",t.message," ")}}function Xe(i,l){1&i&&e.YNc(0,We,13,6,"ng-template",19)}function et(i,l){if(1&i&&(e.TgZ(0,"tr")(1,"td")(2,"span",20),e._uU(3,"Fleet Name"),e.qZA(),e._uU(4),e.qZA(),e.TgZ(5,"td")(6,"span",20),e._uU(7,"Client Device Id"),e.qZA(),e._uU(8),e.qZA(),e.TgZ(9,"td")(10,"span",20),e._uU(11,"IMEI"),e.qZA(),e._uU(12),e.qZA(),e.TgZ(13,"td")(14,"span",20),e._uU(15,"Driver Position"),e.qZA(),e._uU(16),e.qZA(),e.TgZ(17,"td")(18,"span",20),e._uU(19,"Message"),e.qZA(),e._uU(20),e.qZA()()),2&i){const t=l.$implicit;e.Tol(1!==t.status?"bg-red":""),e.xp6(4),e.hij(" ",t.fleet_name," "),e.xp6(4),e.hij(" ",t.client_provided_id," "),e.xp6(4),e.hij(" ",t.imei," "),e.xp6(4),e.hij(" ",t.driver_position," "),e.xp6(4),e.hij(" ",t.message," ")}}function tt(i,l){1&i&&e.YNc(0,et,21,8,"ng-template",19)}const it=function(i){return[i]},nt=function(){return[10,20,30]};let ae=(()=>{class i{tableName;uploadedData;globalFilterFields;cols=[];constructor(){}ngOnInit(){this.uploadedData.sort((t,s)=>t.status-s.status)}static \u0275fac=function(s){return new(s||i)};static \u0275cmp=e.Xpm({type:i,selectors:[["csv-table-component"]],inputs:{tableName:"tableName",uploadedData:"uploadedData",globalFilterFields:"globalFilterFields"},decls:5,vars:14,consts:[["responsiveLayout","scroll","dataKey","id","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","columns","autoLayout","rows","globalFilterFields","paginator","rowsPerPageOptions","showCurrentPageReport","rowHover"],["dts",""],["pTemplate","header"],[4,"ngIf"],["pSortableColumn","name"],[1,"mandatory"],["field","name"],["pSortableColumn","parent_fleet_name"],["field","parent_fleet_name"],["pSortableColumn","message"],["field","message"],["pSortableColumn","fleet_name"],["field","fleet_name"],["pSortableColumn","client_provided_id"],["field","client_provided_id"],["pSortableColumn","imei"],["field","imei"],["pSortableColumn","driver_position"],["field","driver_position"],["pTemplate","body"],[1,"p-column-title"]],template:function(s,n){1&s&&(e.TgZ(0,"p-table",0,1),e.YNc(2,ze,2,2,"ng-template",2),e.YNc(3,Xe,1,0,null,3),e.YNc(4,tt,1,0,null,3),e.qZA()),2&s&&(e.Q6J("value",n.uploadedData)("columns",n.cols)("autoLayout",!0)("rows",10)("globalFilterFields",e.VKq(11,it,n.globalFilterFields))("paginator",!0)("rowsPerPageOptions",e.DdM(13,nt))("showCurrentPageReport",!0)("rowHover",!0),e.xp6(3),e.Q6J("ngIf","fleet"===n.tableName),e.xp6(1),e.Q6J("ngIf","device"===n.tableName))},dependencies:[C.O5,f.jx,v.iA,v.lQ,v.fz],styles:["[_nghost-%COMP%]     .bg-red{background:#facbc0!important}[_nghost-%COMP%]     .mandatory{color:red;font-weight:700;font-size:larger}"]})}return i})();function st(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"button",28),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.openNew())}),e.qZA()}}function ot(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"button",29),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.openCsvUploader())}),e.qZA()}}function lt(i,l){1&i&&(e.TgZ(0,"th"),e._uU(1," Actions "),e.qZA())}function rt(i,l){if(1&i&&(e.TgZ(0,"tr")(1,"th",30),e._uU(2,"Device Id"),e._UZ(3,"p-sortIcon",31),e.qZA(),e.TgZ(4,"th",32),e._uU(5,"Fleet "),e._UZ(6,"p-sortIcon",33),e.qZA(),e.TgZ(7,"th",34),e._uU(8,"Plate No. "),e._UZ(9,"p-sortIcon",35),e.qZA(),e.TgZ(10,"th",36),e._uU(11,"IMEI "),e._UZ(12,"p-sortIcon",37),e.qZA(),e.TgZ(13,"th",38),e._uU(14,"Vehicle Type"),e._UZ(15,"p-sortIcon",39),e.qZA(),e.TgZ(16,"th"),e._uU(17,"Cam Angle "),e.qZA(),e.TgZ(18,"th",40),e._uU(19,"Calibration Type "),e._UZ(20,"p-sortIcon",41),e.qZA(),e.TgZ(21,"th",42),e._uU(22,"Channels "),e._UZ(23,"p-sortIcon",43),e.qZA(),e.TgZ(24,"th",44),e._uU(25,"Province "),e._UZ(26,"p-sortIcon",45),e.qZA(),e.TgZ(27,"th",46),e._uU(28,"City "),e._UZ(29,"p-sortIcon",47),e.qZA(),e.YNc(30,lt,2,0,"th",15),e.qZA()),2&i){const t=e.oxw();e.xp6(30),e.Q6J("ngIf",t.editDevceConfigList)}}function at(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"td")(1,"div",2)(2,"button",57),e.NdJ("click",function(){e.CHM(t);const n=e.oxw().$implicit,o=e.oxw(2);return e.KtG(o.editDevice(n))}),e.qZA(),e.TgZ(3,"button",58),e.NdJ("click",function(){e.CHM(t);const n=e.oxw().$implicit,o=e.oxw(2);return e.KtG(o.deviceCalbration(n))}),e.qZA()()()}}function ct(i,l){if(1&i&&(e.TgZ(0,"tr")(1,"td",49)(2,"span",50),e._uU(3,"Device Id"),e.qZA(),e._uU(4),e.qZA(),e.TgZ(5,"td",51)(6,"span",50),e._uU(7,"Fleet Name."),e.qZA(),e._uU(8),e.qZA(),e.TgZ(9,"td",51)(10,"span",50),e._uU(11,"Plate No."),e.qZA(),e._uU(12),e.qZA(),e.TgZ(13,"td",52)(14,"span",50),e._uU(15,"IMEI"),e.qZA(),e._uU(16),e.qZA(),e.TgZ(17,"td",52)(18,"span",50),e._uU(19,"Vehicle Type"),e.qZA(),e._uU(20),e.qZA(),e.TgZ(21,"td",53)(22,"span",50),e._uU(23,"Neutral Cam Angle"),e.qZA(),e._uU(24),e.qZA(),e.TgZ(25,"td",54)(26,"span",50),e._uU(27,"Calibration Type"),e.qZA(),e._uU(28),e.qZA(),e.TgZ(29,"td",54)(30,"span",50),e._uU(31,"Channels"),e.qZA(),e._uU(32),e.qZA(),e.TgZ(33,"td",55)(34,"span",50),e._uU(35,"Province"),e.qZA(),e._uU(36),e.qZA(),e.TgZ(37,"td",56)(38,"span",50),e._uU(39,"City"),e.qZA(),e._uU(40),e.qZA(),e.YNc(41,at,4,0,"td",15),e.qZA()),2&i){const t=l.$implicit,s=e.oxw(2);e.xp6(4),e.hij(" ",t.client_provided_id," "),e.xp6(4),e.hij(" ",t.fleet_name," "),e.xp6(4),e.hij(" ",t.plate_number," "),e.xp6(4),e.hij(" ",t.imei," "),e.xp6(4),e.hij(" ",t.type," "),e.xp6(4),e.lnq(" ",null==t.dms_neutral_camera_config?null:t.dms_neutral_camera_config.pitch," ",null==t.dms_neutral_camera_config?null:t.dms_neutral_camera_config.yaw," ",null==t.dms_neutral_camera_config?null:t.dms_neutral_camera_config.roll," "),e.xp6(4),e.hij(" ",null!=t.dms_neutral_camera_config&&t.dms_neutral_camera_config.calibration_type?t.dms_neutral_camera_config.calibration_type:""," "),e.xp6(4),e.hij(" ",t.channel_count," "),e.xp6(4),e.hij(" ",t.state," "),e.xp6(4),e.hij(" ",t.city," "),e.xp6(1),e.Q6J("ngIf",s.editDevceConfigList)}}function ut(i,l){1&i&&e.YNc(0,ct,42,13,"ng-template",48)}function pt(i,l){1&i&&(e.TgZ(0,"div")(1,"div",83),e._uU(2,"Device ID is required."),e.qZA()())}function dt(i,l){1&i&&(e.TgZ(0,"div")(1,"div",83),e._uU(2,"Plate Number is required."),e.qZA()())}function _t(i,l){1&i&&(e.TgZ(0,"div")(1,"div",83),e._uU(2,"IMEI is required."),e.qZA()())}function mt(i,l){1&i&&(e.TgZ(0,"div")(1,"div",83),e._uU(2,"Channels is required."),e.qZA()())}function gt(i,l){1&i&&(e.TgZ(0,"div")(1,"div",83),e._uU(2,"Province is required."),e.qZA()())}function ft(i,l){1&i&&(e.TgZ(0,"div")(1,"div",83),e._uU(2,"City is required."),e.qZA()())}function ht(i,l){1&i&&e._uU(0),2&i&&e.hij(" ",l.$implicit.name," ")}function vt(i,l){1&i&&(e.TgZ(0,"div")(1,"div",83),e._uU(2,"Fleet is required."),e.qZA()())}const k=function(i){return{"ng-invalid ng-dirty":i}};function bt(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"form",59),e.NdJ("ngSubmit",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.saveDevice())}),e.TgZ(1,"div",60)(2,"div",61)(3,"div",62)(4,"label",63),e._uU(5,"Device ID"),e.qZA(),e.TgZ(6,"input",64),e.NdJ("ngModelChange",function(n){e.CHM(t);const o=e.oxw();return e.KtG(o.device.client_provided_id=n)}),e.qZA(),e.YNc(7,pt,3,0,"div",15),e.qZA()(),e.TgZ(8,"div",61)(9,"div",62)(10,"label",65),e._uU(11,"Plate Number"),e.qZA(),e.TgZ(12,"input",66),e.NdJ("ngModelChange",function(n){e.CHM(t);const o=e.oxw();return e.KtG(o.device.plate_number=n)}),e.qZA(),e.YNc(13,dt,3,0,"div",15),e.qZA()(),e.TgZ(14,"div",61)(15,"div",62)(16,"label",67),e._uU(17,"IMEI"),e.qZA(),e.TgZ(18,"input",68),e.NdJ("ngModelChange",function(n){e.CHM(t);const o=e.oxw();return e.KtG(o.device.imei=n)}),e.qZA(),e.YNc(19,_t,3,0,"div",15),e.qZA()(),e.TgZ(20,"div",61)(21,"div",62)(22,"label",69),e._uU(23,"Channels"),e.qZA(),e.TgZ(24,"input",70),e.NdJ("ngModelChange",function(n){e.CHM(t);const o=e.oxw();return e.KtG(o.device.channel_count=n)}),e.qZA(),e.YNc(25,mt,3,0,"div",15),e.qZA()(),e.TgZ(26,"div",61)(27,"div",62)(28,"label",71),e._uU(29,"Province"),e.qZA(),e.TgZ(30,"input",72),e.NdJ("ngModelChange",function(n){e.CHM(t);const o=e.oxw();return e.KtG(o.device.state=n)}),e.qZA(),e.YNc(31,gt,3,0,"div",15),e.qZA()(),e.TgZ(32,"div",61)(33,"div",62)(34,"label",73),e._uU(35,"City"),e.qZA(),e.TgZ(36,"input",74),e.NdJ("ngModelChange",function(n){e.CHM(t);const o=e.oxw();return e.KtG(o.device.city=n)}),e.qZA(),e.YNc(37,ft,3,0,"div",15),e.qZA()(),e.TgZ(38,"div",75)(39,"div",62)(40,"label",76),e._uU(41,"Fleet"),e.qZA(),e.TgZ(42,"p-panel",77)(43,"p-tree",78),e.NdJ("onNodeSelect",function(n){e.CHM(t);const o=e.oxw();return e.KtG(o.onFleetSelect(n))})("selectionChange",function(n){e.CHM(t);const o=e.oxw();return e.KtG(o.selectedFleet=n)}),e.YNc(44,ht,1,1,"ng-template",79),e.qZA()(),e.YNc(45,vt,3,0,"div",15),e.qZA()()(),e.TgZ(46,"div",80)(47,"div",61)(48,"button",81),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.hideDialog())}),e.qZA()(),e.TgZ(49,"div",61),e._UZ(50,"button",82),e.qZA()()()}if(2&i){const t=e.oxw();e.Q6J("formGroup",t.deviceForm),e.xp6(6),e.Q6J("readonly",t.isEditDevice)("ngModel",t.device.client_provided_id)("ngClass",e.VKq(32,k,t.submitted&&!t.device.client_provided_id)),e.xp6(1),e.Q6J("ngIf",t.submitted&&t.f.client_provided_id.errors),e.xp6(5),e.Q6J("readonly",t.isEditDevice)("ngModel",t.device.plate_number)("ngClass",e.VKq(34,k,t.submitted&&!t.device.plate_number)),e.xp6(1),e.Q6J("ngIf",t.submitted&&t.f.plate_number.errors),e.xp6(5),e.Q6J("readonly",t.isEditDevice)("ngModel",t.device.imei)("ngClass",e.VKq(36,k,t.submitted&&!t.device.imei)),e.xp6(1),e.Q6J("ngIf",t.submitted&&t.f.imei.errors),e.xp6(5),e.Q6J("ngModel",t.device.channel_count)("ngClass",e.VKq(38,k,t.submitted&&!t.device.channel_count)),e.xp6(1),e.Q6J("ngIf",t.submitted&&t.f.channel_count.errors),e.xp6(5),e.Q6J("ngModel",t.device.state)("ngClass",e.VKq(40,k,t.submitted&&!t.device.state)),e.xp6(1),e.Q6J("ngIf",t.submitted&&t.f.state.errors),e.xp6(5),e.Q6J("ngModel",t.device.city)("ngClass",e.VKq(42,k,t.submitted&&!t.device.city)),e.xp6(1),e.Q6J("ngIf",t.submitted&&t.f.city.errors),e.xp6(5),e.Q6J("toggleable",!0)("toggler","header")("expandIcon","pi pi-angle-up")("collapseIcon","pi pi-angle-down"),e.xp6(1),e.Q6J("value",t.fleetsTree)("filter",!0)("filterBy","name")("selection",t.selectedFleet),e.xp6(2),e.Q6J("ngIf",t.submitted&&!t.fleetSelected),e.xp6(5),e.Q6J("disabled",t.submitted||!t.device.client_provided_id||!t.device.plate_number||!t.device.imei||!t.device.channel_count||!t.device.state||!t.device.city||!t.fleetSelected)}}function Ct(i,l){1&i&&(e.TgZ(0,"div",84),e._UZ(1,"div",85)(2,"p-progressSpinner"),e.qZA())}function xt(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"button",89),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.downloadSampleCsv())}),e.qZA()}}function Tt(i,l){}function Zt(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"p-fileUpload",90,91),e.NdJ("onSelect",function(n){e.CHM(t);const o=e.MAs(1),r=e.oxw(2);return e.KtG(r.onCsvSelected(n,o))})("uploadHandler",function(n){e.CHM(t);const o=e.oxw(2);return e.KtG(o.onCsvUpload(n))})("onRemove",function(){e.CHM(t);const n=e.MAs(1),o=e.oxw(2);return e.KtG(o.openCsvUploader(n))}),e.YNc(2,Tt,0,0,"ng-template",17),e.qZA()}2&i&&e.Q6J("multiple",!1)("customUpload",!0)("showCancelButton",!1)("showUploadButton",!1)}function wt(i,l){1&i&&(e.TgZ(0,"h6"),e._uU(1,"Devices"),e.qZA())}function Dt(i,l){if(1&i&&e._UZ(0,"csv-table-component",92),2&i){const t=e.oxw(2);e.Q6J("tableName","device")("uploadedData",t.preUploadDevices)("globalFilterFields","client_provided_id")}}function At(i,l){1&i&&(e.TgZ(0,"h6"),e._uU(1,"Uploaded Devices"),e.qZA())}function Ut(i,l){if(1&i&&e._UZ(0,"csv-table-component",92),2&i){const t=e.oxw(2);e.Q6J("tableName","device")("uploadedData",t.uploadedDevices)("globalFilterFields","client_provided_id")}}function Ft(i,l){if(1&i&&(e.YNc(0,xt,1,0,"button",86),e.YNc(1,Zt,3,4,"p-fileUpload",87),e.YNc(2,wt,2,0,"h6",15),e.YNc(3,Dt,1,3,"csv-table-component",88),e.YNc(4,At,2,0,"h6",15),e.YNc(5,Ut,1,3,"csv-table-component",88)),2&i){const t=e.oxw();e.Q6J("ngIf",!t.isUploaded),e.xp6(1),e.Q6J("ngIf",!t.isUploaded),e.xp6(1),e.Q6J("ngIf",t.showPreUploadDevice&&!t.isUploaded),e.xp6(1),e.Q6J("ngIf",t.showPreUploadDevice&&!t.isUploaded),e.xp6(1),e.Q6J("ngIf",t.isUploaded),e.xp6(1),e.Q6J("ngIf",t.isUploaded)}}function St(i,l){if(1&i&&(e.TgZ(0,"div",93)(1,"div",94),e._UZ(2,"i"),e.qZA()()),2&i){const t=e.oxw();e.xp6(2),e.Gre("",t.confirmIcon," text-xl")}}function Rt(i,l){1&i&&(e.TgZ(0,"th"),e._uU(1," Actions "),e.qZA())}function Nt(i,l){if(1&i&&(e.TgZ(0,"tr")(1,"th",95),e._UZ(2,"p-tableHeaderCheckbox"),e.qZA(),e.TgZ(3,"th",96),e._uU(4,"Video Name"),e._UZ(5,"p-sortIcon",97),e.qZA(),e.TgZ(6,"th",98),e._uU(7,"Status"),e._UZ(8,"p-sortIcon",99),e.qZA(),e.TgZ(9,"th",100),e._uU(10,"Time"),e._UZ(11,"p-sortIcon",101),e.qZA(),e.TgZ(12,"th"),e._uU(13,"Cam Angle "),e.qZA(),e.YNc(14,Rt,2,0,"th",15),e.qZA()),2&i){const t=e.oxw();e.xp6(14),e.Q6J("ngIf",t.editDevceConfigList)}}function yt(i,l){1&i&&e._UZ(0,"i",106)}function It(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"td")(1,"div",2)(2,"button",57),e.NdJ("click",function(){e.CHM(t);const n=e.oxw().$implicit,o=e.oxw(2);return e.KtG(o.setNeutralAngle(o.selectedDeviceForCalibration,n))}),e.qZA()()()}}function Mt(i,l){if(1&i&&(e.TgZ(0,"tr",102)(1,"td"),e._UZ(2,"p-tableCheckbox",103),e.qZA(),e.TgZ(3,"td",104)(4,"span",50),e._uU(5,"Video Name"),e.qZA(),e._uU(6),e.qZA(),e.TgZ(7,"td",51)(8,"span",50),e._uU(9,"Status"),e.qZA(),e.YNc(10,yt,1,0,"i",105),e.qZA(),e.TgZ(11,"td",52)(12,"span",50),e._uU(13,"Time"),e.qZA(),e._uU(14),e.qZA(),e.TgZ(15,"td",53)(16,"span",50),e._uU(17,"Neutral Cam Angle"),e.qZA(),e._uU(18),e.qZA(),e.YNc(19,It,3,0,"td",15),e.qZA()),2&i){const t=l.$implicit,s=e.oxw(2);e.Q6J("pSelectableRow",t),e.xp6(2),e.Q6J("value",t),e.xp6(4),e.hij(" ",t.videoName," "),e.xp6(4),e.Q6J("ngIf",t.status),e.xp6(4),e.hij(" ",t.created_at," "),e.xp6(4),e.lnq(" ",null==t.dms_neutral_camera_config?null:t.dms_neutral_camera_config.pitch," ",null==t.dms_neutral_camera_config?null:t.dms_neutral_camera_config.yaw," ",null==t.dms_neutral_camera_config?null:t.dms_neutral_camera_config.roll," "),e.xp6(1),e.Q6J("ngIf",s.editDevceConfigList)}}function qt(i,l){1&i&&e.YNc(0,Mt,20,9,"ng-template",48)}function Et(i,l){if(1&i&&(e.TgZ(0,"video",110),e._uU(1," Your browser does not support the video tag. "),e.qZA()),2&i){const t=e.oxw(2);e.s9C("id",t.selectedCalibrationVideo.id_),e.Q6J("src",t.selectedCalibrationVideo.videos.driver.url||t.selectedCalibrationVideo.videos.road_front.url,e.LSH)("muted",!0)}}function Jt(i,l){if(1&i&&(e.TgZ(0,"div",107),e._UZ(1,"div",108),e.YNc(2,Et,2,3,"video",109),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.MGl("id","",t.selectedCalibrationVideo.id_,"-backdrop"),e.xp6(1),e.Q6J("ngIf",(null==t.selectedCalibrationVideo.videos||null==t.selectedCalibrationVideo.videos.driver?null:t.selectedCalibrationVideo.videos.driver.url)||(null==t.selectedCalibrationVideo.videos||null==t.selectedCalibrationVideo.videos.road_front?null:t.selectedCalibrationVideo.videos.road_front.url))}}const Pt=function(){return["client_provided_id","fleet_id","plate_number","imei","dms_neutral_camera_config.calibration_type","state","city"]},ce=function(){return[10,20,30]},Gt=function(){return{width:"450px"}},kt=function(){return{width:"900px"}},Yt=function(){return{width:"180px"}},Qt=function(){return["videoName","status","created_at"]};let Ot=(()=>{class i{devicesService;excelExportService;messageService;eventService;fb;changeDetector;confirmationService;ngZone;fleets=[];fleetsTree=[];selectedDeviceFleet={};devices=[];devicesTable=[];deviceForm;selectedFleet;deviceDialog=!1;deleteFleetDialog=!1;deleteFleetsDialog=!1;device={};selectedDevices=[];submitted=!1;cols=[];statuses=[];rowsPerPageOptions=[5,10,20];fleetNameMap={};fleetSelected=!1;isEditDevice=!1;addDeviceComplete;showDevices=!0;reload=!0;calibrated_device_videos;calibrationVideoDialog=!1;selectedDeviceForCalibration=[];selectedCalibrationVideos=[];selectedCalibrationVideo;csvDialogStyle={width:"50vw","max-height":"80vh","overflow-y":"auto"};allDevicesList=[];addDevceConfigList=!0;editDevceConfigList=!0;exportOptions;showSpinner=!1;constructor(t,s,n,o,r,a,d,p){this.devicesService=t,this.excelExportService=s,this.messageService=n,this.eventService=o,this.fb=r,this.changeDetector=a,this.confirmationService=d,this.ngZone=p,this.deviceForm=this.fb.group({client_provided_id:["",[c.kI.required]],plate_number:["",[c.kI.required]],imei:["",[c.kI.required]],channel_count:["",[c.kI.required,c.kI.pattern("^[0-9]*$")]],state:["",[c.kI.required]],city:["",[c.kI.required]],fleet_id:["",[c.kI.required]]})}ngOnInit(){this.selectedFleet=this.selectedDeviceFleet,this.mapFleets(),this.exportOptions=[{label:"Export to Excel",icon:"pi pi-file-excel",command:()=>{this.exportData("excel")}},{label:"Export to CSV",icon:"pi pi-file-excel",command:()=>{this.exportData("csv")}}]}ngOnChanges(){this.selectedFleet=this.selectedDeviceFleet,this.selectedFleet&&(this.devicesTable=[],this.mapFleets(),this.getDevicesForFleet())}mapFleets(){this.fleets?.forEach(t=>{this.fleetNameMap[t.id_]=t.name})}getDevices(){this.allDevicesList=[],this.devicesService.getDevices().subscribe(t=>{this.allDevicesList=t,this.getDevicesForFleet()})}findFleetById=(t,s)=>{for(const n of s){if(n.id_===t)return n;if(n.children&&n.children.length>0){const o=this.findFleetById(t,n.children);if(o)return o}}};addDevicesFromFleet=(t,s,n,o)=>{let r=o.concat(s.filter(d=>d.fleet_id===t));const a=this.findFleetById(t,n);return a?.children&&a.children.length>0&&a.children.forEach(d=>{r=this.addDevicesFromFleet(d.id_,s,n,r)}),r};getDevicesForFleet(){if(this.allDevicesList.length){let t=[];t=this.addDevicesFromFleet(this.selectedFleet.id_,this.allDevicesList,this.fleetsTree,this.devicesTable),this.devicesTable=[],t.forEach(s=>{s.fleet_name=this.fleetNameMap[s.fleet_id]}),this.devicesTable=t}else this.getDevices()}get f(){return this.deviceForm.controls}onFleetSelect(t){this.fleetSelected=!0,this.device.fleet_id=t.node.id_}openNew(){this.isEditDevice=!1,this.fleetSelected=!1,this.device={},this.submitted=!1,this.deviceDialog=!0}downloadSampleCsv(){let n={Sheets:{"Sample Device Csv":X.P6.json_to_sheet([{"Fleet Name":"ettest1","Client Device ID":"ABCDEF124","License Plate":"123456",IMEI:"adsfadsf1","Driver Position":"LEFT","DMS Channel Number":1,"ADAS Channel Number":2,"Channel Count":5,State:"MH",City:"Pune"},{"Fleet Name":"testet1","Client Device ID":"ABCDEF125","License Plate":"654321",IMEI:"adsfadsf6","Driver Position":"LEFT","DMS Channel Number":1,"ADAS Channel Number":2,"Channel Count":5,State:"MH",City:"Pune"},{"Fleet Name":"testet2","Client Device ID":"ABCDEF126","License Plate":"321654",IMEI:"adsfadsf2","Driver Position":"RIGHT","DMS Channel Number":1,"ADAS Channel Number":2,"Channel Count":5,State:"MH",City:"Pune"},{"Fleet Name":"testet3","Client Device ID":"ABCDEF127","License Plate":"123654",IMEI:"adsfadsf3","Driver Position":"LEFT","DMS Channel Number":1,"ADAS Channel Number":2,"Channel Count":5,State:"MH",City:"Pune"}])},SheetNames:["Sample Device Csv"]},o=X.cW(n,{bookType:"xlsx",type:"array"}),r=new Blob([o],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});(0,re.saveAs)(r,"sample_device_csv.xlsx")}isUploaded=!1;deviceCsvDialog=!1;uploadedDevices;csvDeviceData;showPreUploadDevice=!1;preUploadDevices=[];onCsvSelected(t,s){let o=t.currentFiles[0],r=new FileReader;r.readAsText(o),this.showPreUploadDevice=!1,this.csvDeviceData=[],this.preUploadDevices=[],r.onload=a=>{let p=r.result.split("\n");("Fleet Name"===p[0].split(",")[0]||"fleet name"===p[0].split(",")[0]||"Fleet"===p[0].split(",")[0]||"fleet"===p[0].split(",")[0]||"Fleet_Name"===p[0].split(",")[0]||"fleet_name"===p[0].split(",")[0])&&p.shift(),""===p[p.length-1]&&p.pop();let q=!1,A=!1,J=p.map(w=>w.split(",")[1]),T=p.map(w=>w.split(",")[3]);p.forEach((w,Z)=>{let R=w.split(","),U={fleet_name:R[0],client_provided_id:R[1],plate_number:R[2],imei:R[3],driver_position:R[4].toUpperCase(),dms_channel_number:R[5],adas_channel_number:R[6],channel_count:R[7],state:R[8],city:R[9],status:1,message:""};this.preUploadDevices.push(U),R.length>10&&(q=!0),""===U.fleet_name?(A=!0,this.preUploadDevices[Z].status=-6,this.preUploadDevices[Z].message="Empty Fleet Name"):""===U.client_provided_id?(A=!0,this.preUploadDevices[Z].status=-5,this.preUploadDevices[Z].message="Empty Clinet Device Id"):""===U.imei?(A=!0,this.preUploadDevices[Z].status=-4,this.preUploadDevices[Z].message="Empty IMEI"):J.indexOf(U.client_provided_id)!==Z?(A=!0,this.preUploadDevices[J.indexOf(U.client_provided_id)].status=-3,this.preUploadDevices[J.indexOf(U.client_provided_id)].message="Duplicate Client Device Id",this.preUploadDevices[Z].status=-3,this.preUploadDevices[Z].message="Duplicate Client Device Id"):T.indexOf(U.imei)!==Z?(A=!0,this.preUploadDevices[T.indexOf(U.imei)].status=-4,this.preUploadDevices[T.indexOf(U.imei)].message="Duplicate IMEI",this.preUploadDevices[Z].status=-2,this.preUploadDevices[Z].message="Duplicate IMEI"):U.driver_position&&"LEFT"!==U.driver_position&&"RIGHT"!==U.driver_position&&(A=!0,this.preUploadDevices[Z].status=-1,this.preUploadDevices[Z].message="Bad Driver Position"),this.csvDeviceData.push(U)}),this.ngZone.run(()=>{if(q)return s.remove(t,0),s.showUploadButton=!1,void this.messageService.add({severity:"error",summary:"Device Import",detail:"Wrong file format.Please download sample file.",life:3e3});A?(s.showUploadButton=!1,this.confirmIcon="pi pi-exclamation-triangle",this.confirmationService.confirm({header:"Incorrect Device Data",message:"Incorrect Device Data",accept:()=>{},reject:()=>{}}),this.messageService.add({severity:"error",summary:"Device Import",detail:"Incorrect Device Data.",life:3e3})):(s.showUploadButton=!0,this.confirmIcon="pi pi-check",this.confirmationService.confirm({header:"Valid Device Data",message:"Valid Device Data",accept:()=>{},reject:()=>{}})),this.changeDetector.detectChanges()}),this.showPreUploadDevice=!0}}confirmIcon;onCsvUpload(t){this.showSpinner=!0,this.showPreUploadDevice=!1;for(let n=0;n<this.csvDeviceData.length;n++)delete this.csvDeviceData[n].status;let s=this.devicesService.addDevicesCsv(this.csvDeviceData).subscribe({next:n=>{if(void 0!==n){this.uploadedDevices=n,this.isUploaded=!0;let o=!0;this.uploadedDevices.forEach(r=>{1!==r.status&&(o=!1)}),o?this.messageService.add({severity:"success",summary:"Device Import",detail:t.files[t.files.length-1].name+" Uploaded.",life:3e3}):this.uploadedDevices.every(r=>1!==r.status)?this.messageService.add({severity:"error",summary:"Device Import",detail:"No Devices Added.",life:3e3}):this.messageService.add({severity:"warn",summary:"Device Import",detail:"Partial Devices Added.",life:3e3}),this.getDevicesForFleet()}else this.messageService.add({severity:"error",summary:"Device Import",detail:"Failed to Import Devices",life:3e3});this.showSpinner=!1},error:n=>{this.showSpinner=!1,this.messageService.add({severity:"error",summary:"Failure",detail:n,life:3e3})}});s&&s.unsubscribe()}openCsvUploader(t){void 0!==t&&(t.showUploadButton=!1),this.isUploaded=this.showPreUploadDevice=!1,this.uploadedDevices=this.csvDeviceData=this.preUploadDevices=[],this.deviceCsvDialog=!0}hideCsvUploader(){this.deviceCsvDialog=this.isUploaded=this.showPreUploadDevice=!1,this.uploadedDevices=this.csvDeviceData=this.preUploadDevices=[]}deleteSelectedDevices(){this.deleteFleetsDialog=!0}editDevice(t){this.device={...t},this.deviceDialog=!0,this.isEditDevice=!0,this.fleetSelected=!0}deleteDevice(t){this.deleteFleetDialog=!0,this.device={...t}}confirmDeleteSelected(){this.deleteFleetsDialog=!1,this.fleets=this.fleets.filter(t=>!this.selectedDevices.includes(t)),this.messageService.add({severity:"success",summary:"Successful",detail:"fleets Deleted",life:3e3}),this.selectedDevices=[]}confirmDelete(){this.deleteFleetDialog=!1,this.fleets=this.fleets.filter(t=>t.id!==this.device.id),this.messageService.add({severity:"success",summary:"Successful",detail:"device Deleted",life:3e3}),this.device={}}hideDialog(){this.deviceDialog=!1,this.submitted=!1}saveDevice(){this.submitted=!0,this.isEditDevice?this.addDeviceComplete=this.devicesService.editDevice(this.device,this.device.id_).subscribe({next:t=>{null!=t&&(this.showDevices=!0,this.addDeviceComplete.unsubscribe(),this.getDevicesForFleet(),this.messageService.add({severity:"success",summary:"Successful",detail:"Device updated successfully",life:3e3}),this.hideDialog())},error:t=>{this.messageService.add({severity:"error",summary:"Failure",detail:t,life:3e3})}}):this.fleetSelected?this.addDeviceComplete=this.devicesService.addDevice(this.device).subscribe({next:t=>{null!=t&&(this.showDevices=!0,this.addDeviceComplete.unsubscribe(),this.getDevicesForFleet(),this.messageService.add({severity:"success",summary:"Successful",detail:"Device added successfully",life:3e3}),this.hideDialog())},error:t=>{this.messageService.add({severity:"error",summary:"Failure",detail:t,life:3e3})}}):this.messageService.add({severity:"failure",summary:"Fleet Select",detail:"Please Select Fleet",life:3e3})}onGlobalFilter(t,s){t.filterGlobal(s.target.value,"contains")}expand(t,s){t.stopPropagation(),s.exp=!s.exp}expandTree(t){this.expandNodes(t.originalEvent.option.children)}expandNodes(t){t.forEach(s=>{s.expanded=!0,s.children&&this.expandNodes(s.children)})}deviceCalbration(t){this.selectedCalibrationVideos=[],this.calibrationVideoDialog=!0,this.selectedDeviceForCalibration=t,this.eventService.getEventsForDevices(t.id_,!0).subscribe(s=>{this.calibrated_device_videos=s,this.calibrated_device_videos.forEach(n=>{let o=n.videos.driver.cloud_video_path?.cloud_file_name.split("/");n.videoName=o?o[o.length-1]:"NA",n.status=n.id_==t.dms_neutral_camera_config?.calibration_event_id})})}setNeutralAngle(t,s){t.dms_neutral_camera_config.calibration_type="MANUAL",t.dms_neutral_camera_config.calibration_event_id=s.id_,t.dms_neutral_camera_config.pitch=s.dms_neutral_camera_config.pitch,t.dms_neutral_camera_config.yaw=s.dms_neutral_camera_config.yaw,t.dms_neutral_camera_config.roll=s.dms_neutral_camera_config.roll,this.addDeviceComplete=this.devicesService.editDevice(t,t.id_).subscribe({next:n=>{null!=n&&(this.deviceCalbration(t),this.addDeviceComplete.unsubscribe(),this.messageService.add({severity:"success",summary:"Successful",detail:"Nueutral angle set successfully",life:3e3}))},error:n=>{this.messageService.add({severity:"error",summary:"Failure",detail:n,life:3e3})}})}resetNeutralAngle(t){t.dms_neutral_camera_config.calibration_type="",t.dms_neutral_camera_config.calibration_event_id="",this.addDeviceComplete=this.devicesService.editDevice(t,t.id_).subscribe({next:s=>{null!=s&&(this.deviceCalbration(t),this.addDeviceComplete.unsubscribe(),this.messageService.add({severity:"success",summary:"Successful",detail:"Nueutral angle reset successful",life:3e3}))},error:s=>{this.messageService.add({severity:"error",summary:"Failure",detail:s,life:3e3})}})}onRowSelectCalibrationDialog(t){t.length>0&&(this.selectedCalibrationVideo=t[t.length-1])}exportData(t){const s=[];this.devicesTable.forEach(o=>{s.push({"Device Id":o.client_provided_id,Fleet:this.fleetNameMap[o.fleet_id],"Plate No.":o.plate_number,IMEI:o.imei,"Vehicle Type":o.type,"Neutral Cam Angle":(o.dms_neutral_camera_config?.pitch??"")+" "+(o.dms_neutral_camera_config?.yaw??"")+" "+(o.dms_neutral_camera_config?.roll??""),"Calibration Type":o.dms_neutral_camera_config?.calibration_type?o.dms_neutral_camera_config.calibration_type:"","Channel Count":o.channel_count,Province:o.state,City:o.city})});const n="Devices List - "+(new Date).toLocaleDateString();this.excelExportService.exportData(s,n,t)}static \u0275fac=function(s){return new(s||i)(e.Y36(D.Ih),e.Y36(E.U0),e.Y36(f.ez),e.Y36(D.nC),e.Y36(c.qu),e.Y36(e.sBO),e.Y36(f.YP),e.Y36(e.R0b))};static \u0275cmp=e.Xpm({type:i,selectors:[["app-device-configuration"]],inputs:{fleets:"fleets",fleetsTree:"fleetsTree",selectedDeviceFleet:"selectedDeviceFleet"},features:[e._Bn([f.ez,f.YP]),e.TTD],decls:38,vars:50,consts:[[1,"flex","align-items-center","justify-content-between","mb-3","mt-2"],[1,"text-xl","font-bold","letter-spacing-01","px-3"],[1,"flex"],[1,"flex","flex-column","md:flex-row","md:justify-content-between","md:align-items-center"],[1,"block","mt-2","md:mt-0","p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Search Device...",1,"w-full","sm:w-auto",3,"input"],["pButton","","pRipple","","label","Add Device","class","ml-3",3,"click",4,"ngIf"],["pButton","","pRipple","","label","Import","class","ml-3",3,"click",4,"ngIf"],[3,"popup","model"],["menu",""],["pButton","","pRipple","","type","button","icon","pi pi-ellipsis-v",1,"p-button-rounded","p-button-text","p-button-secondary","p-trigger",3,"click"],["responsiveLayout","scroll","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries","selectionMode","multiple","dataKey","id",3,"value","columns","autoLayout","rows","globalFilterFields","paginator","rowsPerPageOptions","showCurrentPageReport","selection","rowHover","selectionChange"],["dt",""],["pTemplate","header"],[4,"ngIf"],["header","Device Details",1,"p-fluid",3,"visible","modal","visibleChange"],["pTemplate","content"],["header","Upload Device CSV",1,"p-fluid",3,"visible","modal","visibleChange"],["class","spinner-container",4,"ngIf"],["cd",""],["pTemplate","message"],[1,"p-fluid",3,"visible","modal","visibleChange"],[1,"flex","align-items-center","justify-content-between","mb-3"],["pButton","","pRipple","","label","Reset Neutral Angle",1,"ml-1",3,"click"],["aria-hidden","true",1,"fa","fa-check-square-o"],["responsiveLayout","scroll","dataKey","videoName","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries","dataKey","id_",3,"value","columns","autoLayout","rows","globalFilterFields","paginator","rowsPerPageOptions","showCurrentPageReport","selection","rowHover","selectionChange"],["class","video-container d-flex justify-content-center mt-3",4,"ngIf"],["pButton","","pRipple","","label","Add Device",1,"ml-3",3,"click"],["pButton","","pRipple","","label","Import",1,"ml-3",3,"click"],["pSortableColumn","client_provided_id"],["field","client_provided_id"],["pSortableColumn","fleet_name"],["field","fleet_name"],["pSortableColumn","plate_number"],["field","plate_number"],["pSortableColumn","imei"],["field","imei"],["pSortableColumn","type"],["field","type"],["pSortableColumn","dms_neutral_camera_config.calibration_type"],["field","dms_neutral_camera_config.calibration_type"],["pSortableColumn","channel_count"],["field","channel_count"],["pSortableColumn","state"],["field","state"],["pSortableColumn","city"],["field","city"],["pTemplate","body"],[2,"width","10%","min-width","12rem"],[1,"p-column-title"],[2,"width","4%","min-width","9rem"],[2,"width","10%","min-width","10rem"],[2,"width","7%","min-width","10rem"],[2,"width","4%","min-width","10rem"],[2,"width","9%","min-width","10rem"],[2,"width","9%","min-width","9rem"],["pButton","","pRipple","","type","button","icon","pi pi-pencil",1,"p-button-rounded","p-button-text",3,"click"],["pButton","","pRipple","","type","button","icon","pi pi-camera",1,"p-button-rounded","p-button-text",3,"click"],[3,"formGroup","ngSubmit"],[1,"grid"],[1,"col-12","md:col-6"],[1,"field"],["for","name"],["type","text","pInputText","","id","clientDeviceId","formControlName","client_provided_id",3,"readonly","ngModel","ngClass","ngModelChange"],["for","plate_number"],["type","text","pInputText","","id","plateNumber","formControlName","plate_number",3,"readonly","ngModel","ngClass","ngModelChange"],["for","imei"],["type","text","pInputText","","id","imei","formControlName","imei",3,"readonly","ngModel","ngClass","ngModelChange"],["for","channels"],["type","number","pInputText","","id","channels","formControlName","channel_count","min","1","max","6",3,"ngModel","ngClass","ngModelChange"],["for","state"],["type","text","pInputText","","id","province","formControlName","state","autofocus","",3,"ngModel","ngClass","ngModelChange"],["for","city"],["type","text","pInputText","","id","city","formControlName","city","autofocus","",3,"ngModel","ngClass","ngModelChange"],[1,"col-12"],["for","role"],[3,"toggleable","toggler","expandIcon","collapseIcon"],["selectionMode","single","appendTo","body",3,"value","filter","filterBy","selection","onNodeSelect","selectionChange"],["pTemplate","default"],[1,"grid","float-right"],["pButton","","pRipple","","type","button","label","Cancel","icon","pi pi-times",1,"p-button-text",3,"click"],["pButton","","pRipple","","type","submit","label","Save","icon","pi pi-check",1,"p-button-text",3,"disabled"],[1,"ng-dirty","ng-invalid","text-red-700","mt-1"],[1,"spinner-container"],[1,"overlay"],["pButton","","pRipple","","label","Download","icon","pi pi-download","class","p-button-text download-button","pTooltip","Click to Download Sample CSV","tooltipPosition","top",3,"click",4,"ngIf"],["name","myfile[]","accept",".csv",3,"multiple","customUpload","showCancelButton","showUploadButton","onSelect","uploadHandler","onRemove",4,"ngIf"],[3,"tableName","uploadedData","globalFilterFields",4,"ngIf"],["pButton","","pRipple","","label","Download","icon","pi pi-download","pTooltip","Click to Download Sample CSV","tooltipPosition","top",1,"p-button-text","download-button",3,"click"],["name","myfile[]","accept",".csv",3,"multiple","customUpload","showCancelButton","showUploadButton","onSelect","uploadHandler","onRemove"],["fileUploader",""],[3,"tableName","uploadedData","globalFilterFields"],[1,"flex","flex-column","align-items-center","p-5","surface-overlay","border-round"],[1,"border-circle","bg-primary","inline-flex","justify-content-center","align-items-center","h-3rem","w-3rem","mt-1"],[2,"width","3rem"],["pSortableColumn","videoName"],["field","videoName"],["pSortableColumn","status"],["field","status"],["pSortableColumn","created_at"],["field","created_at"],[3,"pSelectableRow"],[3,"value"],[2,"width","10%","min-width","22rem"],["class","pi pi-check-square","aria-hidden","true",4,"ngIf"],["aria-hidden","true",1,"pi","pi-check-square"],[1,"video-container","d-flex","justify-content-center","mt-3"],[1,"video-wrapper","d-flex","justify-content-center",3,"id"],["onclick","arguments[0].preventDefault();","controls","",3,"id","src","muted",4,"ngIf"],["onclick","arguments[0].preventDefault();","controls","",3,"id","src","muted"]],template:function(s,n){if(1&s){const o=e.EpF();e._UZ(0,"p-toast"),e.TgZ(1,"div",0)(2,"div",1),e._uU(3,"Device"),e.qZA(),e.TgZ(4,"div",2)(5,"div",3)(6,"span",4),e._UZ(7,"i",5),e.TgZ(8,"input",6),e.NdJ("input",function(a){e.CHM(o);const d=e.MAs(15);return e.KtG(n.onGlobalFilter(d,a))}),e.qZA()()(),e.YNc(9,st,1,0,"button",7),e.YNc(10,ot,1,0,"button",8),e._UZ(11,"p-menu",9,10),e.TgZ(13,"button",11),e.NdJ("click",function(a){e.CHM(o);const d=e.MAs(12);return e.KtG(d.toggle(a))}),e.qZA()()(),e.TgZ(14,"p-table",12,13),e.NdJ("selectionChange",function(a){return n.selectedDevices=a}),e.YNc(16,rt,31,1,"ng-template",14),e.YNc(17,ut,1,0,null,15),e.qZA(),e.TgZ(18,"p-dialog",16),e.NdJ("visibleChange",function(a){return n.deviceDialog=a}),e.YNc(19,bt,51,44,"ng-template",17),e.qZA(),e.TgZ(20,"p-dialog",18),e.NdJ("visibleChange",function(a){return n.deviceCsvDialog=a}),e.YNc(21,Ct,3,0,"div",19),e.YNc(22,Ft,6,6,"ng-template",17),e.TgZ(23,"p-confirmDialog",null,20),e.YNc(25,St,3,3,"ng-template",21),e.qZA()(),e.TgZ(26,"p-dialog",22),e.NdJ("visibleChange",function(a){return n.calibrationVideoDialog=a}),e.TgZ(27,"p-header")(28,"div",23)(29,"div",1),e._uU(30," Device Calibration"),e.qZA(),e.TgZ(31,"button",24),e.NdJ("click",function(){return n.resetNeutralAngle(n.selectedDeviceForCalibration)}),e.qZA()()(),e._UZ(32,"i",25),e.TgZ(33,"p-table",26,13),e.NdJ("selectionChange",function(a){return n.onRowSelectCalibrationDialog(a)})("selectionChange",function(a){return n.selectedCalibrationVideos=a}),e.YNc(35,Nt,15,1,"ng-template",14),e.YNc(36,qt,1,0,null,15),e.qZA(),e.YNc(37,Jt,3,2,"div",27),e.qZA()}2&s&&(e.xp6(9),e.Q6J("ngIf",n.addDevceConfigList),e.xp6(1),e.Q6J("ngIf",n.addDevceConfigList),e.xp6(1),e.Q6J("popup",!0)("model",n.exportOptions),e.xp6(3),e.Q6J("value",n.devicesTable)("columns",n.cols)("autoLayout",!0)("rows",10)("globalFilterFields",e.DdM(43,Pt))("rows",10)("paginator",!0)("rowsPerPageOptions",e.DdM(44,ce))("showCurrentPageReport",!0)("selection",n.selectedDevices)("rowHover",!0),e.xp6(3),e.Q6J("ngIf",n.showDevices),e.xp6(1),e.Akn(e.DdM(45,Gt)),e.Q6J("visible",n.deviceDialog)("modal",!0),e.xp6(2),e.Akn(n.csvDialogStyle),e.Q6J("visible",n.deviceCsvDialog)("modal",!0),e.xp6(1),e.Q6J("ngIf",n.showSpinner),e.xp6(5),e.Akn(e.DdM(46,kt)),e.Q6J("visible",n.calibrationVideoDialog)("modal",!0),e.xp6(5),e.Akn(e.DdM(47,Yt)),e.xp6(2),e.Q6J("value",n.calibrated_device_videos)("columns",n.cols)("autoLayout",!0)("rows",10)("globalFilterFields",e.DdM(48,Qt))("paginator",!0)("rowsPerPageOptions",e.DdM(49,ce))("showCurrentPageReport",!0)("selection",n.selectedCalibrationVideos)("rowHover",!0),e.xp6(3),e.Q6J("ngIf",n.showDevices),e.xp6(1),e.Q6J("ngIf",n.selectedCalibrationVideos.length>0))},dependencies:[C.mk,C.O5,ie.mp,f.h4,f.jx,O.u,v.iA,v.lQ,v.Ei,v.fz,v.UA,v.Mo,c._Y,c.Fj,c.wV,c.JJ,c.JL,c.qQ,c.Fd,F.Hq,S.H,G.FN,b.o,x.V,N.p,c.sg,c.u,P.s,I.Q,M.G,h.v2,ae],styles:["[_nghost-%COMP%]     .p-tree-wrapper{height:300px}[_nghost-%COMP%]     .p-panel .p-panel-header{background:transparent}[_nghost-%COMP%]     .p-fileupload-buttonbar{text-align:center}[_nghost-%COMP%]     .spinner-container{position:fixed;width:100%;height:100%;display:flex;justify-content:center;align-items:center;z-index:10;margin-left:-1.5rem;margin-top:-5rem}[_nghost-%COMP%]     .overlay{position:absolute;width:100%;height:100%;background-color:#00000080;z-index:9999}[_nghost-%COMP%]     .download-button{width:9rem!important;left:14rem;top:1rem;position:absolute}[_nghost-%COMP%]     .download-button:hover{opacity:.5!important;color:#fff!important;background-color:#3a85c1!important}[_nghost-%COMP%]     p-fileUpload .p-ripple.p-element.p-button.p-component{margin-top:1rem}[_nghost-%COMP%]     p-confirmDialog .p-dialog-footer{display:none!important}.video-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.video-container[_ngcontent-%COMP%]   video[_ngcontent-%COMP%]{width:100%}.video-container[_ngcontent-%COMP%]{height:50%;width:50%;min-height:100px;background-image:url(video-placeholder.c569469c678aa08a.png);background-size:cover;background-position:center}.video-wrapper[_ngcontent-%COMP%]{height:100%;width:100%;position:relative;display:inline-block}.video-backdrop[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:50%;height:50%;background-color:#00000040;z-index:0}tr[_ngcontent-%COMP%], td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{text-align:left}"]})}return i})();var Ht=u(7707);function jt(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"button",26),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.openNew())}),e.qZA()}}function Lt(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"button",27),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.openCsvUploader())}),e.qZA()}}function Kt(i,l){1&i&&(e.TgZ(0,"th",31),e._uU(1," Actions "),e.qZA())}function Bt(i,l){if(1&i&&(e.TgZ(0,"tr")(1,"th",28),e._uU(2,"Fleet Name "),e._UZ(3,"p-sortIcon",29),e.qZA(),e.TgZ(4,"th"),e._uU(5,"Parent Fleet "),e.qZA(),e.YNc(6,Kt,2,0,"th",30),e.qZA()),2&i){const t=e.oxw();e.xp6(6),e.Q6J("ngIf",t.editFleetConfigList)}}function Vt(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"td",31)(1,"div",2)(2,"button",34),e.NdJ("click",function(){e.CHM(t);const n=e.oxw().$implicit,o=e.oxw(2);return e.KtG(o.editFleet(n))}),e.qZA()()()}}function $t(i,l){if(1&i&&(e.TgZ(0,"tr")(1,"td")(2,"span",33),e._uU(3,"Fleet Name"),e.qZA(),e._uU(4),e.qZA(),e.TgZ(5,"td")(6,"span",33),e._uU(7,"Parent Fleet"),e.qZA(),e._uU(8),e.qZA(),e.YNc(9,Vt,3,0,"td",30),e.qZA()),2&i){const t=l.$implicit,s=e.oxw(2);e.xp6(4),e.hij(" ",t.name," "),e.xp6(4),e.hij(" ",s.fleetNameMap[t.parent_fleet_id]," "),e.xp6(1),e.Q6J("ngIf",s.editFleetConfigList)}}function zt(i,l){1&i&&e.YNc(0,$t,10,3,"ng-template",32)}function Wt(i,l){if(1&i&&e._UZ(0,"img",41),2&i){const t=e.oxw(2);e.Q6J("src","assets/demo/images/fleet/"+t.fleet.image,e.LSH)("alt",t.fleet.image)}}function Xt(i,l){1&i&&(e.TgZ(0,"small",42),e._uU(1,"Name is required."),e.qZA())}function ei(i,l){1&i&&e._uU(0),2&i&&e.hij(" ",l.$implicit.name," ")}function ti(i,l){1&i&&e._uU(0),2&i&&e.hij(" ",l.$implicit.name," ")}function ii(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"div",36)(1,"label",43),e._uU(2,"Parent Fleet"),e.qZA(),e.TgZ(3,"p-treeSelect",44),e.NdJ("ngModelChange",function(n){e.CHM(t);const o=e.oxw(2);return e.KtG(o.selectedParentFleet=n)}),e.YNc(4,ei,1,1,"ng-template",45),e.YNc(5,ti,1,1,"ng-template",46),e.qZA()()}if(2&i){const t=e.oxw(2);e.xp6(3),e.Q6J("ngModel",t.selectedParentFleet)("options",t.fleetsTree)}}const ni=function(i){return{"ng-invalid ng-dirty":i}};function si(i,l){if(1&i){const t=e.EpF();e.YNc(0,Wt,1,2,"img",35),e.TgZ(1,"div",36)(2,"label",37),e._uU(3,"Name"),e.qZA(),e.TgZ(4,"input",38),e.NdJ("ngModelChange",function(n){e.CHM(t);const o=e.oxw();return e.KtG(o.fleet.name=n)}),e.qZA(),e.YNc(5,Xt,2,0,"small",39),e.qZA(),e.YNc(6,ii,6,2,"div",40)}if(2&i){const t=e.oxw();e.Q6J("ngIf",t.fleet.image),e.xp6(4),e.Q6J("ngModel",t.fleet.name)("ngClass",e.VKq(5,ni,t.submitted&&!t.fleet.name)),e.xp6(1),e.Q6J("ngIf",t.submitted&&!t.fleet.name),e.xp6(1),e.Q6J("ngIf",!t.isEditFleet)}}function oi(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"button",47),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.hideDialog())}),e.qZA(),e.TgZ(1,"button",48),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.saveFleet())}),e.qZA()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("disabled",t.submitted||!t.fleet.name||!t.selectedParentFleet)}}function li(i,l){1&i&&(e.TgZ(0,"div",49),e._UZ(1,"div",50)(2,"p-progressSpinner"),e.qZA())}function ri(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"button",54),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.downloadSampleCsv())}),e.qZA()}}function ai(i,l){}function ci(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"p-fileUpload",55,56),e.NdJ("onSelect",function(n){e.CHM(t);const o=e.MAs(1),r=e.oxw(2);return e.KtG(r.onCsvSelected(n,o))})("uploadHandler",function(n){e.CHM(t);const o=e.oxw(2);return e.KtG(o.onCsvUpload(n))})("onRemove",function(){e.CHM(t);const n=e.MAs(1),o=e.oxw(2);return e.KtG(o.openCsvUploader(n))}),e.YNc(2,ai,0,0,"ng-template",17),e.qZA()}2&i&&e.Q6J("multiple",!1)("customUpload",!0)("showCancelButton",!1)("showUploadButton",!1)}function ui(i,l){1&i&&(e.TgZ(0,"h6"),e._uU(1,"Fleets"),e.qZA())}function pi(i,l){if(1&i&&e._UZ(0,"csv-table-component",57),2&i){const t=e.oxw(2);e.Q6J("tableName","fleet")("uploadedData",t.preUploadFleets)("globalFilterFields","name")}}function di(i,l){1&i&&(e.TgZ(0,"h6"),e._uU(1,"Uploaded Fleets"),e.qZA())}function _i(i,l){if(1&i&&e._UZ(0,"csv-table-component",57),2&i){const t=e.oxw(2);e.Q6J("tableName","fleet")("uploadedData",t.uploadedFleets)("globalFilterFields","name")}}function mi(i,l){if(1&i&&(e.YNc(0,ri,1,0,"button",51),e.YNc(1,ci,3,4,"p-fileUpload",52),e.YNc(2,ui,2,0,"h6",15),e.YNc(3,pi,1,3,"csv-table-component",53),e.YNc(4,di,2,0,"h6",15),e.YNc(5,_i,1,3,"csv-table-component",53)),2&i){const t=e.oxw();e.Q6J("ngIf",!t.isUploaded),e.xp6(1),e.Q6J("ngIf",!t.isUploaded),e.xp6(1),e.Q6J("ngIf",t.showPreUploadFleet&&!t.isUploaded),e.xp6(1),e.Q6J("ngIf",t.showPreUploadFleet&&!t.isUploaded),e.xp6(1),e.Q6J("ngIf",t.isUploaded),e.xp6(1),e.Q6J("ngIf",t.isUploaded)}}function gi(i,l){if(1&i&&(e.TgZ(0,"div",58)(1,"div",59),e._UZ(2,"i"),e.qZA()()),2&i){const t=e.oxw();e.xp6(2),e.Gre("",t.confirmIcon," text-xl")}}function fi(i,l){if(1&i&&(e.TgZ(0,"span"),e._uU(1,"Are you sure you want to delete "),e.TgZ(2,"b"),e._uU(3),e.qZA(),e._uU(4,"?"),e.qZA()),2&i){const t=e.oxw();e.xp6(3),e.Oqu(t.fleet.name)}}function hi(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"button",60),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.deleteFleetDialog=!1)}),e.qZA(),e.TgZ(1,"button",61),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.confirmDelete())}),e.qZA()}}function vi(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"button",60),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.deleteFleetsDialog=!1)}),e.qZA(),e.TgZ(1,"button",61),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.confirmDeleteSelected())}),e.qZA()}}const bi=function(){return["name","id_"]},Ci=function(){return[10,20,30]},se=function(){return{width:"450px"}};let xi=(()=>{class i{fleetService;messageService;adminService;AdminComponent;AppTopbarComponent;utilService;changeDetector;excelExportService;ngZone;confirmationService;fleets=[];fleetsTree=[];fleetDialog=!1;fleetCsvDialog=!1;deleteFleetDialog=!1;deleteFleetsDialog=!1;fleet={};selectedFleets=[];submitted=!1;cols=[];statuses=[];rowsPerPageOptions=[5,10,20];fleetNameMap={};selectedParentFleet;isEditFleet=!1;addFleetComplete;showFleets=!0;csvDialogStyle={width:"40vw","max-height":"80vh","overflow-y":"auto"};addFleetConfigList=!0;editFleetConfigList=!0;error="";showSpinner=!1;exportOptions;fleetsModified=!1;constructor(t,s,n,o,r,a,d,p,q,A){this.fleetService=t,this.messageService=s,this.adminService=n,this.AdminComponent=o,this.AppTopbarComponent=r,this.utilService=a,this.changeDetector=d,this.excelExportService=p,this.ngZone=q,this.confirmationService=A}ngOnInit(){this.mapFleets(),this.adminService.refreshView$.subscribe(()=>{this.mapFleets()}),this.exportOptions=[{label:"Export to Excel",icon:"pi pi-file-excel",command:()=>{this.exportData("excel")}},{label:"Export to CSV",icon:"pi pi-file-excel",command:()=>{this.exportData("csv")}}]}ngOnChanges(){this.mapFleets()}mapFleets(){this.fleets?.forEach(t=>{this.fleetNameMap[t.id_]=t.name})}getFleets(){this.fleetService.getFleets().subscribe(t=>{this.fleets=t,this.fleetsModified&&(E.zt(this.fleets),this.AppTopbarComponent.ngOnInit(),this.fleetsModified=!1),this.mapFleets(),this.adminService.updateViews("fleets")})}openNew(){this.fleet={},this.isEditFleet=!1,this.submitted=!1,this.fleetDialog=!0,this.selectedParentFleet=""}downloadSampleCsv(){let n={Sheets:{"Sample Fleet Csv":X.P6.json_to_sheet([{"Fleet Name":"ettest1","Parent Fleet":""},{"Fleet Name":"testet1","Parent Fleet":"ettest1"},{"Fleet Name":"testet2","Parent Fleet":"ettest1"},{"Fleet Name":"testet3","Parent Fleet":"testet2"}])},SheetNames:["Sample Fleet Csv"]},o=X.cW(n,{bookType:"xlsx",type:"array"}),r=new Blob([o],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});(0,re.saveAs)(r,"sample_fleet_csv.xlsx")}isUploaded=!1;showPreUploadFleet=!1;preUploadFleets=[];uploadedFleets;csvFleetData;onCsvSelected(t,s){let o=t.currentFiles[0],r=new FileReader;r.readAsText(o),this.showPreUploadFleet=!1,this.preUploadFleets=[],this.csvFleetData=[],r.onload=a=>{let p=r.result.split("\n");("Fleet Name"===p[0].split(",")[0]||"fleet name"===p[0].split(",")[0]||"Fleet"===p[0].split(",")[0]||"fleet"===p[0].split(",")[0]||"Fleet_Name"===p[0].split(",")[0]||"fleet_name"===p[0].split(",")[0])&&p.shift(),""===p[p.length-1]&&p.pop(),p=p.filter(T=>T.split(",")[0].trim().length>0||T.split(",")[1]&&T.split(",")[1].trim().length>1);let q=p.some(T=>T.split(",").length>2),A=p.map(T=>T.split(",")[0]),J=!1;A.forEach((T,w)=>{this.csvFleetData.push({name:p[w].split(",")[0].trim(),parent_fleet_name:p[w].split(",")[1].trim()});let Z={name:p[w].split(",")[0],parent_fleet_name:p[w].split(",")[1],status:1,message:""};this.preUploadFleets.push(Z),""===T.trim()?(this.preUploadFleets[w].status=-1,this.preUploadFleets[w].message="Empty Fleet Name",J=!0):A.indexOf(T)!==w&&(this.preUploadFleets[A.indexOf(T)].status=-2,this.preUploadFleets[A.indexOf(T)].message="Duplicate Fleet Name",this.preUploadFleets[w].status=-2,this.preUploadFleets[w].message="Duplicate Fleet Name",J=!0)}),this.ngZone.run(()=>{if(q)return s.remove(t,0),s.showUploadButton=!1,void this.messageService.add({severity:"error",summary:"Fleet Import",detail:"Required Data with 2 Columns.",life:3e3});J?(s.showUploadButton=!1,this.confirmIcon="pi pi-exclamation-triangle",this.confirmationService.confirm({header:"Incorrect Fleet Data",message:"Incorrect Fleet Data",accept:()=>{},reject:()=>{}})):(s.showUploadButton=!0,this.confirmIcon="pi pi-check",this.confirmationService.confirm({header:"Valid Fleet Data",message:"Valid Fleet Data",accept:()=>{},reject:()=>{}})),this.changeDetector.detectChanges()}),this.showPreUploadFleet=!0}}confirmIcon;onCsvUpload(t){this.showSpinner=!0,this.showPreUploadFleet=!1;let s=this.fleetService.addFleetsCsv(this.csvFleetData).subscribe(n=>{if(void 0!==n){this.uploadedFleets=n,this.isUploaded=!0;let o=!0;this.uploadedFleets.forEach(r=>{1!==r.status&&(o=!1)}),o?this.messageService.add({severity:"success",summary:"Fleet Import",detail:t.files[t.files.length-1].name+" Uploaded.",life:3e3}):this.uploadedFleets.every(r=>1!==r.status)?this.messageService.add({severity:"error",summary:"Fleet Import",detail:"No Fleets Added.",life:3e3}):this.messageService.add({severity:"warn",summary:"Fleet Import",detail:"Partial Fleets Added.",life:3e3}),this.fleetsModified=!0,this.getFleets(),this.AdminComponent.ngOnInit(),this.adminService.updateViews("fleets")}else this.messageService.add({severity:"error",summary:"Fleet Import",detail:"Failed to Import Fleets",life:3e3});this.showSpinner=!1,s&&s.unsubscribe()})}openCsvUploader(t){void 0!==t&&(t.showUploadButton=!1),this.isUploaded=this.showPreUploadFleet=!1,this.uploadedFleets=this.csvFleetData=this.preUploadFleets=[],this.fleetCsvDialog=!0}hideCsvUploader(){this.fleetCsvDialog=this.isUploaded=this.showPreUploadFleet=!1,this.uploadedFleets=this.csvFleetData=this.preUploadFleets=[]}deleteSelectedfleets(){this.deleteFleetsDialog=!0}editFleet(t){this.isEditFleet=!0,this.fleet={...t},""!=t.parent_fleet_id&&(this.selectedParentFleet=this.utilService.selectFleetTreeNode(this.fleetsTree,t.parent_fleet_id)),this.fleetDialog=!0}deleteFleet(t){this.deleteFleetDialog=!0,this.fleet={...t}}confirmDeleteSelected(){this.deleteFleetsDialog=!1,this.fleets=this.fleets.filter(t=>!this.selectedFleets.includes(t)),this.messageService.add({severity:"success",summary:"Successful",detail:"fleets Deleted",life:3e3}),this.selectedFleets=[]}confirmDelete(){this.deleteFleetDialog=!1,this.fleets=this.fleets.filter(t=>t.id!==this.fleet.id),this.messageService.add({severity:"success",summary:"Successful",detail:"Fleet Deleted",life:3e3}),this.fleet={}}hideDialog(){this.fleetDialog=!1,this.submitted=!1}saveFleet(){if(this.submitted=!0,this.isEditFleet)this.fleet.id_!=this.fleet.parent_fleet_id?this.addFleetComplete=this.fleetService.editFleet(this.fleet.name,this.fleet.id_).subscribe(s=>{null!=s&&(this.showFleets=!0,this.addFleetComplete.unsubscribe(),this.messageService.add({severity:"success",summary:"Successful",detail:"Fleet updated successfully",life:3e3}),this.hideDialog(),this.fleetsModified=!0,this.getFleets(),this.AdminComponent.ngOnInit(),this.adminService.updateViews("fleets"))}):this.messageService.add({severity:"failure",summary:"Failed",detail:"Fleet and parent should not be same.",life:3e3});else{var t="";this.selectedParentFleet&&(t=this.selectedParentFleet.id_),this.addFleetComplete=this.fleetService.addFleet(this.fleet.name,t).subscribe({next:s=>{null!=s&&(this.showFleets=!0,this.addFleetComplete.unsubscribe(),this.messageService.add({severity:"success",summary:"Successful",detail:"Fleet added successfully",life:3e3}),this.hideDialog(),this.fleetsModified=!0,this.getFleets(),this.AdminComponent.ngOnInit())},error:s=>{this.messageService.add({severity:"error",summary:"Failure",detail:s,life:3e3})}})}}onGlobalFilter(t,s){t.filterGlobal(s.target.value,"contains")}exportData(t){const s=[];this.fleets.forEach(o=>{s.push({"Fleet Name":o.name,"Parent Fleet Name":this.fleetNameMap[o.parent_fleet_id]})});const n="Fleets List - "+(new Date).toLocaleDateString();this.excelExportService.exportData(s,n,t)}static \u0275fac=function(s){return new(s||i)(e.Y36(D.VN),e.Y36(f.ez),e.Y36(z),e.Y36(y),e.Y36(Ht.e),e.Y36(D.FW),e.Y36(e.sBO),e.Y36(E.U0),e.Y36(e.R0b),e.Y36(f.YP))};static \u0275cmp=e.Xpm({type:i,selectors:[["app-fleet-configuration"]],inputs:{fleets:"fleets",fleetsTree:"fleetsTree"},features:[e._Bn([f.ez,f.YP]),e.TTD],decls:38,vars:39,consts:[[1,"flex","align-items-center","justify-content-between","mb-3","px-3","mt-2"],[1,"text-xl","font-bold","letter-spacing-01","mt-3"],[1,"flex"],[1,"flex","flex-column","md:flex-row","md:justify-content-between","md:align-items-center"],[1,"block","mt-2","md:mt-0","p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Search Fleet...",1,"w-full","sm:w-auto",3,"input"],["pButton","","pRipple","","label","Add Fleet","class","ml-3",3,"click",4,"ngIf"],["pButton","","pRipple","","label","Import","class","ml-3",3,"click",4,"ngIf"],[3,"popup","model"],["menu",""],["pButton","","pRipple","","type","button","icon","pi pi-ellipsis-v",1,"p-button-rounded","p-button-text","p-button-secondary","p-trigger",3,"click"],["responsiveLayout","scroll","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries","selectionMode","multiple","dataKey","id",3,"value","columns","autoLayout","rows","globalFilterFields","paginator","rowsPerPageOptions","showCurrentPageReport","selection","rowHover","selectionChange"],["dt",""],["pTemplate","header"],[4,"ngIf"],["header","Fleet Details",1,"p-fluid",3,"visible","modal","visibleChange"],["pTemplate","content"],["pTemplate","footer"],["header","Upload Fleet CSV",1,"p-fluid",3,"visible","modal","visibleChange"],["class","spinner-container",4,"ngIf"],["cd",""],["pTemplate","message"],["header","Confirm",3,"visible","modal","visibleChange"],[1,"flex","align-items-center","justify-content-center"],[1,"pi","pi-exclamation-triangle","mr-3",2,"font-size","2rem"],["pButton","","pRipple","","label","Add Fleet",1,"ml-3",3,"click"],["pButton","","pRipple","","label","Import",1,"ml-3",3,"click"],["pSortableColumn","name"],["field","name"],["class","text-center",4,"ngIf"],[1,"text-center"],["pTemplate","body"],[1,"p-column-title"],["pButton","","pRipple","","type","button","icon","pi pi-pencil",1,"p-button-rounded","p-button-text",3,"click"],["width","150","class","mt-0 mx-auto mb-5 block shadow-2",3,"src","alt",4,"ngIf"],[1,"field"],["for","name"],["type","text","pInputText","","id","name","required","","autofocus","",3,"ngModel","ngClass","ngModelChange"],["class","ng-dirty ng-invalid",4,"ngIf"],["class","field",4,"ngIf"],["width","150",1,"mt-0","mx-auto","mb-5","block","shadow-2",3,"src","alt"],[1,"ng-dirty","ng-invalid"],["for","status"],["placeholder","Select Fleet",3,"ngModel","options","ngModelChange"],["pTemplate","selectedItem"],["pTemplate","default"],["pButton","","pRipple","","label","Cancel","icon","pi pi-times",1,"p-button-text",3,"click"],["pButton","","pRipple","","label","Save","icon","pi pi-check",1,"p-button-text",3,"disabled","click"],[1,"spinner-container"],[1,"overlay"],["pButton","","pRipple","","label","Download","icon","pi pi-download","class","p-button-text download-button","pTooltip","Click to Download Sample CSV","tooltipPosition","top",3,"click",4,"ngIf"],["name","myfile[]","accept",".csv",3,"multiple","customUpload","showCancelButton","showUploadButton","onSelect","uploadHandler","onRemove",4,"ngIf"],[3,"tableName","uploadedData","globalFilterFields",4,"ngIf"],["pButton","","pRipple","","label","Download","icon","pi pi-download","pTooltip","Click to Download Sample CSV","tooltipPosition","top",1,"p-button-text","download-button",3,"click"],["name","myfile[]","accept",".csv",3,"multiple","customUpload","showCancelButton","showUploadButton","onSelect","uploadHandler","onRemove"],["fileUploader",""],[3,"tableName","uploadedData","globalFilterFields"],[1,"flex","flex-column","align-items-center","p-5","surface-overlay","border-round"],[1,"border-circle","bg-primary","inline-flex","justify-content-center","align-items-center","h-3rem","w-3rem","mt-1"],["pButton","","pRipple","","icon","pi pi-times","label","No",1,"p-button-text",3,"click"],["pButton","","pRipple","","icon","pi pi-check","label","Yes",1,"p-button-text",3,"click"]],template:function(s,n){if(1&s){const o=e.EpF();e._UZ(0,"p-toast"),e.TgZ(1,"div",0)(2,"div",1),e._uU(3,"Fleets"),e.qZA(),e.TgZ(4,"div",2)(5,"div",3)(6,"span",4),e._UZ(7,"i",5),e.TgZ(8,"input",6),e.NdJ("input",function(a){e.CHM(o);const d=e.MAs(15);return e.KtG(n.onGlobalFilter(d,a))}),e.qZA()()(),e.YNc(9,jt,1,0,"button",7),e.YNc(10,Lt,1,0,"button",8),e._UZ(11,"p-menu",9,10),e.TgZ(13,"button",11),e.NdJ("click",function(a){e.CHM(o);const d=e.MAs(12);return e.KtG(d.toggle(a))}),e.qZA()()(),e.TgZ(14,"p-table",12,13),e.NdJ("selectionChange",function(a){return n.selectedFleets=a}),e.YNc(16,Bt,7,1,"ng-template",14),e.YNc(17,zt,1,0,null,15),e.qZA(),e.TgZ(18,"p-dialog",16),e.NdJ("visibleChange",function(a){return n.fleetDialog=a}),e.YNc(19,si,7,7,"ng-template",17),e.YNc(20,oi,2,1,"ng-template",18),e.qZA(),e.TgZ(21,"p-dialog",19),e.NdJ("visibleChange",function(a){return n.fleetCsvDialog=a}),e.YNc(22,li,3,0,"div",20),e.YNc(23,mi,6,6,"ng-template",17),e.TgZ(24,"p-confirmDialog",null,21),e.YNc(26,gi,3,3,"ng-template",22),e.qZA()(),e.TgZ(27,"p-dialog",23),e.NdJ("visibleChange",function(a){return n.deleteFleetDialog=a}),e.TgZ(28,"div",24),e._UZ(29,"i",25),e.YNc(30,fi,5,1,"span",15),e.qZA(),e.YNc(31,hi,2,0,"ng-template",18),e.qZA(),e.TgZ(32,"p-dialog",23),e.NdJ("visibleChange",function(a){return n.deleteFleetsDialog=a}),e.TgZ(33,"div",24),e._UZ(34,"i",25),e.TgZ(35,"span"),e._uU(36,"Are you sure you want to delete selected Fleets?"),e.qZA()(),e.YNc(37,vi,2,0,"ng-template",18),e.qZA()}2&s&&(e.xp6(9),e.Q6J("ngIf",n.addFleetConfigList),e.xp6(1),e.Q6J("ngIf",n.addFleetConfigList),e.xp6(1),e.Q6J("popup",!0)("model",n.exportOptions),e.xp6(3),e.Q6J("value",n.fleets)("columns",n.cols)("autoLayout",!0)("rows",10)("globalFilterFields",e.DdM(34,bi))("rows",10)("paginator",!0)("rowsPerPageOptions",e.DdM(35,Ci))("showCurrentPageReport",!0)("selection",n.selectedFleets)("rowHover",!0),e.xp6(3),e.Q6J("ngIf",n.showFleets),e.xp6(1),e.Akn(e.DdM(36,se)),e.Q6J("visible",n.fleetDialog)("modal",!0),e.xp6(3),e.Akn(n.csvDialogStyle),e.Q6J("visible",n.fleetCsvDialog)("modal",!0),e.xp6(1),e.Q6J("ngIf",n.showSpinner),e.xp6(5),e.Akn(e.DdM(37,se)),e.Q6J("visible",n.deleteFleetDialog)("modal",!0),e.xp6(3),e.Q6J("ngIf",n.fleet),e.xp6(2),e.Akn(e.DdM(38,se)),e.Q6J("visible",n.deleteFleetsDialog)("modal",!0))},dependencies:[C.mk,C.O5,f.jx,O.u,v.iA,v.lQ,v.fz,c.Fj,c.JJ,c.Q7,c.On,F.Hq,S.H,G.FN,b.o,x.V,N.p,ne.mP,I.Q,M.G,h.v2,ae],styles:["[_nghost-%COMP%]     .p-dialog-content{overflow:inherit}[_nghost-%COMP%]     .p-fileupload-buttonbar{text-align:center}[_nghost-%COMP%]     .spinner-container{position:fixed;width:100%;height:100%;display:flex;justify-content:center;align-items:center;z-index:10;margin-left:-1.5rem;margin-top:-5rem}[_nghost-%COMP%]     .overlay{position:absolute;width:100%;height:100%;background-color:#00000080;z-index:9999}[_nghost-%COMP%]     .download-button{width:9rem!important;left:13rem;top:1rem;position:absolute}[_nghost-%COMP%]     .download-button:hover{opacity:.5!important;color:#fff!important;background-color:#3a85c1!important}[_nghost-%COMP%]     p-fileUpload .p-ripple.p-element.p-button.p-component{margin-top:1rem}[_nghost-%COMP%]     p-confirmDialog .p-dialog-footer{display:none!important}tr[_ngcontent-%COMP%], td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{text-align:left}"]})}return i})();function Ti(i,l){1&i&&(e.TgZ(0,"tr"),e._UZ(1,"th")(2,"th"),e.TgZ(3,"th",14),e._uU(4,"Roles"),e.qZA()(),e.TgZ(5,"tr")(6,"th"),e._uU(7,"Page"),e.qZA(),e.TgZ(8,"th"),e._uU(9,"Widgets"),e.qZA(),e.TgZ(10,"th"),e._uU(11,"Account Admin"),e.qZA(),e.TgZ(12,"th"),e._uU(13,"Fleet Admin"),e.qZA(),e.TgZ(14,"th"),e._uU(15,"Fleet Manager"),e.qZA(),e.TgZ(16,"th"),e._uU(17,"Reviewer"),e.qZA(),e.TgZ(18,"th"),e._uU(19,"Viewer"),e.qZA(),e.TgZ(20,"th"),e._uU(21,"Device Ops"),e.qZA()())}function Zi(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"tr")(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td")(6,"p-inputSwitch",15),e.NdJ("ngModelChange",function(n){const r=e.CHM(t).$implicit;return e.KtG(r.cust_super_admin=n)}),e.qZA()(),e.TgZ(7,"td")(8,"p-inputSwitch",15),e.NdJ("ngModelChange",function(n){const r=e.CHM(t).$implicit;return e.KtG(r.cust_fleet_admin=n)}),e.qZA()(),e.TgZ(9,"td")(10,"p-inputSwitch",15),e.NdJ("ngModelChange",function(n){const r=e.CHM(t).$implicit;return e.KtG(r.fleet_manager=n)}),e.qZA()(),e.TgZ(11,"td")(12,"p-inputSwitch",15),e.NdJ("ngModelChange",function(n){const r=e.CHM(t).$implicit;return e.KtG(r.reviewer=n)}),e.qZA()(),e.TgZ(13,"td")(14,"p-inputSwitch",15),e.NdJ("ngModelChange",function(n){const r=e.CHM(t).$implicit;return e.KtG(r.viewer=n)}),e.qZA()(),e.TgZ(15,"td")(16,"p-inputSwitch",15),e.NdJ("ngModelChange",function(n){const r=e.CHM(t).$implicit;return e.KtG(r.device_ops=n)}),e.qZA()()()}if(2&i){const t=l.$implicit;e.xp6(2),e.Oqu(t.page),e.xp6(2),e.Oqu(t.sub_menu),e.xp6(2),e.Q6J("ngModel",t.cust_super_admin)("disabled",!0),e.xp6(2),e.Q6J("ngModel",t.cust_fleet_admin)("disabled",!0),e.xp6(2),e.Q6J("ngModel",t.fleet_manager)("disabled",!0),e.xp6(2),e.Q6J("ngModel",t.reviewer)("disabled",!0),e.xp6(2),e.Q6J("ngModel",t.viewer)("disabled",!0),e.xp6(2),e.Q6J("ngModel",t.device_ops)("disabled",!0)}}const wi=function(){return["page","sub_menu"]},Di=function(){return{"min-width":"50rem"}};let Ui=(()=>{class i{messageService;excelExportService;confirmationService;usersRolesService;roleDialog=!1;deleteroleDialog=!1;deleterolesDialog=!1;role={};roles=[];selectedRole="";selectedroles=[];submitted=!1;cols=[];statuses=[];rowsPerpageOptions=[5,10,20];constructor(t,s,n,o){this.messageService=t,this.excelExportService=s,this.confirmationService=n,this.usersRolesService=o}lastYearTotal;thisYearTotal;exportOptions;ngOnInit(){this.roles=[{page:"Dashboard",sub_menu:"Opportunity Assessment Report",edgetensor_super_admin:!0,cust_super_admin:!0,cust_fleet_admin:!0,fleet_manager:!0,reviewer:!1,viewer:!0,device_ops:!1},{page:"Dashboard",sub_menu:"Liability Assessment Report",edgetensor_super_admin:!0,cust_super_admin:!0,cust_fleet_admin:!0,fleet_manager:!0,reviewer:!1,viewer:!0,device_ops:!1},{page:"Dashboard",sub_menu:"Driver Assessment Report",edgetensor_super_admin:!0,cust_super_admin:!0,cust_fleet_admin:!0,fleet_manager:!0,reviewer:!1,viewer:!0,device_ops:!1},{page:"Dashboard",sub_menu:"Driver Scorecard",edgetensor_super_admin:!0,cust_super_admin:!0,cust_fleet_admin:!0,fleet_manager:!0,reviewer:!1,viewer:!0,device_ops:!1},{page:"Dashboard",sub_menu:"Driver Coaching Report",edgetensor_super_admin:!0,cust_super_admin:!0,cust_fleet_admin:!0,fleet_manager:!0,reviewer:!1,viewer:!0,device_ops:!1},{page:"Dashboard",sub_menu:"Event Analysis Report",edgetensor_super_admin:!0,cust_super_admin:!0,cust_fleet_admin:!0,fleet_manager:!0,reviewer:!1,viewer:!0,device_ops:!1},{page:"Dashboard",sub_menu:"Assets",edgetensor_super_admin:!0,cust_super_admin:!0,cust_fleet_admin:!0,fleet_manager:!0,reviewer:!1,viewer:!0,device_ops:!0},{page:"Dashboard",sub_menu:"Video Quality",edgetensor_super_admin:!0,cust_super_admin:!0,cust_fleet_admin:!0,fleet_manager:!0,reviewer:!1,viewer:!0,device_ops:!0},{page:"Events Report",sub_menu:"Events Executive Summary",edgetensor_super_admin:!0,cust_super_admin:!0,cust_fleet_admin:!0,fleet_manager:!0,reviewer:!0,viewer:!0,device_ops:!1},{page:"Events Report",sub_menu:"Events Summary",edgetensor_super_admin:!0,cust_super_admin:!0,cust_fleet_admin:!0,fleet_manager:!0,reviewer:!0,viewer:!0,device_ops:!1},{page:"Events Report",sub_menu:"Events Detail - Read",edgetensor_super_admin:!0,cust_super_admin:!0,cust_fleet_admin:!0,fleet_manager:!0,reviewer:!0,viewer:!0,device_ops:!1},{page:"Events Report",sub_menu:"Events Detail - Update",edgetensor_super_admin:!0,cust_super_admin:!0,cust_fleet_admin:!0,fleet_manager:!0,reviewer:!0,viewer:!1,device_ops:!1},{page:"Driver Analytics",sub_menu:"Drivers List",edgetensor_super_admin:!0,cust_super_admin:!0,cust_fleet_admin:!0,fleet_manager:!0,reviewer:!0,viewer:!0,device_ops:!1},{page:"Driver Analytics",sub_menu:"Driver Videos - Read",edgetensor_super_admin:!0,cust_super_admin:!0,cust_fleet_admin:!0,fleet_manager:!0,reviewer:!0,viewer:!0,device_ops:!1},{page:"Driver Analytics",sub_menu:"Driver Videos - Update",edgetensor_super_admin:!0,cust_super_admin:!0,cust_fleet_admin:!0,fleet_manager:!0,reviewer:!0,viewer:!1,device_ops:!1},{page:"Driver Analytics",sub_menu:"Driver Info - Read",edgetensor_super_admin:!0,cust_super_admin:!0,cust_fleet_admin:!0,fleet_manager:!0,reviewer:!0,viewer:!0,device_ops:!1},{page:"Driver Analytics",sub_menu:"Driver Info - Update",edgetensor_super_admin:!0,cust_super_admin:!0,cust_fleet_admin:!0,fleet_manager:!0,reviewer:!1,viewer:!1,device_ops:!1},{page:"Device Analytics",sub_menu:"Device Health - Read",edgetensor_super_admin:!0,cust_super_admin:!0,cust_fleet_admin:!0,fleet_manager:!0,reviewer:!1,viewer:!1,device_ops:!0},{page:"Device Analytics",sub_menu:"Device Health - Update",edgetensor_super_admin:!0,cust_super_admin:!0,cust_fleet_admin:!0,fleet_manager:!0,reviewer:!1,viewer:!1,device_ops:!0},{page:"Smart Enroll",sub_menu:"Smart Enroll",edgetensor_super_admin:!0,cust_super_admin:!0,cust_fleet_admin:!0,fleet_manager:!0,reviewer:!0,viewer:!1,device_ops:!1},{page:"Trips",sub_menu:"Trips List",edgetensor_super_admin:!0,cust_super_admin:!0,cust_fleet_admin:!0,fleet_manager:!0,reviewer:!0,viewer:!0,device_ops:!1},{page:"Trips",sub_menu:"Trips Detail",edgetensor_super_admin:!0,cust_super_admin:!0,cust_fleet_admin:!0,fleet_manager:!0,reviewer:!0,viewer:!0,device_ops:!1},{page:"Trips",sub_menu:"Update Driver",edgetensor_super_admin:!0,cust_super_admin:!0,cust_fleet_admin:!0,fleet_manager:!0,reviewer:!0,viewer:!1,device_ops:!1},{page:"Reports",sub_menu:"Report Scheduler",edgetensor_super_admin:!0,cust_super_admin:!0,cust_fleet_admin:!0,fleet_manager:!1,reviewer:!1,viewer:!1,device_ops:!1},{page:"Reports",sub_menu:"Reports History",edgetensor_super_admin:!0,cust_super_admin:!0,cust_fleet_admin:!0,fleet_manager:!1,reviewer:!1,viewer:!1,device_ops:!1},{page:"Administration",sub_menu:"Fleets",edgetensor_super_admin:!0,cust_super_admin:!0,cust_fleet_admin:!0,fleet_manager:!0,reviewer:!1,viewer:!1,device_ops:!0},{page:"Administration",sub_menu:"Devices",edgetensor_super_admin:!0,cust_super_admin:!0,cust_fleet_admin:!0,fleet_manager:!0,reviewer:!1,viewer:!1,device_ops:!0},{page:"Administration",sub_menu:"Users",edgetensor_super_admin:!0,cust_super_admin:!0,cust_fleet_admin:!0,fleet_manager:!1,reviewer:!1,viewer:!1,device_ops:!1},{page:"Administration",sub_menu:"Roles",edgetensor_super_admin:!0,cust_super_admin:!0,cust_fleet_admin:!0,fleet_manager:!1,reviewer:!1,viewer:!1,device_ops:!1},{page:"Administration",sub_menu:"Resource Groups",edgetensor_super_admin:!0,cust_super_admin:!0,cust_fleet_admin:!0,fleet_manager:!1,reviewer:!1,viewer:!1,device_ops:!1},{page:"Settings",sub_menu:"User Info - Read",edgetensor_super_admin:!0,cust_super_admin:!0,cust_fleet_admin:!0,fleet_manager:!0,reviewer:!0,viewer:!0,device_ops:!0},{page:"Settings",sub_menu:"User Info - Update",edgetensor_super_admin:!0,cust_super_admin:!0,cust_fleet_admin:!0,fleet_manager:!0,reviewer:!0,viewer:!0,device_ops:!0},{page:"Settings",sub_menu:"Organisation Info - Read",edgetensor_super_admin:!0,cust_super_admin:!0,cust_fleet_admin:!0,fleet_manager:!0,reviewer:!0,viewer:!0,device_ops:!0},{page:"Settings",sub_menu:"Organisation Info - Update",edgetensor_super_admin:!0,cust_super_admin:!0,cust_fleet_admin:!1,fleet_manager:!1,reviewer:!1,viewer:!1,device_ops:!1},{page:"Settings",sub_menu:"Cloud Features - Read",edgetensor_super_admin:!0,cust_super_admin:!0,cust_fleet_admin:!0,fleet_manager:!0,reviewer:!1,viewer:!1,device_ops:!1},{page:"Settings",sub_menu:"Cloud Features - Update",edgetensor_super_admin:!0,cust_super_admin:!1,cust_fleet_admin:!1,fleet_manager:!1,reviewer:!1,viewer:!1,device_ops:!1},{page:"Settings",sub_menu:"Event Settings - Read",edgetensor_super_admin:!0,cust_super_admin:!0,cust_fleet_admin:!0,fleet_manager:!0,reviewer:!1,viewer:!1,device_ops:!1},{page:"Settings",sub_menu:"Event Settings - Update",edgetensor_super_admin:!0,cust_super_admin:!0,cust_fleet_admin:!1,fleet_manager:!1,reviewer:!1,viewer:!1,device_ops:!1},{page:"Settings",sub_menu:"KPI Settings - Read",edgetensor_super_admin:!0,cust_super_admin:!0,cust_fleet_admin:!0,fleet_manager:!0,reviewer:!1,viewer:!1,device_ops:!1},{page:"Settings",sub_menu:"KPI Settings - Update",edgetensor_super_admin:!0,cust_super_admin:!0,cust_fleet_admin:!1,fleet_manager:!1,reviewer:!1,viewer:!1,device_ops:!1},{page:"Settings",sub_menu:"Compound Events Settings - Read",edgetensor_super_admin:!0,cust_super_admin:!0,cust_fleet_admin:!0,fleet_manager:!0,reviewer:!1,viewer:!1,device_ops:!1},{page:"Settings",sub_menu:"Compound Events Settings - Update",edgetensor_super_admin:!0,cust_super_admin:!0,cust_fleet_admin:!1,fleet_manager:!1,reviewer:!1,viewer:!1,device_ops:!1},{page:"Settings",sub_menu:"Driver Camera Settings - Read",edgetensor_super_admin:!0,cust_super_admin:!0,cust_fleet_admin:!0,fleet_manager:!0,reviewer:!1,viewer:!1,device_ops:!1},{page:"Settings",sub_menu:"Driver Camera Settings - Update",edgetensor_super_admin:!0,cust_super_admin:!0,cust_fleet_admin:!1,fleet_manager:!1,reviewer:!1,viewer:!1,device_ops:!1},{page:"Settings",sub_menu:"API Integration Settings - Read",edgetensor_super_admin:!0,cust_super_admin:!0,cust_fleet_admin:!0,fleet_manager:!0,reviewer:!1,viewer:!1,device_ops:!1},{page:"Settings",sub_menu:"API Integration Settings - Update",edgetensor_super_admin:!0,cust_super_admin:!0,cust_fleet_admin:!1,fleet_manager:!1,reviewer:!1,viewer:!1,device_ops:!1}],this.exportOptions=[{label:"Export to Excel",icon:"pi pi-file-excel",command:()=>{this.exportData("excel")}},{label:"Export to CSV",icon:"pi pi-file-excel",command:()=>{this.exportData("csv")}}]}addRole(){this.role={},this.submitted=!1,this.roleDialog=!0}editRole(){this.role={},this.submitted=!1,this.roleDialog=!0}deleteRole(){this.role={},this.submitted=!1,this.roleDialog=!0}deleteSelectedroles(){this.deleterolesDialog=!0}editrole(t){this.role={...t},this.roleDialog=!0}deleterole(t){this.deleteroleDialog=!0,this.role={...t}}confirmDeleteSelected(){this.deleterolesDialog=!1,this.roles=this.roles.filter(t=>!this.selectedroles.includes(t)),this.messageService.add({severity:"success",summary:"Successful",detail:"roles Deleted",life:3e3}),this.selectedroles=[]}confirmDelete(){this.deleteroleDialog=!1,this.roles=this.roles.filter(t=>t.id!==this.role.id),this.messageService.add({severity:"success",summary:"Successful",detail:"role Deleted",life:3e3}),this.role={}}hideDialog(){this.roleDialog=!1,this.submitted=!1}onRoleSelect(t){}saverole(){this.submitted=!0,this.usersRolesService.addRole(this.role).subscribe(t=>{this.roles=[...this.roles],this.roleDialog=!1,this.role={}})}findIndexById(t){let s=-1;for(let n=0;n<this.roles.length;n++)if(this.roles[n].id===t){s=n;break}return s}onGlobalFilter(t,s){t.filterGlobal(s.target.value,"contains")}getroleImage(t){return""!==t.roleImage?t.roleImage:"assets/demo/images/settings/person_placeholder.svg"}exportData(t){const s=[];this.roles.forEach(o=>{s.push({Page:o.page,Widget:o.sub_menu,"Account Admin":1==o.cust_super_admin?"Yes":"No","Fleet Admin":1==o.cust_fleet_admin?"Yes":"No","Fleet Manager":1==o.fleet_manager?"Yes":"No",Reviewer:1==o.reviewer?"Yes":"No",Viewer:1==o.viewer?"Yes":"No","Device Ops":1==o.device_ops?"Yes":"No"})});const n="Roles List - "+(new Date).toLocaleDateString();this.excelExportService.exportData(s,n,t)}static \u0275fac=function(s){return new(s||i)(e.Y36(f.ez),e.Y36(E.U0),e.Y36(f.YP),e.Y36(D.Xb))};static \u0275cmp=e.Xpm({type:i,selectors:[["app-roles"]],features:[e._Bn([f.ez,f.YP])],decls:16,vars:9,consts:[[1,"flex","align-items-center","justify-content-between","mb-3","mt-2"],[1,"text-xl","font-bold","letter-spacing-01"],[1,"flex"],[1,"flex","flex-column","md:flex-row","md:justify-content-between","md:align-items-center"],[1,"block","mt-2","md:mt-0","p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Search roles or widgets...",1,"w-full","sm:w-auto",3,"input"],[3,"popup","model"],["menu",""],["pButton","","pRipple","","type","button","icon","pi pi-ellipsis-v",1,"p-button-rounded","p-button-text","p-button-secondary","p-trigger",3,"click"],["scrollHeight","75vh","rowGroupMode","subheader",3,"value","scrollable","globalFilterFields","tableStyle","rowHover"],["dt",""],["pTemplate","header"],["pTemplate","body"],["colspan","6",1,"text-center"],[3,"ngModel","disabled","ngModelChange"]],template:function(s,n){if(1&s){const o=e.EpF();e._UZ(0,"p-toast"),e.TgZ(1,"div",0)(2,"div",1),e._uU(3,"Roles"),e.qZA(),e.TgZ(4,"div",2)(5,"div",3)(6,"span",4),e._UZ(7,"i",5),e.TgZ(8,"input",6),e.NdJ("input",function(a){e.CHM(o);const d=e.MAs(13);return e.KtG(n.onGlobalFilter(d,a))}),e.qZA()()(),e._UZ(9,"p-menu",7,8),e.TgZ(11,"button",9),e.NdJ("click",function(a){e.CHM(o);const d=e.MAs(10);return e.KtG(d.toggle(a))}),e.qZA()()(),e.TgZ(12,"p-table",10,11),e.YNc(14,Ti,22,0,"ng-template",12),e.YNc(15,Zi,17,14,"ng-template",13),e.qZA()}2&s&&(e.xp6(9),e.Q6J("popup",!0)("model",n.exportOptions),e.xp6(3),e.Q6J("value",n.roles)("scrollable",!0)("globalFilterFields",e.DdM(7,wi))("tableStyle",e.DdM(8,Di))("rowHover",!0))},dependencies:[f.jx,v.iA,c.JJ,c.On,F.Hq,S.H,G.FN,b.o,m.Ql,h.v2]})}return i})();function Fi(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"button",22),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.openNew())}),e.qZA()}}function Si(i,l){1&i&&e._UZ(0,"th")}function Ri(i,l){if(1&i&&(e.TgZ(0,"tr")(1,"th",23),e._uU(2,"Image"),e.qZA(),e.TgZ(3,"th",24),e._uU(4,"Name "),e.qZA(),e.TgZ(5,"th",25),e._uU(6," Role "),e.qZA(),e.TgZ(7,"th",26),e._uU(8,"Email "),e.qZA(),e.TgZ(9,"th",27),e._uU(10,"Phone "),e.qZA(),e.TgZ(11,"th",28),e._uU(12,"Status "),e.qZA(),e.TgZ(13,"th"),e._uU(14,"Resource Group Access "),e.qZA(),e.YNc(15,Si,1,0,"th",21),e.qZA()),2&i){const t=e.oxw();e.xp6(15),e.Q6J("ngIf",t.allowEditUser)}}function Ni(i,l){if(1&i&&(e.TgZ(0,"div")(1,"span",39),e._uU(2," ... "),e.TgZ(3,"i"),e._uU(4,"Show more"),e.qZA()()()),2&i){const t=e.oxw().$implicit,s=e.oxw();e.xp6(1),e.Q6J("pTooltip",s.tooltipItems(null==t?null:t.readableRoles)),e.uIk("aria-label","See more")}}function yi(i,l){if(1&i&&(e.TgZ(0,"div")(1,"span",39),e._uU(2," ... "),e.TgZ(3,"i"),e._uU(4,"Show more"),e.qZA()()()),2&i){const t=e.oxw().$implicit,s=e.oxw();e.xp6(1),e.Q6J("pTooltip",s.tooltipItems(null==t?null:t.readableResourceGroups)),e.uIk("aria-label","See more")}}function Ii(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"button",42),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2).$implicit,o=e.oxw();return e.KtG(o.editUser(n))}),e.qZA()}}function Mi(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"button",43),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2).$implicit,o=e.oxw();return e.KtG(o.deleteUser(n))}),e.qZA()}}function qi(i,l){if(1&i&&(e.TgZ(0,"td")(1,"div",2),e.YNc(2,Ii,1,0,"button",40),e.YNc(3,Mi,1,0,"button",41),e.qZA()()),2&i){const t=e.oxw().$implicit,s=e.oxw();e.xp6(2),e.Q6J("ngIf",s.checkIfUserAllowedtoEditDelete(t)),e.xp6(1),e.Q6J("ngIf",s.checkIfUserAllowedtoEditDelete(t))}}function Ei(i,l){if(1&i&&(e.TgZ(0,"tr")(1,"td",29)(2,"span",30),e._uU(3,"Image"),e.qZA(),e._UZ(4,"img",31),e.qZA(),e.TgZ(5,"td",32)(6,"span",30),e._uU(7,"Name"),e.qZA(),e._uU(8),e.qZA(),e.TgZ(9,"td",33)(10,"span",30),e._uU(11,"Role(s)"),e.qZA(),e._UZ(12,"span",34),e.YNc(13,Ni,5,2,"div",21),e.qZA(),e.TgZ(14,"td",35)(15,"span",30),e._uU(16,"Email"),e.qZA(),e._uU(17),e.qZA(),e.TgZ(18,"td",36)(19,"span",30),e._uU(20,"Phone"),e.qZA(),e._uU(21),e.qZA(),e.TgZ(22,"td",37)(23,"span",30),e._uU(24,"Status"),e.qZA(),e._uU(25),e.qZA(),e.TgZ(26,"td",38)(27,"span",30),e._uU(28,"Resource Group Access"),e.qZA(),e._UZ(29,"span",34),e.YNc(30,yi,5,2,"div",21),e.qZA(),e.YNc(31,qi,4,2,"td",21),e.qZA()),2&i){const t=l.$implicit,s=e.oxw();e.xp6(4),e.Q6J("src",s.getUserImage(t),e.LSH)("alt",t.first_name),e.xp6(4),e.hij(" ",t.name," "),e.xp6(4),e.Q6J("innerHTML",s.displayItems(null==t?null:t.readableRoles).join(", "),e.oJD),e.xp6(1),e.Q6J("ngIf",s.hasMoreItems(null==t?null:t.readableRoles)),e.xp6(4),e.hij(" ",t.email," "),e.xp6(4),e.hij(" ",t.contact_no," "),e.xp6(4),e.hij(" ",t.status," "),e.xp6(4),e.Q6J("innerHTML",s.displayItems(null==t?null:t.readableResourceGroups).join(", "),e.oJD),e.xp6(1),e.Q6J("ngIf",s.hasMoreItems(null==t?null:t.readableResourceGroups)),e.xp6(1),e.Q6J("ngIf",s.allowEditUser)}}function Ji(i,l){}function Pi(i,l){1&i&&(e.TgZ(0,"div",66),e._uU(1," First Name is required. "),e.qZA())}function Gi(i,l){if(1&i&&(e.TgZ(0,"div"),e.YNc(1,Pi,2,0,"div",65),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.f.first_name.errors.required)}}function ki(i,l){1&i&&(e.TgZ(0,"div",66),e._uU(1," Last Name is required. "),e.qZA())}function Yi(i,l){if(1&i&&(e.TgZ(0,"div"),e.YNc(1,ki,2,0,"div",65),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.f.last_name.errors.required)}}function Qi(i,l){1&i&&(e.TgZ(0,"div",66),e._uU(1," Email is required "),e.qZA())}function Oi(i,l){1&i&&(e.TgZ(0,"div",66),e._uU(1," Email must be a valid email address "),e.qZA())}function Hi(i,l){if(1&i&&(e.TgZ(0,"div"),e.YNc(1,Qi,2,0,"div",65),e.YNc(2,Oi,2,0,"div",65),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.f.email.errors.required),e.xp6(1),e.Q6J("ngIf",t.f.email.errors.email)}}function ji(i,l){if(1&i&&e._uU(0),2&i){const t=e.oxw(2);e.hij(" ",(null==t.userForm.value.roles?null:t.userForm.value.roles.length)>0?t.userForm.value.roles.length+" Role"+(t.userForm.value.roles.length>1?"s":"")+" Selected":"Select Roles"," ")}}function Li(i,l){if(1&i&&e._uU(0),2&i){const t=l.$implicit;e.hij(" ",null!=t&&t.name?null==t?null:t.name:"Select Role"," ")}}function Ki(i,l){if(1&i&&(e.TgZ(0,"div",67)(1,"b"),e._uU(2),e.qZA(),e._uU(3),e.qZA()),2&i){const t=e.oxw(2);e.xp6(2),e.Oqu(t.userForm.value.roles?t.userForm.value.roles.length:0),e.xp6(1),e.hij(" Role",(t.userForm.value.roles?t.userForm.value.roles.length:0)>1?"s":""," selected. ")}}function Bi(i,l){1&i&&(e.TgZ(0,"div")(1,"div",66),e._uU(2,"Role is required."),e.qZA()())}function Vi(i,l){1&i&&(e.TgZ(0,"div")(1,"div",66),e._uU(2,"Status is required."),e.qZA()())}function $i(i,l){if(1&i&&e._uU(0),2&i){const t=e.oxw(2);e.hij(" ",(null==t.userForm.value.resource_group_access_list?null:t.userForm.value.resource_group_access_list.length)>0?t.userForm.value.resource_group_access_list.length+"  Selected":"Select a Resource Group"," ")}}function zi(i,l){if(1&i&&e._uU(0),2&i){const t=l.$implicit;e.hij(" ",null!=t&&t.name?null==t?null:t.name:"Select a Resource Group"," ")}}function Wi(i,l){if(1&i&&(e.TgZ(0,"div",67)(1,"b"),e._uU(2),e.qZA(),e._uU(3),e.qZA()),2&i){const t=e.oxw(2);e.xp6(2),e.Oqu(t.userForm.value.resource_group_access_list?t.userForm.value.resource_group_access_list.length:0),e.xp6(1),e.hij(" Resource Group",""," selected. ")}}function Xi(i,l){1&i&&(e.TgZ(0,"div")(1,"div",66),e._uU(2," Resource group is required. "),e.qZA()())}const j=function(i){return{"ng-invalid ng-dirty":i}},ue=function(){return{height:"40px"}};function en(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"div",44),e._UZ(1,"img",45),e.TgZ(2,"div",46)(3,"p-fileUpload",47,48),e.NdJ("onSelect",function(n){e.CHM(t);const o=e.oxw();return e.KtG(o.onUserImageUpload(n))}),e.YNc(5,Ji,0,0,"ng-template",16),e.qZA()()(),e.TgZ(6,"form",49),e.NdJ("ngSubmit",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.saveUser())}),e.TgZ(7,"div",50),e._UZ(8,"input",51),e.TgZ(9,"div",44)(10,"div",52)(11,"label",53),e._uU(12,"First Name*"),e.qZA(),e._UZ(13,"input",54),e.YNc(14,Gi,2,1,"div",21),e.qZA()(),e.TgZ(15,"div",44)(16,"div",52)(17,"label",53),e._uU(18,"Last Name*"),e.qZA(),e._UZ(19,"input",55),e.YNc(20,Yi,2,1,"div",21),e.qZA()(),e.TgZ(21,"div",44)(22,"div",52)(23,"label",53),e._uU(24,"Email*"),e.qZA(),e._UZ(25,"input",56),e.YNc(26,Hi,3,2,"div",21),e.qZA()(),e.TgZ(27,"div",44)(28,"div",52)(29,"label",53),e._uU(30,"Phone"),e.qZA(),e._UZ(31,"input",57),e.qZA()(),e.TgZ(32,"div",44)(33,"div",52)(34,"label",58),e._uU(35,"Role*"),e.qZA(),e.TgZ(36,"p-multiSelect",59),e.NdJ("onChange",function(n){e.CHM(t);const o=e.oxw();return e.KtG(o.onRoleChange(n))}),e.YNc(37,ji,1,1,"ng-template",60),e.YNc(38,Li,1,1,"ng-template",61),e.YNc(39,Ki,4,2,"ng-template",17),e.qZA(),e.YNc(40,Bi,3,0,"div",21),e.qZA()(),e.TgZ(41,"div",44)(42,"div",52)(43,"label",62),e._uU(44,"Status*"),e.qZA(),e._UZ(45,"p-dropdown",63),e.YNc(46,Vi,3,0,"div",21),e.qZA()(),e.TgZ(47,"div",44)(48,"div",52)(49,"label",58),e._uU(50,"Resource Group*"),e.qZA(),e.TgZ(51,"p-multiSelect",64),e.YNc(52,$i,1,1,"ng-template",60),e.YNc(53,zi,1,1,"ng-template",61),e.YNc(54,Wi,4,2,"ng-template",17),e.qZA(),e.YNc(55,Xi,3,0,"div",21),e.qZA()()()()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("src",t.loadUserImage(t.userForm),e.LSH),e.xp6(2),e.Q6J("multiple",!1)("showCancelButton",!1)("showUploadButton",!1),e.xp6(3),e.Q6J("formGroup",t.userForm),e.xp6(7),e.Q6J("ngClass",e.VKq(33,j,(t.submitted||t.f.first_name.touched)&&t.f.first_name.errors)),e.xp6(1),e.Q6J("ngIf",t.f.first_name.touched&&t.f.first_name.errors),e.xp6(5),e.Q6J("ngClass",e.VKq(35,j,(t.submitted||t.f.last_name.touched)&&t.f.last_name.errors)),e.xp6(1),e.Q6J("ngIf",(t.submitted||t.f.last_name.touched)&&t.f.last_name.errors),e.xp6(5),e.Q6J("ngClass",e.VKq(37,j,(t.submitted||t.f.email.touched)&&t.f.email.errors)),e.xp6(1),e.Q6J("ngIf",(t.submitted||t.f.email.touched)&&t.f.email.errors),e.xp6(10),e.Akn(e.DdM(39,ue)),e.Q6J("options",t.roles)("styleClass","w-full")("placeholder","Select Roles")("filter",!0)("filterPlaceHolder","Search by Role"),e.xp6(4),e.Q6J("ngIf",t.f.roles.touched&&t.f.roles.invalid),e.xp6(5),e.Q6J("options",t.statuses)("ngClass",e.VKq(40,j,t.f.status.touched&&t.f.status.invalid)),e.xp6(1),e.Q6J("ngIf",t.f.status.touched&&t.f.status.invalid),e.xp6(5),e.Akn(e.DdM(42,ue)),e.Q6J("options",t.resourceGroups)("styleClass","w-full")("virtualScroll",!0)("virtualScrollItemSize",30)("placeholder","Select a Resource Group")("filter",!0)("filterPlaceHolder","Search by Resource Group")("ngClass",e.VKq(43,j,(t.submitted||t.f.resource_group_access_list.touched)&&!t.user.resource_group_access_list)),e.xp6(4),e.Q6J("ngIf",(t.submitted||t.f.resource_group_access_list.touched)&&t.f.resource_group_access_list.errors)}}function tn(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"button",68),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.hideDialog())}),e.qZA(),e.TgZ(1,"button",69),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.saveUser())}),e.qZA()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("disabled",t.submitted||t.f.first_name.errors||t.f.last_name.errors||t.f.email.errors||t.f.contact_no.errors||t.f.roles.errors||t.f.status.errors||t.f.resource_group_access_list.errors)}}function nn(i,l){if(1&i&&(e.TgZ(0,"span"),e._uU(1,"Are you sure you want to delete "),e.TgZ(2,"b"),e._uU(3),e.qZA(),e._uU(4,"?"),e.qZA()),2&i){const t=e.oxw();e.xp6(3),e.Oqu(t.user.first_name)}}function sn(i,l){if(1&i){const t=e.EpF();e.TgZ(0,"button",70),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.deleteUserDialog=!1)}),e.qZA(),e.TgZ(1,"button",71),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.confirmDelete(n.user))}),e.qZA()}}const on=function(){return["name","email","readableRoles","contact_no","status"]},ln=function(){return[10,20,30]},rn=function(){return{width:"460px"}},an=function(){return{width:"450px"}},pe="assets/demo/images/settings/person_placeholder.svg";let cn=(()=>{class i{messageService;adminService;fb;utilsService;excelExportService;confirmationService;usersRolesService;fleetsTree=[];resourceGroups=[];userForm;userDialog=!1;isEdit=!1;deleteUserDialog=!1;resourceGroupDialog=!1;createResource=[];user={};users=[];roles=[];selectedUsers=[];submitted=!1;cols=[];statuses=[];rowsPerPageOptions=[5,10,20];error="";org_id;exportOptions;currentUserRoles=[];allowEditUser=!1;constructor(t,s,n,o,r,a,d){this.messageService=t,this.adminService=s,this.fb=n,this.utilsService=o,this.excelExportService=r,this.confirmationService=a,this.usersRolesService=d,this.userForm=this.fb.group({id_:new c.NI("",[c.kI.required]),first_name:new c.NI("",[c.kI.required,c.kI.pattern(/^[A-Za-z0-9\-\'\s]+$/)]),last_name:new c.NI("",[c.kI.required,c.kI.pattern(/^[A-Za-z0-9\-\'\s]+$/)]),email:new c.NI("",[c.kI.required,c.kI.email]),contact_no:new c.NI(""),roles:new c.NI("",c.kI.required),status:new c.NI("",[c.kI.required]),resource_group_access_list:new c.NI("",[c.kI.required]),org_id:new c.NI(""),image:new c.NI("")})}ngOnInit(){this.currentUserRoles=JSON.parse(localStorage.getItem("user")||"{}")?.roles,(this.currentUserRoles.includes("ET_SUPER_ADMIN")||this.currentUserRoles.includes("CLIENT_SUPER_ADMIN"))&&(this.allowEditUser=!0),this.statuses=[{label:"Active",value:"ACTIVE"},{label:"Inactive",value:"INACTIVE"},{label:"Suspended",value:"SUSPENDED"}],this.adminService.refreshView$.subscribe(()=>{this.getUsers()}),this.exportOptions=[{label:"Export to Excel",icon:"pi pi-file-excel",command:()=>{this.exportData("excel")}},{label:"Export to CSV",icon:"pi pi-file-excel",command:()=>{this.exportData("csv")}}],this.org_id=JSON.parse(localStorage.getItem("user")||"{}").org_id}get f(){return this.userForm.controls}getUsers(){this.usersRolesService.getUsers().subscribe(t=>{this.users=[],this.users=t,this.users.forEach(s=>{s.image&&!s.image.includes("http")&&!s.image.includes(";base64,")&&(s.image="data:image/jpeg;base64,"+s.image),s.name=s.first_name+" "+s.last_name}),this.userForm.value.org_id=this.org_id,0===this.roles.length?this.getUIRoles():this.processRoles(),this.getResourceGroups()})}getUIRoles(){this.usersRolesService.getUIRoles().subscribe(t=>{this.roles=t,this.processRoles()})}processRoles(){this.users.forEach(t=>{if(t.roles?.length>0){const s=t.roles.map(n=>{const o=this.roles.find(r=>n===r.id_);return o?o.name:""}).filter(n=>n);t.readableRoles=s.join(", ")}}),this.currentUserRoles.includes("ET_SUPER_ADMIN")||(this.roles=this.roles.filter(t=>"ET_SUPER_ADMIN"!==t.id_))}getResourceGroups(){this.users.forEach(t=>{if(t.resource_group_access_list?.length>0){let s="";t.resource_group_access_list.forEach((n,o)=>{const r=this.resourceGroups.find(a=>n===a.id_);r&&(s+=r.name,o<t.resource_group_access_list.length-1&&(s+=", "))}),t.readableResourceGroups=s}})}openNew(){this.isEdit=!1,this.userForm.reset(),this.submitted=!1,this.userDialog=!0,this.userForm.get("email")?.enable()}isSuperAdmin=!1;editUser(t){this.submitted=!1,this.isEdit=!0,this.userForm.get("email")?.disable(),this.currentUserRoles.includes("CLIENT_SUPER_ADMIN")&&t.roles.includes("CLIENT_SUPER_ADMIN")||this.currentUserRoles.includes("ET_SUPER_ADMIN")&&t.roles.includes("ET_SUPER_ADMIN")||this.currentUserRoles.includes("CLIENT_SUPER_ADMIN")&&t.roles.includes("ET_SUPER_ADMIN")?(this.userForm.get("roles")?.disable(),this.userForm.get("status")?.disable(),this.userForm.get("resource_group_access_list")?.disable(),this.isSuperAdmin=!0):(this.isSuperAdmin=!1,this.userForm.get("roles")?.enable(),this.userForm.get("status")?.enable(),this.userForm.get("resource_group_access_list")?.enable(),this.isSuperAdmin=!1),this.userForm.patchValue(t),this.userDialog=!0}deleteUser(t){this.deleteUserDialog=!0,this.user={...t}}confirmDelete(t){this.usersRolesService.deleteUser(t.id_).subscribe(()=>{this.deleteUserDialog=!1,this.users=this.users.filter(s=>s.id_!==this.user.id_),this.messageService.add({severity:"success",summary:"Successful",detail:"user Deleted",life:3e3}),this.user={}})}checkIfUserAllowedtoEditDelete(t){return!(this.currentUserRoles.includes("CLIENT_SUPER_ADMIN")&&t.roles.includes("CLIENT_SUPER_ADMIN")||this.currentUserRoles.includes("ET_SUPER_ADMIN")&&t.roles.includes("ET_SUPER_ADMIN")||this.currentUserRoles.includes("CLIENT_SUPER_ADMIN")&&t.roles.includes("ET_SUPER_ADMIN"))}hideDialog(){this.userDialog=!1,this.submitted=!1}saveUser(){if(this.submitted=!0,this.isEdit){this.userForm.get("email")?.enable();var t=this.userForm.value;t.org_id=this.org_id,this.usersRolesService.editUser(t).subscribe(()=>{this.getUsers(),this.userDialog=!1,this.user={},this.messageService.add({severity:"success",summary:"Success",detail:"User Edited Successfully"})})}else this.userForm.value.org_id=this.org_id,this.usersRolesService.addUser(this.userForm.value).subscribe({next:s=>{this.getUsers(),this.userDialog=!1,this.user={},this.messageService.add({severity:"success",summary:"Success",detail:"User Created Successfully"})},error:s=>{this.messageService.add({severity:"error",summary:"Failure",detail:s,life:3e3})}})}onGlobalFilter(t,s){t.filterGlobal(s.target.value,"contains")}getUserImage(t){return t.image?t.image:pe}loadUserImage(t){return t.value.image?t.value.image:pe}onUserImageUpload(t){const s=new FileReader;s.readAsDataURL(t.files[0]),s.onload=()=>{this.userForm.value.image=s.result}}exportData(t){const s=[];this.users.forEach(o=>{let r="";o.resource_group_access_list?.length>0&&o.resource_group_access_list.forEach((a,d)=>{const p=this.resourceGroups.find(q=>a===q.id_);p&&(r+=p.name,d<o.resource_group_access_list.length-1&&(r+=", "))}),s.push({Name:o.first_name+" "+o.last_name,"Role(s)":o.readableRoles,Email:o.email,"Contact No":o.contact_no,Status:o.status,"Resource Group Access":r,"Created On":o.created_on?.substring(0,10)})});const n="Users List - "+(new Date).toLocaleDateString();this.excelExportService.exportData(s,n,t)}displayItems(t,s=3){if(!t)return[];const n=t.split(",").map(o=>o.trim());return n.length>s?n.slice(0,s):n}tooltipItems(t,s=3){const n=t?.split(",").map(o=>o.trim());return n.length>s?n?.slice(s).join(", "):""}hasMoreItems(t,s=3){return!!t&&t.split(",").length>s}onRoleChange(t){const s=this.userForm.get("roles")?.value;s.includes("ET_SUPER_ADMIN")||s.includes("CLIENT_SUPER_ADMIN")?(this.userForm.get("resource_group_access_list")?.disable(),this.userForm.get("resource_group_access_list")?.setValue([])):this.userForm.get("resource_group_access_list")?.enable()}static \u0275fac=function(s){return new(s||i)(e.Y36(f.ez),e.Y36(z),e.Y36(c.qu),e.Y36(D.FW),e.Y36(E.U0),e.Y36(f.YP),e.Y36(D.Xb))};static \u0275cmp=e.Xpm({type:i,selectors:[["app-users"]],inputs:{fleetsTree:"fleetsTree",resourceGroups:"resourceGroups"},features:[e._Bn([f.ez,f.YP])],decls:25,vars:26,consts:[[1,"flex","align-items-center","justify-content-between","mb-3","mt-2"],[1,"text-xl","font-bold","letter-spacing-01"],[1,"flex"],[1,"flex","flex-column","md:flex-row","md:justify-content-between","md:align-items-center"],[1,"block","mt-2","md:mt-0","p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Search User...",1,"w-full","sm:w-auto",3,"input"],["pButton","","pRipple","","label","Add User","class","ml-3",3,"click",4,"ngIf"],[3,"popup","model"],["menu",""],["pButton","","pRipple","","type","button","icon","pi pi-ellipsis-v",1,"p-button-rounded","p-button-text","p-button-secondary","p-trigger",3,"click"],["responsiveLayout","scroll","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries","selectionMode","multiple","dataKey","id",3,"value","columns","rows","globalFilterFields","paginator","rowsPerPageOptions","showCurrentPageReport","selection","rowHover","selectionChange"],["dt",""],["pTemplate","header"],["pTemplate","body"],["header","User Details",1,"p-fluid",3,"visible","modal","visibleChange"],["pTemplate","content"],["pTemplate","footer"],["header","Confirm",3,"visible","modal","visibleChange"],[1,"flex","align-items-center","justify-content-center"],[1,"pi","pi-exclamation-triangle","mr-3",2,"font-size","2rem"],[4,"ngIf"],["pButton","","pRipple","","label","Add User",1,"ml-3",3,"click"],["pSortableColumn","userImage"],["pSortableColumn","name"],["pSortableColumn","readableRoles"],["pSortableColumn","email"],["pSortableColumn","contact_no"],["pSortableColumn","status"],[2,"width","7%","min-width","3rem"],[1,"p-column-title"],[1,"shadow-1","user-image",3,"src","alt"],[2,"width","12%","min-width","10rem"],[2,"width","21%","min-width","12rem"],[3,"innerHTML"],[2,"width","18%","max-width","13rem","word-wrap","break-word"],[2,"width","9%","min-width","5rem"],[2,"width","8%","min-width","5rem"],[2,"width","20%","min-width","8rem"],["tooltipPosition","top",3,"pTooltip"],["pButton","","pRipple","","type","button","icon","pi pi-pencil","class","p-button-rounded p-button-text",3,"click",4,"ngIf"],["pButton","","pRipple","","type","button","icon","pi pi-trash","class","p-button-rounded p-button-text",3,"click",4,"ngIf"],["pButton","","pRipple","","type","button","icon","pi pi-pencil",1,"p-button-rounded","p-button-text",3,"click"],["pButton","","pRipple","","type","button","icon","pi pi-trash",1,"p-button-rounded","p-button-text",3,"click"],[1,"col-12","md:col-6"],["width","150",1,"user-image","mt-0","mb-2","block","shadow-2",3,"src"],[1,"w-15rem"],["mode","basic","name","myfile[]","chooseLabel","Upload Photo","accept",".jpeg, .jpg, .png",3,"multiple","showCancelButton","showUploadButton","onSelect"],["fileUploader",""],[1,"mt-3",3,"formGroup","ngSubmit"],[1,"grid"],["type","hidden","pInputText","","id","id_","formControlName","id_"],[1,"field"],["for","name"],["type","text","pInputText","","id","first_name","formControlName","first_name","autofocus","",3,"ngClass"],["type","text","pInputText","","id","last_name","formControlName","last_name","autofocus","",3,"ngClass"],["type","email","pInputText","","id","email","autofocus","","formControlName","email","pattern",".+@.+\\..+",3,"ngClass"],["type","text","pInputText","","id","contact_no","formControlName","contact_no","autofocus","","maxlength","40"],["for","role"],["id","role","formControlName","roles","appendTo","body","filterBy","name","filterMode","contains","optionLabel","name","optionValue","id_",3,"options","styleClass","placeholder","filter","filterPlaceHolder","onChange"],["pTemplate","selectedItems"],["pTemplate","default"],["for","status"],["id","status","appendTo","body","optionLabel","label","formControlName","status","placeholder","Select a Status","optionValue","value",3,"options","ngClass"],["id","role","formControlName","resource_group_access_list","appendTo","body","optionLabel","name","optionValue","id_","filterBy","name","filterMode","contains",3,"options","styleClass","virtualScroll","virtualScrollItemSize","placeholder","filter","filterPlaceHolder","ngClass"],["class","ng-dirty ng-invalid text-red-700 mt-1",4,"ngIf"],[1,"ng-dirty","ng-invalid","text-red-700","mt-1"],[1,"py-2","px-3"],["pButton","","pRipple","","label","Cancel",1,"p-button-text",3,"click"],["pButton","","pRipple","","label","Save",3,"disabled","click"],["pButton","","pRipple","","label","No",1,"p-button-text",3,"click"],["pButton","","pRipple","","label","Yes",3,"click"]],template:function(s,n){if(1&s){const o=e.EpF();e._UZ(0,"p-toast"),e.TgZ(1,"div",0)(2,"div",1),e._uU(3,"Users"),e.qZA(),e.TgZ(4,"div",2)(5,"div",3)(6,"span",4),e._UZ(7,"i",5),e.TgZ(8,"input",6),e.NdJ("input",function(a){e.CHM(o);const d=e.MAs(14);return e.KtG(n.onGlobalFilter(d,a))}),e.qZA()()(),e.YNc(9,Fi,1,0,"button",7),e._UZ(10,"p-menu",8,9),e.TgZ(12,"button",10),e.NdJ("click",function(a){e.CHM(o);const d=e.MAs(11);return e.KtG(d.toggle(a))}),e.qZA()()(),e.TgZ(13,"p-table",11,12),e.NdJ("selectionChange",function(a){return n.selectedUsers=a}),e.YNc(15,Ri,16,1,"ng-template",13),e.YNc(16,Ei,32,11,"ng-template",14),e.qZA(),e.TgZ(17,"p-dialog",15),e.NdJ("visibleChange",function(a){return n.userDialog=a}),e.YNc(18,en,56,45,"ng-template",16),e.YNc(19,tn,2,1,"ng-template",17),e.qZA(),e.TgZ(20,"p-dialog",18),e.NdJ("visibleChange",function(a){return n.deleteUserDialog=a}),e.TgZ(21,"div",19),e._UZ(22,"i",20),e.YNc(23,nn,5,1,"span",21),e.qZA(),e.YNc(24,sn,2,0,"ng-template",17),e.qZA()}2&s&&(e.xp6(9),e.Q6J("ngIf",n.allowEditUser),e.xp6(1),e.Q6J("popup",!0)("model",n.exportOptions),e.xp6(3),e.Q6J("value",n.users)("columns",n.cols)("rows",10)("globalFilterFields",e.DdM(22,on))("rows",10)("paginator",!0)("rowsPerPageOptions",e.DdM(23,ln))("showCurrentPageReport",!0)("selection",n.selectedUsers)("rowHover",!0),e.xp6(4),e.Akn(e.DdM(24,rn)),e.Q6J("visible",n.userDialog)("modal",!0),e.xp6(3),e.Akn(e.DdM(25,an)),e.Q6J("visible",n.deleteUserDialog)("modal",!0),e.xp6(3),e.Q6J("ngIf",n.user))},dependencies:[C.mk,C.O5,f.jx,O.u,v.iA,v.lQ,c._Y,c.Fj,c.JJ,c.JL,c.nD,c.c5,F.Hq,S.H,G.FN,b.o,Y.Lt,x.V,N.p,c.sg,c.u,V.NU,h.v2],styles:[".user-image[_ngcontent-%COMP%]{max-width:50px;border-radius:100%;height:50px}.disabled[_ngcontent-%COMP%]{cursor:not-allowed;color:#ccc}[_nghost-%COMP%]     .p-multiselect-items-wrapper{min-height:150px!important}"]})}return i})();var un=u(5600);let pn=(()=>{class i{static \u0275fac=function(s){return new(s||i)};static \u0275mod=e.oAB({type:i});static \u0275inj=e.cJS({imports:[C.ez,Pe.l,Be,ie.xc,O.z,C.ez,v.U$,c.u5,F.hJ,S.T,G.EV,_e.V,b.j,g.A,Y.kW,B._8,Q.cc,_.L$,x.S,N.O,te.LU,c.UX,P.Q,ne.o6,K.Y4,I.D,M.L,V.q4,de.QK,m.Iu,$.y,h.$9]})}return i})();e.B6R(y,[C.mk,C.O5,un.n,ie.mp,f.jx,te.xf,te.x4,M.G,xi,Ot,Ui,cn,Je],[])},217:function(ee,L){var u,c;void 0!==(c="function"==typeof(u=function(){"use strict";function F(_,m,b){var g=new XMLHttpRequest;g.open("GET",_),g.responseType="blob",g.onload=function(){N(g.response,m,b)},g.onerror=function(){console.error("could not download file")},g.send()}function B(_){var m=new XMLHttpRequest;m.open("HEAD",_,!1);try{m.send()}catch{}return 200<=m.status&&299>=m.status}function I(_){try{_.dispatchEvent(new MouseEvent("click"))}catch{var m=document.createEvent("MouseEvents");m.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),_.dispatchEvent(m)}}var x="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,Y=x.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),N=x.saveAs||("object"!=typeof window||window!==x?function(){}:"download"in HTMLAnchorElement.prototype&&!Y?function(_,m,b){var g=x.URL||x.webkitURL,h=document.createElement("a");h.download=m=m||_.name||"download",h.rel="noopener","string"==typeof _?(h.href=_,h.origin===location.origin?I(h):B(h.href)?F(_,m,b):I(h,h.target="_blank")):(h.href=g.createObjectURL(_),setTimeout(function(){g.revokeObjectURL(h.href)},4e4),setTimeout(function(){I(h)},0))}:"msSaveOrOpenBlob"in navigator?function(_,m,b){if(m=m||_.name||"download","string"!=typeof _)navigator.msSaveOrOpenBlob(function K(_,m){return typeof m>"u"?m={autoBom:!1}:"object"!=typeof m&&(console.warn("Deprecated: Expected third argument to be a object"),m={autoBom:!m}),m.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(_.type)?new Blob(["\ufeff",_],{type:_.type}):_}(_,b),m);else if(B(_))F(_,m,b);else{var g=document.createElement("a");g.href=_,g.target="_blank",setTimeout(function(){I(g)})}}:function(_,m,b,g){if((g=g||open("","_blank"))&&(g.document.title=g.document.body.innerText="downloading..."),"string"==typeof _)return F(_,m,b);var h="application/octet-stream"===_.type,V=/constructor/i.test(x.HTMLElement)||x.safari,$=/CriOS\/[\d]+/.test(navigator.userAgent);if(($||h&&V||Y)&&typeof FileReader<"u"){var P=new FileReader;P.onloadend=function(){var S=P.result;S=$?S:S.replace(/^data:[^;]*;/,"data:attachment/file;"),g?g.location.href=S:location=S,g=null},P.readAsDataURL(_)}else{var M=x.URL||x.webkitURL,Q=M.createObjectURL(_);g?g.location=Q:location.href=Q,g=null,setTimeout(function(){M.revokeObjectURL(Q)},4e4)}});x.saveAs=N.saveAs=N,ee.exports=N})?u.apply(L,[]):u)&&(ee.exports=c)}}]);